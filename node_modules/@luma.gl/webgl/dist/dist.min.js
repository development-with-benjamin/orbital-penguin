!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var r=t();for(var n in r)("object"==typeof exports?exports:e)[n]=r[n]}}(window,(function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=26)}([function(e,t,r){"use strict";t.a={DEPTH_BUFFER_BIT:256,STENCIL_BUFFER_BIT:1024,COLOR_BUFFER_BIT:16384,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,ZERO:0,ONE:1,SRC_COLOR:768,ONE_MINUS_SRC_COLOR:769,SRC_ALPHA:770,ONE_MINUS_SRC_ALPHA:771,DST_ALPHA:772,ONE_MINUS_DST_ALPHA:773,DST_COLOR:774,ONE_MINUS_DST_COLOR:775,SRC_ALPHA_SATURATE:776,CONSTANT_COLOR:32769,ONE_MINUS_CONSTANT_COLOR:32770,CONSTANT_ALPHA:32771,ONE_MINUS_CONSTANT_ALPHA:32772,FUNC_ADD:32774,FUNC_SUBTRACT:32778,FUNC_REVERSE_SUBTRACT:32779,BLEND_EQUATION:32777,BLEND_EQUATION_RGB:32777,BLEND_EQUATION_ALPHA:34877,BLEND_DST_RGB:32968,BLEND_SRC_RGB:32969,BLEND_DST_ALPHA:32970,BLEND_SRC_ALPHA:32971,BLEND_COLOR:32773,ARRAY_BUFFER_BINDING:34964,ELEMENT_ARRAY_BUFFER_BINDING:34965,LINE_WIDTH:2849,ALIASED_POINT_SIZE_RANGE:33901,ALIASED_LINE_WIDTH_RANGE:33902,CULL_FACE_MODE:2885,FRONT_FACE:2886,DEPTH_RANGE:2928,DEPTH_WRITEMASK:2930,DEPTH_CLEAR_VALUE:2931,DEPTH_FUNC:2932,STENCIL_CLEAR_VALUE:2961,STENCIL_FUNC:2962,STENCIL_FAIL:2964,STENCIL_PASS_DEPTH_FAIL:2965,STENCIL_PASS_DEPTH_PASS:2966,STENCIL_REF:2967,STENCIL_VALUE_MASK:2963,STENCIL_WRITEMASK:2968,STENCIL_BACK_FUNC:34816,STENCIL_BACK_FAIL:34817,STENCIL_BACK_PASS_DEPTH_FAIL:34818,STENCIL_BACK_PASS_DEPTH_PASS:34819,STENCIL_BACK_REF:36003,STENCIL_BACK_VALUE_MASK:36004,STENCIL_BACK_WRITEMASK:36005,VIEWPORT:2978,SCISSOR_BOX:3088,COLOR_CLEAR_VALUE:3106,COLOR_WRITEMASK:3107,UNPACK_ALIGNMENT:3317,PACK_ALIGNMENT:3333,MAX_TEXTURE_SIZE:3379,MAX_VIEWPORT_DIMS:3386,SUBPIXEL_BITS:3408,RED_BITS:3410,GREEN_BITS:3411,BLUE_BITS:3412,ALPHA_BITS:3413,DEPTH_BITS:3414,STENCIL_BITS:3415,POLYGON_OFFSET_UNITS:10752,POLYGON_OFFSET_FACTOR:32824,TEXTURE_BINDING_2D:32873,SAMPLE_BUFFERS:32936,SAMPLES:32937,SAMPLE_COVERAGE_VALUE:32938,SAMPLE_COVERAGE_INVERT:32939,COMPRESSED_TEXTURE_FORMATS:34467,VENDOR:7936,RENDERER:7937,VERSION:7938,IMPLEMENTATION_COLOR_READ_TYPE:35738,IMPLEMENTATION_COLOR_READ_FORMAT:35739,BROWSER_DEFAULT_WEBGL:37444,STATIC_DRAW:35044,STREAM_DRAW:35040,DYNAMIC_DRAW:35048,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,BUFFER_SIZE:34660,BUFFER_USAGE:34661,CURRENT_VERTEX_ATTRIB:34342,VERTEX_ATTRIB_ARRAY_ENABLED:34338,VERTEX_ATTRIB_ARRAY_SIZE:34339,VERTEX_ATTRIB_ARRAY_STRIDE:34340,VERTEX_ATTRIB_ARRAY_TYPE:34341,VERTEX_ATTRIB_ARRAY_NORMALIZED:34922,VERTEX_ATTRIB_ARRAY_POINTER:34373,VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:34975,CULL_FACE:2884,FRONT:1028,BACK:1029,FRONT_AND_BACK:1032,BLEND:3042,DEPTH_TEST:2929,DITHER:3024,POLYGON_OFFSET_FILL:32823,SAMPLE_ALPHA_TO_COVERAGE:32926,SAMPLE_COVERAGE:32928,SCISSOR_TEST:3089,STENCIL_TEST:2960,NO_ERROR:0,INVALID_ENUM:1280,INVALID_VALUE:1281,INVALID_OPERATION:1282,OUT_OF_MEMORY:1285,CONTEXT_LOST_WEBGL:37442,CW:2304,CCW:2305,DONT_CARE:4352,FASTEST:4353,NICEST:4354,GENERATE_MIPMAP_HINT:33170,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DOUBLE:5130,DEPTH_COMPONENT:6402,ALPHA:6406,RGB:6407,RGBA:6408,LUMINANCE:6409,LUMINANCE_ALPHA:6410,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,FRAGMENT_SHADER:35632,VERTEX_SHADER:35633,COMPILE_STATUS:35713,DELETE_STATUS:35712,LINK_STATUS:35714,VALIDATE_STATUS:35715,ATTACHED_SHADERS:35717,ACTIVE_ATTRIBUTES:35721,ACTIVE_UNIFORMS:35718,MAX_VERTEX_ATTRIBS:34921,MAX_VERTEX_UNIFORM_VECTORS:36347,MAX_VARYING_VECTORS:36348,MAX_COMBINED_TEXTURE_IMAGE_UNITS:35661,MAX_VERTEX_TEXTURE_IMAGE_UNITS:35660,MAX_TEXTURE_IMAGE_UNITS:34930,MAX_FRAGMENT_UNIFORM_VECTORS:36349,SHADER_TYPE:35663,SHADING_LANGUAGE_VERSION:35724,CURRENT_PROGRAM:35725,NEVER:512,ALWAYS:519,LESS:513,EQUAL:514,LEQUAL:515,GREATER:516,GEQUAL:518,NOTEQUAL:517,KEEP:7680,REPLACE:7681,INCR:7682,DECR:7683,INVERT:5386,INCR_WRAP:34055,DECR_WRAP:34056,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,TEXTURE_2D:3553,TEXTURE:5890,TEXTURE_CUBE_MAP:34067,TEXTURE_BINDING_CUBE_MAP:34068,TEXTURE_CUBE_MAP_POSITIVE_X:34069,TEXTURE_CUBE_MAP_NEGATIVE_X:34070,TEXTURE_CUBE_MAP_POSITIVE_Y:34071,TEXTURE_CUBE_MAP_NEGATIVE_Y:34072,TEXTURE_CUBE_MAP_POSITIVE_Z:34073,TEXTURE_CUBE_MAP_NEGATIVE_Z:34074,MAX_CUBE_MAP_TEXTURE_SIZE:34076,TEXTURE0:33984,ACTIVE_TEXTURE:34016,REPEAT:10497,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,TEXTURE_WIDTH:4096,TEXTURE_HEIGHT:4097,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,SAMPLER_2D:35678,SAMPLER_CUBE:35680,LOW_FLOAT:36336,MEDIUM_FLOAT:36337,HIGH_FLOAT:36338,LOW_INT:36339,MEDIUM_INT:36340,HIGH_INT:36341,FRAMEBUFFER:36160,RENDERBUFFER:36161,RGBA4:32854,RGB5_A1:32855,RGB565:36194,DEPTH_COMPONENT16:33189,STENCIL_INDEX:6401,STENCIL_INDEX8:36168,DEPTH_STENCIL:34041,RENDERBUFFER_WIDTH:36162,RENDERBUFFER_HEIGHT:36163,RENDERBUFFER_INTERNAL_FORMAT:36164,RENDERBUFFER_RED_SIZE:36176,RENDERBUFFER_GREEN_SIZE:36177,RENDERBUFFER_BLUE_SIZE:36178,RENDERBUFFER_ALPHA_SIZE:36179,RENDERBUFFER_DEPTH_SIZE:36180,RENDERBUFFER_STENCIL_SIZE:36181,FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE:36048,FRAMEBUFFER_ATTACHMENT_OBJECT_NAME:36049,FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL:36050,FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE:36051,COLOR_ATTACHMENT0:36064,DEPTH_ATTACHMENT:36096,STENCIL_ATTACHMENT:36128,DEPTH_STENCIL_ATTACHMENT:33306,NONE:0,FRAMEBUFFER_COMPLETE:36053,FRAMEBUFFER_INCOMPLETE_ATTACHMENT:36054,FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:36055,FRAMEBUFFER_INCOMPLETE_DIMENSIONS:36057,FRAMEBUFFER_UNSUPPORTED:36061,FRAMEBUFFER_BINDING:36006,RENDERBUFFER_BINDING:36007,READ_FRAMEBUFFER:36008,DRAW_FRAMEBUFFER:36009,MAX_RENDERBUFFER_SIZE:34024,INVALID_FRAMEBUFFER_OPERATION:1286,UNPACK_FLIP_Y_WEBGL:37440,UNPACK_PREMULTIPLY_ALPHA_WEBGL:37441,UNPACK_COLORSPACE_CONVERSION_WEBGL:37443,READ_BUFFER:3074,UNPACK_ROW_LENGTH:3314,UNPACK_SKIP_ROWS:3315,UNPACK_SKIP_PIXELS:3316,PACK_ROW_LENGTH:3330,PACK_SKIP_ROWS:3331,PACK_SKIP_PIXELS:3332,TEXTURE_BINDING_3D:32874,UNPACK_SKIP_IMAGES:32877,UNPACK_IMAGE_HEIGHT:32878,MAX_3D_TEXTURE_SIZE:32883,MAX_ELEMENTS_VERTICES:33e3,MAX_ELEMENTS_INDICES:33001,MAX_TEXTURE_LOD_BIAS:34045,MAX_FRAGMENT_UNIFORM_COMPONENTS:35657,MAX_VERTEX_UNIFORM_COMPONENTS:35658,MAX_ARRAY_TEXTURE_LAYERS:35071,MIN_PROGRAM_TEXEL_OFFSET:35076,MAX_PROGRAM_TEXEL_OFFSET:35077,MAX_VARYING_COMPONENTS:35659,FRAGMENT_SHADER_DERIVATIVE_HINT:35723,RASTERIZER_DISCARD:35977,VERTEX_ARRAY_BINDING:34229,MAX_VERTEX_OUTPUT_COMPONENTS:37154,MAX_FRAGMENT_INPUT_COMPONENTS:37157,MAX_SERVER_WAIT_TIMEOUT:37137,MAX_ELEMENT_INDEX:36203,RED:6403,RGB8:32849,RGBA8:32856,RGB10_A2:32857,TEXTURE_3D:32879,TEXTURE_WRAP_R:32882,TEXTURE_MIN_LOD:33082,TEXTURE_MAX_LOD:33083,TEXTURE_BASE_LEVEL:33084,TEXTURE_MAX_LEVEL:33085,TEXTURE_COMPARE_MODE:34892,TEXTURE_COMPARE_FUNC:34893,SRGB:35904,SRGB8:35905,SRGB8_ALPHA8:35907,COMPARE_REF_TO_TEXTURE:34894,RGBA32F:34836,RGB32F:34837,RGBA16F:34842,RGB16F:34843,TEXTURE_2D_ARRAY:35866,TEXTURE_BINDING_2D_ARRAY:35869,R11F_G11F_B10F:35898,RGB9_E5:35901,RGBA32UI:36208,RGB32UI:36209,RGBA16UI:36214,RGB16UI:36215,RGBA8UI:36220,RGB8UI:36221,RGBA32I:36226,RGB32I:36227,RGBA16I:36232,RGB16I:36233,RGBA8I:36238,RGB8I:36239,RED_INTEGER:36244,RGB_INTEGER:36248,RGBA_INTEGER:36249,R8:33321,RG8:33323,R16F:33325,R32F:33326,RG16F:33327,RG32F:33328,R8I:33329,R8UI:33330,R16I:33331,R16UI:33332,R32I:33333,R32UI:33334,RG8I:33335,RG8UI:33336,RG16I:33337,RG16UI:33338,RG32I:33339,RG32UI:33340,R8_SNORM:36756,RG8_SNORM:36757,RGB8_SNORM:36758,RGBA8_SNORM:36759,RGB10_A2UI:36975,TEXTURE_IMMUTABLE_FORMAT:37167,TEXTURE_IMMUTABLE_LEVELS:33503,UNSIGNED_INT_2_10_10_10_REV:33640,UNSIGNED_INT_10F_11F_11F_REV:35899,UNSIGNED_INT_5_9_9_9_REV:35902,FLOAT_32_UNSIGNED_INT_24_8_REV:36269,UNSIGNED_INT_24_8:34042,HALF_FLOAT:5131,RG:33319,RG_INTEGER:33320,INT_2_10_10_10_REV:36255,CURRENT_QUERY:34917,QUERY_RESULT:34918,QUERY_RESULT_AVAILABLE:34919,ANY_SAMPLES_PASSED:35887,ANY_SAMPLES_PASSED_CONSERVATIVE:36202,MAX_DRAW_BUFFERS:34852,DRAW_BUFFER0:34853,DRAW_BUFFER1:34854,DRAW_BUFFER2:34855,DRAW_BUFFER3:34856,DRAW_BUFFER4:34857,DRAW_BUFFER5:34858,DRAW_BUFFER6:34859,DRAW_BUFFER7:34860,DRAW_BUFFER8:34861,DRAW_BUFFER9:34862,DRAW_BUFFER10:34863,DRAW_BUFFER11:34864,DRAW_BUFFER12:34865,DRAW_BUFFER13:34866,DRAW_BUFFER14:34867,DRAW_BUFFER15:34868,MAX_COLOR_ATTACHMENTS:36063,COLOR_ATTACHMENT1:36065,COLOR_ATTACHMENT2:36066,COLOR_ATTACHMENT3:36067,COLOR_ATTACHMENT4:36068,COLOR_ATTACHMENT5:36069,COLOR_ATTACHMENT6:36070,COLOR_ATTACHMENT7:36071,COLOR_ATTACHMENT8:36072,COLOR_ATTACHMENT9:36073,COLOR_ATTACHMENT10:36074,COLOR_ATTACHMENT11:36075,COLOR_ATTACHMENT12:36076,COLOR_ATTACHMENT13:36077,COLOR_ATTACHMENT14:36078,COLOR_ATTACHMENT15:36079,SAMPLER_3D:35679,SAMPLER_2D_SHADOW:35682,SAMPLER_2D_ARRAY:36289,SAMPLER_2D_ARRAY_SHADOW:36292,SAMPLER_CUBE_SHADOW:36293,INT_SAMPLER_2D:36298,INT_SAMPLER_3D:36299,INT_SAMPLER_CUBE:36300,INT_SAMPLER_2D_ARRAY:36303,UNSIGNED_INT_SAMPLER_2D:36306,UNSIGNED_INT_SAMPLER_3D:36307,UNSIGNED_INT_SAMPLER_CUBE:36308,UNSIGNED_INT_SAMPLER_2D_ARRAY:36311,MAX_SAMPLES:36183,SAMPLER_BINDING:35097,PIXEL_PACK_BUFFER:35051,PIXEL_UNPACK_BUFFER:35052,PIXEL_PACK_BUFFER_BINDING:35053,PIXEL_UNPACK_BUFFER_BINDING:35055,COPY_READ_BUFFER:36662,COPY_WRITE_BUFFER:36663,COPY_READ_BUFFER_BINDING:36662,COPY_WRITE_BUFFER_BINDING:36663,FLOAT_MAT2x3:35685,FLOAT_MAT2x4:35686,FLOAT_MAT3x2:35687,FLOAT_MAT3x4:35688,FLOAT_MAT4x2:35689,FLOAT_MAT4x3:35690,UNSIGNED_INT_VEC2:36294,UNSIGNED_INT_VEC3:36295,UNSIGNED_INT_VEC4:36296,UNSIGNED_NORMALIZED:35863,SIGNED_NORMALIZED:36764,VERTEX_ATTRIB_ARRAY_INTEGER:35069,VERTEX_ATTRIB_ARRAY_DIVISOR:35070,TRANSFORM_FEEDBACK_BUFFER_MODE:35967,MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS:35968,TRANSFORM_FEEDBACK_VARYINGS:35971,TRANSFORM_FEEDBACK_BUFFER_START:35972,TRANSFORM_FEEDBACK_BUFFER_SIZE:35973,TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN:35976,MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS:35978,MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS:35979,INTERLEAVED_ATTRIBS:35980,SEPARATE_ATTRIBS:35981,TRANSFORM_FEEDBACK_BUFFER:35982,TRANSFORM_FEEDBACK_BUFFER_BINDING:35983,TRANSFORM_FEEDBACK:36386,TRANSFORM_FEEDBACK_PAUSED:36387,TRANSFORM_FEEDBACK_ACTIVE:36388,TRANSFORM_FEEDBACK_BINDING:36389,FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING:33296,FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE:33297,FRAMEBUFFER_ATTACHMENT_RED_SIZE:33298,FRAMEBUFFER_ATTACHMENT_GREEN_SIZE:33299,FRAMEBUFFER_ATTACHMENT_BLUE_SIZE:33300,FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE:33301,FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE:33302,FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE:33303,FRAMEBUFFER_DEFAULT:33304,DEPTH24_STENCIL8:35056,DRAW_FRAMEBUFFER_BINDING:36006,READ_FRAMEBUFFER_BINDING:36010,RENDERBUFFER_SAMPLES:36011,FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER:36052,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE:36182,UNIFORM_BUFFER:35345,UNIFORM_BUFFER_BINDING:35368,UNIFORM_BUFFER_START:35369,UNIFORM_BUFFER_SIZE:35370,MAX_VERTEX_UNIFORM_BLOCKS:35371,MAX_FRAGMENT_UNIFORM_BLOCKS:35373,MAX_COMBINED_UNIFORM_BLOCKS:35374,MAX_UNIFORM_BUFFER_BINDINGS:35375,MAX_UNIFORM_BLOCK_SIZE:35376,MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS:35377,MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS:35379,UNIFORM_BUFFER_OFFSET_ALIGNMENT:35380,ACTIVE_UNIFORM_BLOCKS:35382,UNIFORM_TYPE:35383,UNIFORM_SIZE:35384,UNIFORM_BLOCK_INDEX:35386,UNIFORM_OFFSET:35387,UNIFORM_ARRAY_STRIDE:35388,UNIFORM_MATRIX_STRIDE:35389,UNIFORM_IS_ROW_MAJOR:35390,UNIFORM_BLOCK_BINDING:35391,UNIFORM_BLOCK_DATA_SIZE:35392,UNIFORM_BLOCK_ACTIVE_UNIFORMS:35394,UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES:35395,UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER:35396,UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER:35398,OBJECT_TYPE:37138,SYNC_CONDITION:37139,SYNC_STATUS:37140,SYNC_FLAGS:37141,SYNC_FENCE:37142,SYNC_GPU_COMMANDS_COMPLETE:37143,UNSIGNALED:37144,SIGNALED:37145,ALREADY_SIGNALED:37146,TIMEOUT_EXPIRED:37147,CONDITION_SATISFIED:37148,WAIT_FAILED:37149,SYNC_FLUSH_COMMANDS_BIT:1,COLOR:6144,DEPTH:6145,STENCIL:6146,MIN:32775,MAX:32776,DEPTH_COMPONENT24:33190,STREAM_READ:35041,STREAM_COPY:35042,STATIC_READ:35045,STATIC_COPY:35046,DYNAMIC_READ:35049,DYNAMIC_COPY:35050,DEPTH_COMPONENT32F:36012,DEPTH32F_STENCIL8:36013,INVALID_INDEX:4294967295,TIMEOUT_IGNORED:-1,MAX_CLIENT_WAIT_TIMEOUT_WEBGL:37447,VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE:35070,UNMASKED_VENDOR_WEBGL:37445,UNMASKED_RENDERER_WEBGL:37446,MAX_TEXTURE_MAX_ANISOTROPY_EXT:34047,TEXTURE_MAX_ANISOTROPY_EXT:34046,COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_R11_EAC:37488,COMPRESSED_SIGNED_R11_EAC:37489,COMPRESSED_RG11_EAC:37490,COMPRESSED_SIGNED_RG11_EAC:37491,COMPRESSED_RGB8_ETC2:37492,COMPRESSED_RGBA8_ETC2_EAC:37493,COMPRESSED_SRGB8_ETC2:37494,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37495,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37496,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37497,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGB_ETC1_WEBGL:36196,COMPRESSED_RGB_ATC_WEBGL:35986,COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL:35986,COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL:34798,UNSIGNED_INT_24_8_WEBGL:34042,HALF_FLOAT_OES:36193,RGBA32F_EXT:34836,RGB32F_EXT:34837,FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE_EXT:33297,UNSIGNED_NORMALIZED_EXT:35863,MIN_EXT:32775,MAX_EXT:32776,SRGB_EXT:35904,SRGB_ALPHA_EXT:35906,SRGB8_ALPHA8_EXT:35907,FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING_EXT:33296,FRAGMENT_SHADER_DERIVATIVE_HINT_OES:35723,COLOR_ATTACHMENT0_WEBGL:36064,COLOR_ATTACHMENT1_WEBGL:36065,COLOR_ATTACHMENT2_WEBGL:36066,COLOR_ATTACHMENT3_WEBGL:36067,COLOR_ATTACHMENT4_WEBGL:36068,COLOR_ATTACHMENT5_WEBGL:36069,COLOR_ATTACHMENT6_WEBGL:36070,COLOR_ATTACHMENT7_WEBGL:36071,COLOR_ATTACHMENT8_WEBGL:36072,COLOR_ATTACHMENT9_WEBGL:36073,COLOR_ATTACHMENT10_WEBGL:36074,COLOR_ATTACHMENT11_WEBGL:36075,COLOR_ATTACHMENT12_WEBGL:36076,COLOR_ATTACHMENT13_WEBGL:36077,COLOR_ATTACHMENT14_WEBGL:36078,COLOR_ATTACHMENT15_WEBGL:36079,DRAW_BUFFER0_WEBGL:34853,DRAW_BUFFER1_WEBGL:34854,DRAW_BUFFER2_WEBGL:34855,DRAW_BUFFER3_WEBGL:34856,DRAW_BUFFER4_WEBGL:34857,DRAW_BUFFER5_WEBGL:34858,DRAW_BUFFER6_WEBGL:34859,DRAW_BUFFER7_WEBGL:34860,DRAW_BUFFER8_WEBGL:34861,DRAW_BUFFER9_WEBGL:34862,DRAW_BUFFER10_WEBGL:34863,DRAW_BUFFER11_WEBGL:34864,DRAW_BUFFER12_WEBGL:34865,DRAW_BUFFER13_WEBGL:34866,DRAW_BUFFER14_WEBGL:34867,DRAW_BUFFER15_WEBGL:34868,MAX_COLOR_ATTACHMENTS_WEBGL:36063,MAX_DRAW_BUFFERS_WEBGL:34852,VERTEX_ARRAY_BINDING_OES:34229,QUERY_COUNTER_BITS_EXT:34916,CURRENT_QUERY_EXT:34917,QUERY_RESULT_EXT:34918,QUERY_RESULT_AVAILABLE_EXT:34919,TIME_ELAPSED_EXT:35007,TIMESTAMP_EXT:36392,GPU_DISJOINT_EXT:36795}},,function(e,t,r){"use strict";r.d(t,"d",(function(){return a})),r.d(t,"e",(function(){return i})),r.d(t,"c",(function(){return s})),r.d(t,"b",(function(){return o})),r.d(t,"a",(function(){return E}));var n=r(4);function a(e){return"undefined"!=typeof WebGLRenderingContext&&e instanceof WebGLRenderingContext||("undefined"!=typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext||Boolean(e&&Number.isFinite(e._version)))}function i(e){return"undefined"!=typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext||Boolean(e&&2===e._version)}function s(e){return i(e)?e:null}function o(e){return Object(n.a)(a(e),"Invalid WebGLRenderingContext"),e}function E(e){return Object(n.a)(i(e),"Requires WebGL2"),e}},function(e,t,r){e.exports=r(29)},function(e,t,r){"use strict";function n(e,t){if(!e)throw new Error(t||"luma.gl: assertion failed.")}r.d(t,"a",(function(){return n}))},function(e,t,r){"use strict";(function(e,n){r.d(t,"b",(function(){return s})),r.d(t,"a",(function(){return o}));var a=r(6),i={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:void 0!==e&&e,document:"undefined"!=typeof document&&document,process:"object"===(void 0===n?"undefined":Object(a.a)(n))&&n},s=i.window||i.self||i.global,o=i.process||{};console}).call(this,r(13),r(10))},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r.d(t,"a",(function(){return n}))},function(e,t,r){"use strict";r.d(t,"c",(function(){return i})),r.d(t,"e",(function(){return _})),r.d(t,"a",(function(){return l})),r.d(t,"b",(function(){return A})),r.d(t,"d",(function(){return h}));var n=r(0),a=r(2);const i={[n.a.BLEND]:!1,[n.a.BLEND_COLOR]:new Float32Array([0,0,0,0]),[n.a.BLEND_EQUATION_RGB]:n.a.FUNC_ADD,[n.a.BLEND_EQUATION_ALPHA]:n.a.FUNC_ADD,[n.a.BLEND_SRC_RGB]:n.a.ONE,[n.a.BLEND_DST_RGB]:n.a.ZERO,[n.a.BLEND_SRC_ALPHA]:n.a.ONE,[n.a.BLEND_DST_ALPHA]:n.a.ZERO,[n.a.COLOR_CLEAR_VALUE]:new Float32Array([0,0,0,0]),[n.a.COLOR_WRITEMASK]:[!0,!0,!0,!0],[n.a.CULL_FACE]:!1,[n.a.CULL_FACE_MODE]:n.a.BACK,[n.a.DEPTH_TEST]:!1,[n.a.DEPTH_CLEAR_VALUE]:1,[n.a.DEPTH_FUNC]:n.a.LESS,[n.a.DEPTH_RANGE]:new Float32Array([0,1]),[n.a.DEPTH_WRITEMASK]:!0,[n.a.DITHER]:!0,[n.a.FRAMEBUFFER_BINDING]:null,[n.a.FRONT_FACE]:n.a.CCW,[n.a.GENERATE_MIPMAP_HINT]:n.a.DONT_CARE,[n.a.LINE_WIDTH]:1,[n.a.POLYGON_OFFSET_FILL]:!1,[n.a.POLYGON_OFFSET_FACTOR]:0,[n.a.POLYGON_OFFSET_UNITS]:0,[n.a.SAMPLE_COVERAGE_VALUE]:1,[n.a.SAMPLE_COVERAGE_INVERT]:!1,[n.a.SCISSOR_TEST]:!1,[n.a.SCISSOR_BOX]:new Int32Array([0,0,1024,1024]),[n.a.STENCIL_TEST]:!1,[n.a.STENCIL_CLEAR_VALUE]:0,[n.a.STENCIL_WRITEMASK]:4294967295,[n.a.STENCIL_BACK_WRITEMASK]:4294967295,[n.a.STENCIL_FUNC]:n.a.ALWAYS,[n.a.STENCIL_REF]:0,[n.a.STENCIL_VALUE_MASK]:4294967295,[n.a.STENCIL_BACK_FUNC]:n.a.ALWAYS,[n.a.STENCIL_BACK_REF]:0,[n.a.STENCIL_BACK_VALUE_MASK]:4294967295,[n.a.STENCIL_FAIL]:n.a.KEEP,[n.a.STENCIL_PASS_DEPTH_FAIL]:n.a.KEEP,[n.a.STENCIL_PASS_DEPTH_PASS]:n.a.KEEP,[n.a.STENCIL_BACK_FAIL]:n.a.KEEP,[n.a.STENCIL_BACK_PASS_DEPTH_FAIL]:n.a.KEEP,[n.a.STENCIL_BACK_PASS_DEPTH_PASS]:n.a.KEEP,[n.a.VIEWPORT]:[0,0,1024,1024],[n.a.PACK_ALIGNMENT]:4,[n.a.UNPACK_ALIGNMENT]:4,[n.a.UNPACK_FLIP_Y_WEBGL]:!1,[n.a.UNPACK_PREMULTIPLY_ALPHA_WEBGL]:!1,[n.a.UNPACK_COLORSPACE_CONVERSION_WEBGL]:n.a.BROWSER_DEFAULT_WEBGL,[n.a.FRAGMENT_SHADER_DERIVATIVE_HINT]:n.a.DONT_CARE,[n.a.READ_FRAMEBUFFER_BINDING]:null,[n.a.RASTERIZER_DISCARD]:!1,[n.a.PACK_ROW_LENGTH]:0,[n.a.PACK_SKIP_PIXELS]:0,[n.a.PACK_SKIP_ROWS]:0,[n.a.UNPACK_ROW_LENGTH]:0,[n.a.UNPACK_IMAGE_HEIGHT]:0,[n.a.UNPACK_SKIP_PIXELS]:0,[n.a.UNPACK_SKIP_ROWS]:0,[n.a.UNPACK_SKIP_IMAGES]:0},s=(e,t,r)=>t?e.enable(r):e.disable(r),o=(e,t,r)=>e.hint(r,t),E=(e,t,r)=>e.pixelStorei(r,t);function u(e){return Array.isArray(e)||ArrayBuffer.isView(e)}const _={[n.a.BLEND]:s,[n.a.BLEND_COLOR]:(e,t)=>e.blendColor(...t),[n.a.BLEND_EQUATION_RGB]:"blendEquation",[n.a.BLEND_EQUATION_ALPHA]:"blendEquation",[n.a.BLEND_SRC_RGB]:"blendFunc",[n.a.BLEND_DST_RGB]:"blendFunc",[n.a.BLEND_SRC_ALPHA]:"blendFunc",[n.a.BLEND_DST_ALPHA]:"blendFunc",[n.a.COLOR_CLEAR_VALUE]:(e,t)=>e.clearColor(...t),[n.a.COLOR_WRITEMASK]:(e,t)=>e.colorMask(...t),[n.a.CULL_FACE]:s,[n.a.CULL_FACE_MODE]:(e,t)=>e.cullFace(t),[n.a.DEPTH_TEST]:s,[n.a.DEPTH_CLEAR_VALUE]:(e,t)=>e.clearDepth(t),[n.a.DEPTH_FUNC]:(e,t)=>e.depthFunc(t),[n.a.DEPTH_RANGE]:(e,t)=>e.depthRange(...t),[n.a.DEPTH_WRITEMASK]:(e,t)=>e.depthMask(t),[n.a.DITHER]:s,[n.a.FRAGMENT_SHADER_DERIVATIVE_HINT]:o,[n.a.FRAMEBUFFER_BINDING]:(e,t)=>{const r=Object(a.e)(e)?n.a.DRAW_FRAMEBUFFER:n.a.FRAMEBUFFER;return e.bindFramebuffer(r,t)},[n.a.FRONT_FACE]:(e,t)=>e.frontFace(t),[n.a.GENERATE_MIPMAP_HINT]:o,[n.a.LINE_WIDTH]:(e,t)=>e.lineWidth(t),[n.a.POLYGON_OFFSET_FILL]:s,[n.a.POLYGON_OFFSET_FACTOR]:"polygonOffset",[n.a.POLYGON_OFFSET_UNITS]:"polygonOffset",[n.a.RASTERIZER_DISCARD]:s,[n.a.SAMPLE_COVERAGE_VALUE]:"sampleCoverage",[n.a.SAMPLE_COVERAGE_INVERT]:"sampleCoverage",[n.a.SCISSOR_TEST]:s,[n.a.SCISSOR_BOX]:(e,t)=>e.scissor(...t),[n.a.STENCIL_TEST]:s,[n.a.STENCIL_CLEAR_VALUE]:(e,t)=>e.clearStencil(t),[n.a.STENCIL_WRITEMASK]:(e,t)=>e.stencilMaskSeparate(n.a.FRONT,t),[n.a.STENCIL_BACK_WRITEMASK]:(e,t)=>e.stencilMaskSeparate(n.a.BACK,t),[n.a.STENCIL_FUNC]:"stencilFuncFront",[n.a.STENCIL_REF]:"stencilFuncFront",[n.a.STENCIL_VALUE_MASK]:"stencilFuncFront",[n.a.STENCIL_BACK_FUNC]:"stencilFuncBack",[n.a.STENCIL_BACK_REF]:"stencilFuncBack",[n.a.STENCIL_BACK_VALUE_MASK]:"stencilFuncBack",[n.a.STENCIL_FAIL]:"stencilOpFront",[n.a.STENCIL_PASS_DEPTH_FAIL]:"stencilOpFront",[n.a.STENCIL_PASS_DEPTH_PASS]:"stencilOpFront",[n.a.STENCIL_BACK_FAIL]:"stencilOpBack",[n.a.STENCIL_BACK_PASS_DEPTH_FAIL]:"stencilOpBack",[n.a.STENCIL_BACK_PASS_DEPTH_PASS]:"stencilOpBack",[n.a.VIEWPORT]:(e,t)=>e.viewport(...t),[n.a.PACK_ALIGNMENT]:E,[n.a.UNPACK_ALIGNMENT]:E,[n.a.UNPACK_FLIP_Y_WEBGL]:E,[n.a.UNPACK_PREMULTIPLY_ALPHA_WEBGL]:E,[n.a.UNPACK_COLORSPACE_CONVERSION_WEBGL]:E,[n.a.PACK_ROW_LENGTH]:E,[n.a.PACK_SKIP_PIXELS]:E,[n.a.PACK_SKIP_ROWS]:E,[n.a.READ_FRAMEBUFFER_BINDING]:(e,t)=>e.bindFramebuffer(n.a.READ_FRAMEBUFFER,t),[n.a.UNPACK_ROW_LENGTH]:E,[n.a.UNPACK_IMAGE_HEIGHT]:E,[n.a.UNPACK_SKIP_PIXELS]:E,[n.a.UNPACK_SKIP_ROWS]:E,[n.a.UNPACK_SKIP_IMAGES]:E,framebuffer:(e,t)=>{const r=t&&"handle"in t?t.handle:t;return e.bindFramebuffer(n.a.FRAMEBUFFER,r)},blend:(e,t)=>t?e.enable(n.a.BLEND):e.disable(n.a.BLEND),blendColor:(e,t)=>e.blendColor(...t),blendEquation:(e,t)=>{t=u(t)?t:[t,t],e.blendEquationSeparate(...t)},blendFunc:(e,t)=>{t=u(t)&&2===t.length?[...t,...t]:t,e.blendFuncSeparate(...t)},clearColor:(e,t)=>e.clearColor(...t),clearDepth:(e,t)=>e.clearDepth(t),clearStencil:(e,t)=>e.clearStencil(t),colorMask:(e,t)=>e.colorMask(...t),cull:(e,t)=>t?e.enable(n.a.CULL_FACE):e.disable(n.a.CULL_FACE),cullFace:(e,t)=>e.cullFace(t),depthTest:(e,t)=>t?e.enable(n.a.DEPTH_TEST):e.disable(n.a.DEPTH_TEST),depthFunc:(e,t)=>e.depthFunc(t),depthMask:(e,t)=>e.depthMask(t),depthRange:(e,t)=>e.depthRange(...t),dither:(e,t)=>t?e.enable(n.a.DITHER):e.disable(n.a.DITHER),derivativeHint:(e,t)=>{e.hint(n.a.FRAGMENT_SHADER_DERIVATIVE_HINT,t)},frontFace:(e,t)=>e.frontFace(t),mipmapHint:(e,t)=>e.hint(n.a.GENERATE_MIPMAP_HINT,t),lineWidth:(e,t)=>e.lineWidth(t),polygonOffsetFill:(e,t)=>t?e.enable(n.a.POLYGON_OFFSET_FILL):e.disable(n.a.POLYGON_OFFSET_FILL),polygonOffset:(e,t)=>e.polygonOffset(...t),sampleCoverage:(e,t)=>e.sampleCoverage(...t),scissorTest:(e,t)=>t?e.enable(n.a.SCISSOR_TEST):e.disable(n.a.SCISSOR_TEST),scissor:(e,t)=>e.scissor(...t),stencilTest:(e,t)=>t?e.enable(n.a.STENCIL_TEST):e.disable(n.a.STENCIL_TEST),stencilMask:(e,t)=>{t=u(t)?t:[t,t];const[r,a]=t;e.stencilMaskSeparate(n.a.FRONT,r),e.stencilMaskSeparate(n.a.BACK,a)},stencilFunc:(e,t)=>{t=u(t)&&3===t.length?[...t,...t]:t;const[r,a,i,s,o,E]=t;e.stencilFuncSeparate(n.a.FRONT,r,a,i),e.stencilFuncSeparate(n.a.BACK,s,o,E)},stencilOp:(e,t)=>{t=u(t)&&3===t.length?[...t,...t]:t;const[r,a,i,s,o,E]=t;e.stencilOpSeparate(n.a.FRONT,r,a,i),e.stencilOpSeparate(n.a.BACK,s,o,E)},viewport:(e,t)=>e.viewport(...t)};function c(e,t,r){return void 0!==t[e]?t[e]:r[e]}const l={blendEquation:(e,t,r)=>e.blendEquationSeparate(c(n.a.BLEND_EQUATION_RGB,t,r),c(n.a.BLEND_EQUATION_ALPHA,t,r)),blendFunc:(e,t,r)=>e.blendFuncSeparate(c(n.a.BLEND_SRC_RGB,t,r),c(n.a.BLEND_DST_RGB,t,r),c(n.a.BLEND_SRC_ALPHA,t,r),c(n.a.BLEND_DST_ALPHA,t,r)),polygonOffset:(e,t,r)=>e.polygonOffset(c(n.a.POLYGON_OFFSET_FACTOR,t,r),c(n.a.POLYGON_OFFSET_UNITS,t,r)),sampleCoverage:(e,t,r)=>e.sampleCoverage(c(n.a.SAMPLE_COVERAGE_VALUE,t,r),c(n.a.SAMPLE_COVERAGE_INVERT,t,r)),stencilFuncFront:(e,t,r)=>e.stencilFuncSeparate(n.a.FRONT,c(n.a.STENCIL_FUNC,t,r),c(n.a.STENCIL_REF,t,r),c(n.a.STENCIL_VALUE_MASK,t,r)),stencilFuncBack:(e,t,r)=>e.stencilFuncSeparate(n.a.BACK,c(n.a.STENCIL_BACK_FUNC,t,r),c(n.a.STENCIL_BACK_REF,t,r),c(n.a.STENCIL_BACK_VALUE_MASK,t,r)),stencilOpFront:(e,t,r)=>e.stencilOpSeparate(n.a.FRONT,c(n.a.STENCIL_FAIL,t,r),c(n.a.STENCIL_PASS_DEPTH_FAIL,t,r),c(n.a.STENCIL_PASS_DEPTH_PASS,t,r)),stencilOpBack:(e,t,r)=>e.stencilOpSeparate(n.a.BACK,c(n.a.STENCIL_BACK_FAIL,t,r),c(n.a.STENCIL_BACK_PASS_DEPTH_FAIL,t,r),c(n.a.STENCIL_BACK_PASS_DEPTH_PASS,t,r))},A={enable:(e,t)=>e({[t]:!0}),disable:(e,t)=>e({[t]:!1}),pixelStorei:(e,t,r)=>e({[t]:r}),hint:(e,t,r)=>e({[t]:r}),bindFramebuffer:(e,t,r)=>{switch(t){case n.a.FRAMEBUFFER:return e({[n.a.DRAW_FRAMEBUFFER_BINDING]:r,[n.a.READ_FRAMEBUFFER_BINDING]:r});case n.a.DRAW_FRAMEBUFFER:return e({[n.a.DRAW_FRAMEBUFFER_BINDING]:r});case n.a.READ_FRAMEBUFFER:return e({[n.a.READ_FRAMEBUFFER_BINDING]:r});default:return null}},blendColor:(e,t,r,a,i)=>e({[n.a.BLEND_COLOR]:new Float32Array([t,r,a,i])}),blendEquation:(e,t)=>e({[n.a.BLEND_EQUATION_RGB]:t,[n.a.BLEND_EQUATION_ALPHA]:t}),blendEquationSeparate:(e,t,r)=>e({[n.a.BLEND_EQUATION_RGB]:t,[n.a.BLEND_EQUATION_ALPHA]:r}),blendFunc:(e,t,r)=>e({[n.a.BLEND_SRC_RGB]:t,[n.a.BLEND_DST_RGB]:r,[n.a.BLEND_SRC_ALPHA]:t,[n.a.BLEND_DST_ALPHA]:r}),blendFuncSeparate:(e,t,r,a,i)=>e({[n.a.BLEND_SRC_RGB]:t,[n.a.BLEND_DST_RGB]:r,[n.a.BLEND_SRC_ALPHA]:a,[n.a.BLEND_DST_ALPHA]:i}),clearColor:(e,t,r,a,i)=>e({[n.a.COLOR_CLEAR_VALUE]:new Float32Array([t,r,a,i])}),clearDepth:(e,t)=>e({[n.a.DEPTH_CLEAR_VALUE]:t}),clearStencil:(e,t)=>e({[n.a.STENCIL_CLEAR_VALUE]:t}),colorMask:(e,t,r,a,i)=>e({[n.a.COLOR_WRITEMASK]:[t,r,a,i]}),cullFace:(e,t)=>e({[n.a.CULL_FACE_MODE]:t}),depthFunc:(e,t)=>e({[n.a.DEPTH_FUNC]:t}),depthRange:(e,t,r)=>e({[n.a.DEPTH_RANGE]:new Float32Array([t,r])}),depthMask:(e,t)=>e({[n.a.DEPTH_WRITEMASK]:t}),frontFace:(e,t)=>e({[n.a.FRONT_FACE]:t}),lineWidth:(e,t)=>e({[n.a.LINE_WIDTH]:t}),polygonOffset:(e,t,r)=>e({[n.a.POLYGON_OFFSET_FACTOR]:t,[n.a.POLYGON_OFFSET_UNITS]:r}),sampleCoverage:(e,t,r)=>e({[n.a.SAMPLE_COVERAGE_VALUE]:t,[n.a.SAMPLE_COVERAGE_INVERT]:r}),scissor:(e,t,r,a,i)=>e({[n.a.SCISSOR_BOX]:new Int32Array([t,r,a,i])}),stencilMask:(e,t)=>e({[n.a.STENCIL_WRITEMASK]:t,[n.a.STENCIL_BACK_WRITEMASK]:t}),stencilMaskSeparate:(e,t,r)=>e({[t===n.a.FRONT?n.a.STENCIL_WRITEMASK:n.a.STENCIL_BACK_WRITEMASK]:r}),stencilFunc:(e,t,r,a)=>e({[n.a.STENCIL_FUNC]:t,[n.a.STENCIL_REF]:r,[n.a.STENCIL_VALUE_MASK]:a,[n.a.STENCIL_BACK_FUNC]:t,[n.a.STENCIL_BACK_REF]:r,[n.a.STENCIL_BACK_VALUE_MASK]:a}),stencilFuncSeparate:(e,t,r,a,i)=>e({[t===n.a.FRONT?n.a.STENCIL_FUNC:n.a.STENCIL_BACK_FUNC]:r,[t===n.a.FRONT?n.a.STENCIL_REF:n.a.STENCIL_BACK_REF]:a,[t===n.a.FRONT?n.a.STENCIL_VALUE_MASK:n.a.STENCIL_BACK_VALUE_MASK]:i}),stencilOp:(e,t,r,a)=>e({[n.a.STENCIL_FAIL]:t,[n.a.STENCIL_PASS_DEPTH_FAIL]:r,[n.a.STENCIL_PASS_DEPTH_PASS]:a,[n.a.STENCIL_BACK_FAIL]:t,[n.a.STENCIL_BACK_PASS_DEPTH_FAIL]:r,[n.a.STENCIL_BACK_PASS_DEPTH_PASS]:a}),stencilOpSeparate:(e,t,r,a,i)=>e({[t===n.a.FRONT?n.a.STENCIL_FAIL:n.a.STENCIL_BACK_FAIL]:r,[t===n.a.FRONT?n.a.STENCIL_PASS_DEPTH_FAIL:n.a.STENCIL_BACK_PASS_DEPTH_FAIL]:a,[t===n.a.FRONT?n.a.STENCIL_PASS_DEPTH_PASS:n.a.STENCIL_BACK_PASS_DEPTH_PASS]:i}),viewport:(e,t,r,a,i)=>e({[n.a.VIEWPORT]:[t,r,a,i]})},f=(e,t)=>e.isEnabled(t),h={[n.a.BLEND]:f,[n.a.CULL_FACE]:f,[n.a.DEPTH_TEST]:f,[n.a.DITHER]:f,[n.a.POLYGON_OFFSET_FILL]:f,[n.a.SAMPLE_ALPHA_TO_COVERAGE]:f,[n.a.SAMPLE_COVERAGE]:f,[n.a.SCISSOR_TEST]:f,[n.a.STENCIL_TEST]:f,[n.a.RASTERIZER_DISCARD]:f}},function(e,t,r){"use strict";(function(e){r.d(t,"c",(function(){return _})),r.d(t,"b",(function(){return c})),r.d(t,"a",(function(){return l}));var n=r(7),a=r(9),i=r(4),s=r(16);function o(e,t){const r=e[t].bind(e);e[t]=function(...t){const n=t[0];return n in e.state.cache||(e.state.cache[n]=r(...t)),e.state.enable?e.state.cache[n]:r(...t)},Object.defineProperty(e[t],"name",{value:t+"-from-cache",configurable:!1})}function E(e,t,r){const n=e[t].bind(e);e[t]=function(...t){const{valueChanged:a,oldValue:i}=r(e.state._updateCache,...t);return a&&n(...t),i},Object.defineProperty(e[t],"name",{value:t+"-to-cache",configurable:!1})}class u{constructor(e,{copyState:t=!1,log:r=(()=>{})}={}){this.gl=e,this.program=null,this.stateStack=[],this.enable=!0,this.cache=t?Object(a.a)(e):Object.assign({},n.c),this.log=r,this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(e={}){this.stateStack.push({})}pop(){Object(i.a)(this.stateStack.length>0);const e=this.stateStack[this.stateStack.length-1];Object(a.b)(this.gl,e),this.stateStack.pop()}_updateCache(e){let t,r=!1;const n=this.stateStack.length>0&&this.stateStack[this.stateStack.length-1];for(const a in e){Object(i.a)(void 0!==a);const o=e[a],E=this.cache[a];Object(s.a)(o,E)||(r=!0,t=E,n&&!(a in n)&&(n[a]=E),this.cache[a]=o)}return{valueChanged:r,oldValue:t}}}function _(t,r={}){const{enable:a=!0,copyState:s}=r;if(Object(i.a)(void 0!==s),!t.state){const r=void 0!==e?e:window,{polyfillContext:a}=r;a&&a(t),t.state=new u(t,{copyState:s}),function(e){const t=e.useProgram.bind(e);e.useProgram=function(r){e.state.program!==r&&(t(r),e.state.program=r)}}(t);for(const e in n.b){E(t,e,n.b[e])}o(t,"getParameter"),o(t,"isEnabled")}return t.state.enable=a,t}function c(e){e.state||_(e,{copyState:!1}),e.state.push()}function l(e){Object(i.a)(e.state),e.state.pop()}}).call(this,r(13))},function(e,t,r){"use strict";r.d(t,"b",(function(){return E})),r.d(t,"a",(function(){return u})),r.d(t,"c",(function(){return _}));var n=r(7),a=r(8),i=r(4),s=r(2),o=r(16);function E(e,t){if(Object(i.a)(Object(s.d)(e),"setParameters requires a WebGL context"),Object(o.b)(t))return;const r={};for(const a in t){const i=Number(a),s=n.e[a];s&&("string"==typeof s?r[s]=!0:s(e,t[a],i))}const a=e.state&&e.state.cache;if(a)for(const i in r){(0,n.a[i])(e,t,a)}}function u(e,t){if("number"==typeof(t=t||n.c)){const r=t,a=n.d[r];return a?a(e,r):e.getParameter(r)}const r=Array.isArray(t)?t:Object.keys(t),a={};for(const t of r){const r=n.d[t];a[t]=r?r(e,Number(t)):e.getParameter(Number(t))}return a}function _(e,t,r){if(Object(o.b)(t))return r(e);const{nocatch:n=!0}=t;let i;if(Object(a.b)(e),E(e,t),n)i=r(e),Object(a.a)(e);else try{i=r(e)}finally{Object(a.a)(e)}return i}},function(e,t){var r,n,a=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function o(e){if(r===setTimeout)return setTimeout(e,0);if((r===i||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:i}catch(e){r=i}try{n="function"==typeof clearTimeout?clearTimeout:s}catch(e){n=s}}();var E,u=[],_=!1,c=-1;function l(){_&&E&&(_=!1,E.length?u=E.concat(u):c=-1,u.length&&A())}function A(){if(!_){var e=o(l);_=!0;for(var t=u.length;t;){for(E=u,u=[];++c<t;)E&&E[c].run();c=-1,t=u.length}E=null,_=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===s||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function h(){}a.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];u.push(new f(e,t)),1!==u.length||_||o(A)},f.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=h,a.addListener=h,a.once=h,a.off=h,a.removeListener=h,a.removeAllListeners=h,a.emit=h,a.prependListener=h,a.prependOnceListener=h,a.listeners=function(e){return[]},a.binding=function(e){throw new Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(e){throw new Error("process.chdir is not supported")},a.umask=function(){return 0}},,function(e,t,r){"use strict";r.d(t,"b",(function(){return E})),r.d(t,"a",(function(){return u}));var n=r(0),a=r(4),i=r(2);const s=e=>Object(i.e)(e)?void 0:0,o={[n.a.READ_BUFFER]:e=>Object(i.e)(e)?void 0:n.a.COLOR_ATTACHMENT0,35723:e=>Object(i.e)(e)?void 0:4352,[n.a.RASTERIZER_DISCARD]:s,[n.a.SAMPLES]:s,36795:(e,t)=>{const r=Object(i.e)(e)?e.getExtension("EXT_disjoint_timer_query_webgl2"):e.getExtension("EXT_disjoint_timer_query");return r&&r.GPU_DISJOINT_EXT?t(r.GPU_DISJOINT_EXT):0},37445:(e,t)=>{const r=e.getExtension("WEBGL_debug_renderer_info");return t(r&&r.UNMASKED_VENDOR_WEBGL||n.a.VENDOR)},37446:(e,t)=>{const r=e.getExtension("WEBGL_debug_renderer_info");return t(r&&r.UNMASKED_RENDERER_WEBGL||n.a.RENDERER)},34047:(e,t)=>{const r=e.luma.extensions.EXT_texture_filter_anisotropic;return r?t(r.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1},[n.a.MAX_3D_TEXTURE_SIZE]:s,[n.a.MAX_ARRAY_TEXTURE_LAYERS]:s,[n.a.MAX_CLIENT_WAIT_TIMEOUT_WEBGL]:s,[n.a.MAX_COLOR_ATTACHMENTS]:(e,t)=>{if(!Object(i.e)(e)){const r=e.getExtension("WEBGL_draw_buffers");return r?t(r.MAX_COLOR_ATTACHMENTS_WEBGL):0}},[n.a.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS]:s,[n.a.MAX_COMBINED_UNIFORM_BLOCKS]:s,[n.a.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS]:s,[n.a.MAX_DRAW_BUFFERS]:e=>{if(!Object(i.e)(e)){const t=e.getExtension("WEBGL_draw_buffers");return t?t.MAX_DRAW_BUFFERS_WEBGL:0}},[n.a.MAX_ELEMENT_INDEX]:e=>e.getExtension("OES_element_index")?2147483647:65535,[n.a.MAX_ELEMENTS_INDICES]:e=>e.getExtension("OES_element_index")?16777216:65535,[n.a.MAX_ELEMENTS_VERTICES]:e=>16777216,[n.a.MAX_FRAGMENT_INPUT_COMPONENTS]:s,[n.a.MAX_FRAGMENT_UNIFORM_BLOCKS]:s,[n.a.MAX_FRAGMENT_UNIFORM_COMPONENTS]:s,[n.a.MAX_SAMPLES]:s,[n.a.MAX_SERVER_WAIT_TIMEOUT]:s,[n.a.MAX_TEXTURE_LOD_BIAS]:s,[n.a.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS]:s,[n.a.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS]:s,[n.a.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS]:s,[n.a.MAX_UNIFORM_BLOCK_SIZE]:s,[n.a.MAX_UNIFORM_BUFFER_BINDINGS]:s,[n.a.MAX_VARYING_COMPONENTS]:s,[n.a.MAX_VERTEX_OUTPUT_COMPONENTS]:s,[n.a.MAX_VERTEX_UNIFORM_BLOCKS]:s,[n.a.MAX_VERTEX_UNIFORM_COMPONENTS]:s,[n.a.MIN_PROGRAM_TEXEL_OFFSET]:s,[n.a.MAX_PROGRAM_TEXEL_OFFSET]:s,[n.a.UNIFORM_BUFFER_OFFSET_ALIGNMENT]:s};const E={OES_vertex_array_object:{meta:{suffix:"OES"},createVertexArray:()=>{Object(a.a)(!1,"VertexArray requires WebGL2 or OES_vertex_array_object extension")},deleteVertexArray:()=>{},bindVertexArray:()=>{},isVertexArray:()=>!1},ANGLE_instanced_arrays:{meta:{suffix:"ANGLE"},vertexAttribDivisor(e,t){Object(a.a)(0===t,"WebGL instanced rendering not supported")},drawElementsInstanced:()=>{},drawArraysInstanced:()=>{}},WEBGL_draw_buffers:{meta:{suffix:"WEBGL"},drawBuffers:()=>{Object(a.a)(!1)}},EXT_disjoint_timer_query:{meta:{suffix:"EXT"},createQuery:()=>{Object(a.a)(!1)},deleteQuery:()=>{Object(a.a)(!1)},beginQuery:()=>{Object(a.a)(!1)},endQuery:()=>{},getQuery(e,t){return this.getQueryObject(e,t)},getQueryParameter(e,t){return this.getQueryObject(e,t)},getQueryObject:()=>{}}},u={readBuffer:(e,t,r)=>{Object(i.e)(e)&&t(r)},getVertexAttrib:(e,t,r,a)=>{const{webgl2:s,ext:o}=function(e,t){return{webgl2:Object(i.e)(e),ext:e.getExtension(t)}}(e,"ANGLE_instanced_arrays");let E;switch(a){case n.a.VERTEX_ATTRIB_ARRAY_INTEGER:E=!!s&&void 0;break;case n.a.VERTEX_ATTRIB_ARRAY_DIVISOR:E=s||o?void 0:0}return void 0!==E?E:t(r,a)},getProgramParameter:(e,t,r,a)=>{if(!Object(i.e)(e))switch(a){case n.a.TRANSFORM_FEEDBACK_BUFFER_MODE:return n.a.SEPARATE_ATTRIBS;case n.a.TRANSFORM_FEEDBACK_VARYINGS:case n.a.ACTIVE_UNIFORM_BLOCKS:return 0}return t(r,a)},getInternalformatParameter:(e,t,r,a,s)=>{if(!Object(i.e)(e))switch(s){case n.a.SAMPLES:return new Int32Array([0])}return e.getInternalformatParameter(r,a,s)},getTexParameter(e,t,r,a){switch(a){case n.a.TEXTURE_MAX_ANISOTROPY_EXT:const{extensions:t}=e.luma,r=t.EXT_texture_filter_anisotropic;a=r&&r.TEXTURE_MAX_ANISOTROPY_EXT||n.a.TEXTURE_MAX_ANISOTROPY_EXT}return t(r,a)},getParameter:function(e,t,r){const n=o[r],a="function"==typeof n?n(e,t,r):n;return void 0!==a?a:t(r)},hint:(e,t,r,n)=>t(r,n)}},function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t){e.exports=function(e){return e&&e.__esModule?e:{default:e}}},function(e,t,r){"use strict";(function(e){function n(){var t;if("undefined"!=typeof window&&window.performance)t=window.performance.now();else if(void 0!==e&&e.hrtime){var r=e.hrtime();t=1e3*r[0]+r[1]/1e6}else t=Date.now();return t}r.d(t,"a",(function(){return n}))}).call(this,r(10))},function(e,t,r){"use strict";function n(e){for(const t in e)return!1;return!0}function a(e,t){if(e===t)return!0;const r=Array.isArray(e)||ArrayBuffer.isView(e),n=Array.isArray(t)||ArrayBuffer.isView(t);if(r&&n&&e.length===t.length){for(let r=0;r<e.length;++r)if(e[r]!==t[r])return!1;return!0}return!1}r.d(t,"b",(function(){return n})),r.d(t,"a",(function(){return a}))},function(e,t){function r(t){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?e.exports=r=function(e){return typeof e}:e.exports=r=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(t)}e.exports=r},function(e,t,r){"use strict";(function(e){r.d(t,"a",(function(){return i}));var n=r(6),a=r(19);function i(){return!("object"===(void 0===e?"undefined":Object(n.a)(e))&&"[object process]"===String(e)&&!e.browser)||Object(a.a)()}}).call(this,r(10))},function(e,t,r){"use strict";(function(e){r.d(t,"a",(function(){return a}));var n=r(6);function a(t){if("undefined"!=typeof window&&"object"===Object(n.a)(window.process)&&"renderer"===window.process.type)return!0;if(void 0!==e&&"object"===Object(n.a)(e.versions)&&Boolean(e.versions.electron))return!0;var r="object"===("undefined"==typeof navigator?"undefined":Object(n.a)(navigator))&&"string"==typeof navigator.userAgent&&navigator.userAgent,a=t||r;return!!(a&&a.indexOf("Electron")>=0)}}).call(this,r(10))},function(e,t,r){"use strict";(function(e){var n=r(14);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(t){if("undefined"!=typeof window&&"object"===(0,a.default)(window.process)&&"renderer"===window.process.type)return!0;if(void 0!==e&&"object"===(0,a.default)(e.versions)&&Boolean(e.versions.electron))return!0;var r="object"===("undefined"==typeof navigator?"undefined":(0,a.default)(navigator))&&"string"==typeof navigator.userAgent&&navigator.userAgent,n=t||r;if(n&&n.indexOf("Electron")>=0)return!0;return!1};var a=n(r(17))}).call(this,r(10))},,function(e,t,r){"use strict";(function(e){var t=r(25),n=r(4),a=r(12);function i(e,{extension:t,target:r,target2:i}){const s=a.b[t];Object(n.a)(s);const{meta:o={}}=s,{suffix:E=""}=o,u=e.getExtension(t);for(const t of Object.keys(s)){const n=`${t}${E}`;let a=null;"meta"===t||"function"==typeof e[t]||(u&&"function"==typeof u[n]?a=(...e)=>u[n](...e):"function"==typeof s[t]&&(a=s[t].bind(r))),a&&(r[t]=a,i[t]=a)}}(void 0!==e?e:window).polyfillContext=function(e){e.luma=e.luma||{};const{luma:r}=e;return r.polyfilled||(Object(t.a)(e),function(e){e.luma.extensions={};const t=e.getSupportedExtensions()||[];for(const r of t)e.luma[r]=e.getExtension(r)}(e),function(e,t){for(const r of Object.getOwnPropertyNames(t))"overrides"!==r&&i(e,{extension:r,target:e.luma,target2:e})}(e,a.b),function(e,{target:t,target2:r}){Object.keys(a.a).forEach(n=>{if("function"==typeof a.a[n]){const i=e[n]?e[n].bind(e):()=>{},s=a.a[n].bind(null,e,i);t[n]=s,r[n]=s}})}(e,{target:r,target2:e}),r.polyfilled=!0),e}}).call(this,r(13))},function(e,t,r){"use strict";(function(e,n){var a=r(14);Object.defineProperty(t,"__esModule",{value:!0}),t.console=t.process=t.document=t.global=t.window=t.self=void 0;var i=a(r(17)),s={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:void 0!==e&&e,document:"undefined"!=typeof document&&document,process:"object"===(void 0===n?"undefined":(0,i.default)(n))&&n},o=s.self||s.window||s.global;t.self=o;var E=s.window||s.self||s.global;t.window=E;var u=s.global||s.self||s.window;t.global=u;var _=s.document||{};t.document=_;var c=s.process||{};t.process=c;var l=console;t.console=l}).call(this,r(13),r(10))},function(e,t,r){"use strict";(function(e){var n=r(14);Object.defineProperty(t,"__esModule",{value:!0}),t.default=s,t.isBrowserMainThread=function(){return s()&&"undefined"!=typeof document};var a=n(r(17)),i=n(r(20));function s(){return!("object"===(void 0===e?"undefined":(0,a.default)(e))&&"[object process]"===String(e)&&!e.browser)||(0,i.default)()}}).call(this,r(10))},function(e,t,r){"use strict";r.d(t,"a",(function(){return E}));var n=r(3);const a={};function i(e,t){var r;a[e]=!0,void 0!==t&&(r=t,n.global.console&&n.global.console.error&&n.global.console.error(r))}const s=function e(t){const r=t.gl;this.ext=t,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(t.maxVertexAttribs);for(let t=0;t<this.attribs.length;t++){const n=new e.VertexAttrib(r);this.attribs[t]=n}this.maxAttrib=0};(s.VertexAttrib=function(e){this.enabled=!1,this.buffer=null,this.size=4,this.type=e.FLOAT,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()}).prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};const o=function(e){const t=this;this.gl=e,function(e){const t=e.getError;e.getError=function(){let r;do{r=t.apply(e),r!==e.NO_ERROR&&(a[r]=!0)}while(r!==e.NO_ERROR);for(r in a)if(a[r])return delete a[r],parseInt(r,10);return e.NO_ERROR}}(e);const r=this.original={getParameter:e.getParameter,enableVertexAttribArray:e.enableVertexAttribArray,disableVertexAttribArray:e.disableVertexAttribArray,bindBuffer:e.bindBuffer,getVertexAttrib:e.getVertexAttrib,vertexAttribPointer:e.vertexAttribPointer};e.getParameter=function(e){return e===t.VERTEX_ARRAY_BINDING_OES?t.currentVertexArrayObject===t.defaultVertexArrayObject?null:t.currentVertexArrayObject:r.getParameter.apply(this,arguments)},e.enableVertexAttribArray=function(e){const n=t.currentVertexArrayObject;n.maxAttrib=Math.max(n.maxAttrib,e);const a=n.attribs[e];return a.enabled=!0,r.enableVertexAttribArray.apply(this,arguments)},e.disableVertexAttribArray=function(e){const n=t.currentVertexArrayObject;n.maxAttrib=Math.max(n.maxAttrib,e);const a=n.attribs[e];return a.enabled=!1,r.disableVertexAttribArray.apply(this,arguments)},e.bindBuffer=function(n,a){switch(n){case e.ARRAY_BUFFER:t.currentArrayBuffer=a;break;case e.ELEMENT_ARRAY_BUFFER:t.currentVertexArrayObject.elementArrayBuffer=a}return r.bindBuffer.apply(this,arguments)},e.getVertexAttrib=function(n,a){const i=t.currentVertexArrayObject,s=i.attribs[n];switch(a){case e.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:return s.buffer;case e.VERTEX_ATTRIB_ARRAY_ENABLED:return s.enabled;case e.VERTEX_ATTRIB_ARRAY_SIZE:return s.size;case e.VERTEX_ATTRIB_ARRAY_STRIDE:return s.stride;case e.VERTEX_ATTRIB_ARRAY_TYPE:return s.type;case e.VERTEX_ATTRIB_ARRAY_NORMALIZED:return s.normalized;default:return r.getVertexAttrib.apply(this,arguments)}},e.vertexAttribPointer=function(e,n,a,i,s,o){const E=t.currentVertexArrayObject;E.maxAttrib=Math.max(E.maxAttrib,e);const u=E.attribs[e];return u.buffer=t.currentArrayBuffer,u.size=n,u.type=a,u.normalized=i,u.stride=s,u.offset=o,u.recache(),r.vertexAttribPointer.apply(this,arguments)},e.instrumentExtension&&e.instrumentExtension(this,"OES_vertex_array_object"),e.canvas&&e.canvas.addEventListener("webglcontextrestored",()=>{var e;e="OESVertexArrayObject emulation library context restored",n.global.console&&n.global.console.log&&n.global.console.log(e),t.reset_()},!0),this.reset_()};function E(e){if("function"==typeof e.createVertexArray)return;const t=e.getSupportedExtensions;e.getSupportedExtensions=function(){const e=t.call(this)||[];return e.indexOf("OES_vertex_array_object")<0&&e.push("OES_vertex_array_object"),e};const r=e.getExtension;e.getExtension=function(t){const n=r.call(this,t);return n||("OES_vertex_array_object"!==t?null:(e.__OESVertexArrayObject||(this.__OESVertexArrayObject=new o(this)),this.__OESVertexArrayObject))}}o.prototype.VERTEX_ARRAY_BINDING_OES=34229,o.prototype.reset_=function(){if(void 0!==this.vertexArrayObjects)for(let e=0;e<this.vertexArrayObjects.length;++e)this.vertexArrayObjects.isAlive=!1;const e=this.gl;this.maxVertexAttribs=e.getParameter(e.MAX_VERTEX_ATTRIBS),this.defaultVertexArrayObject=new s(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)},o.prototype.createVertexArrayOES=function(){const e=new s(this);return this.vertexArrayObjects.push(e),e},o.prototype.deleteVertexArrayOES=function(e){e.isAlive=!1,this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(e),1),this.currentVertexArrayObject===e&&this.bindVertexArrayOES(null)},o.prototype.isVertexArrayOES=function(e){return!!(e&&e instanceof s&&e.hasBeenBound&&e.ext===this)},o.prototype.bindVertexArrayOES=function(e){const t=this.gl;if(e&&!e.isAlive)return void i(t.INVALID_OPERATION,"bindVertexArrayOES: attempt to bind deleted arrayObject");const r=this.original,n=this.currentVertexArrayObject;this.currentVertexArrayObject=e||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;const a=this.currentVertexArrayObject;if(n===a)return;n&&a.elementArrayBuffer===n.elementArrayBuffer||r.bindBuffer.call(t,t.ELEMENT_ARRAY_BUFFER,a.elementArrayBuffer);let s=this.currentArrayBuffer;const o=Math.max(n?n.maxAttrib:0,a.maxAttrib);for(let e=0;e<=o;e++){const i=a.attribs[e],o=n?n.attribs[e]:null;if(n&&i.enabled===o.enabled||(i.enabled?r.enableVertexAttribArray.call(t,e):r.disableVertexAttribArray.call(t,e)),i.enabled){let a=!1;n&&i.buffer===o.buffer||(s!==i.buffer&&(r.bindBuffer.call(t,t.ARRAY_BUFFER,i.buffer),s=i.buffer),a=!0),(a||i.cached!==o.cached)&&r.vertexAttribPointer.call(t,e,i.size,i.type,i.normalized,i.stride,i.offset)}}this.currentArrayBuffer!==s&&r.bindBuffer.call(t,t.ARRAY_BUFFER,this.currentArrayBuffer)}},function(e,t,r){(function(t){const n=r(32),a="undefined"==typeof window?t:window;a.luma=a.luma||{},e.exports=Object.assign(a.luma,n)}).call(this,r(13))},,function(e,t){},function(e,t,r){"use strict";var n=r(14),a=r(30);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"self",{enumerable:!0,get:function(){return i.self}}),Object.defineProperty(t,"window",{enumerable:!0,get:function(){return i.window}}),Object.defineProperty(t,"global",{enumerable:!0,get:function(){return i.global}}),Object.defineProperty(t,"document",{enumerable:!0,get:function(){return i.document}}),Object.defineProperty(t,"process",{enumerable:!0,get:function(){return i.process}}),Object.defineProperty(t,"console",{enumerable:!0,get:function(){return i.console}}),Object.defineProperty(t,"isBrowser",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(t,"isBrowserMainThread",{enumerable:!0,get:function(){return s.isBrowserMainThread}}),Object.defineProperty(t,"getBrowser",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(t,"isMobile",{enumerable:!0,get:function(){return o.isMobile}}),Object.defineProperty(t,"isElectron",{enumerable:!0,get:function(){return E.default}});var i=r(23),s=a(r(24)),o=a(r(31)),E=n(r(20))},function(e,t,r){var n=r(17);function a(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return a=function(){return e},e}e.exports=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==n(e)&&"function"!=typeof e)return{default:e};var t=a();if(t&&t.has(e))return t.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){var o=i?Object.getOwnPropertyDescriptor(e,s):null;o&&(o.get||o.set)?Object.defineProperty(r,s,o):r[s]=e[s]}return r.default=e,t&&t.set(e,r),r}},function(e,t,r){"use strict";var n=r(14);Object.defineProperty(t,"__esModule",{value:!0}),t.isMobile=function(){return void 0!==a.window.orientation},t.default=function(e){if(!e&&!(0,i.default)())return"Node";if((0,s.default)(e))return"Electron";var t="undefined"!=typeof navigator?navigator:{},r=e||t.userAgent||"";if(r.indexOf("Edge")>-1)return"Edge";var n=-1!==r.indexOf("MSIE "),o=-1!==r.indexOf("Trident/");if(n||o)return"IE";if(a.window.chrome)return"Chrome";if(a.window.safari)return"Safari";if(a.window.mozInnerScreenX)return"Firefox";return"Unknown"};var a=r(23),i=n(r(24)),s=n(r(20))},function(e,t,r){"use strict";r.r(t),r.d(t,"lumaStats",(function(){return V})),r.d(t,"requestAnimationFrame",(function(){return j})),r.d(t,"cancelAnimationFrame",(function(){return W})),r.d(t,"cloneTextureFrom",(function(){return Ye})),r.d(t,"getKeyValue",(function(){return K})),r.d(t,"getKey",(function(){return Y})),r.d(t,"getContextInfo",(function(){return qe})),r.d(t,"getGLContextInfo",(function(){return Qe})),r.d(t,"getContextLimits",(function(){return Ze})),r.d(t,"FEATURES",(function(){return we})),r.d(t,"hasFeature",(function(){return Xe})),r.d(t,"hasFeatures",(function(){return Ve})),r.d(t,"getFeatures",(function(){return je})),r.d(t,"canCompileGLGSExtension",(function(){return et})),r.d(t,"Accessor",(function(){return oe})),r.d(t,"Buffer",(function(){return ce})),r.d(t,"Shader",(function(){return it})),r.d(t,"VertexShader",(function(){return st})),r.d(t,"FragmentShader",(function(){return ot})),r.d(t,"Program",(function(){return Ut})),r.d(t,"Framebuffer",(function(){return ke})),r.d(t,"Renderbuffer",(function(){return Be})),r.d(t,"Texture2D",(function(){return Fe})),r.d(t,"TextureCube",(function(){return be})),r.d(t,"clear",(function(){return Ce})),r.d(t,"clearBuffer",(function(){return Me})),r.d(t,"readPixelsToArray",(function(){return Ue})),r.d(t,"readPixelsToBuffer",(function(){return ye})),r.d(t,"copyToDataUrl",(function(){return Pe})),r.d(t,"copyToImage",(function(){return De})),r.d(t,"copyToTexture",(function(){return ve})),r.d(t,"blit",(function(){return Ge})),r.d(t,"Query",(function(){return yt})),r.d(t,"Texture3D",(function(){return Se})),r.d(t,"TransformFeedback",(function(){return Pt})),r.d(t,"VertexArrayObject",(function(){return xt})),r.d(t,"VertexArray",(function(){return Xt})),r.d(t,"UniformBufferLayout",(function(){return Vt})),r.d(t,"setPathPrefix",(function(){return ge})),r.d(t,"loadFile",(function(){return Ne})),r.d(t,"loadImage",(function(){return me})),r.d(t,"getShaderName",(function(){return tt})),r.d(t,"getShaderVersion",(function(){return jt})),r.d(t,"log",(function(){return U})),r.d(t,"assert",(function(){return k})),r.d(t,"uid",(function(){return $})),r.d(t,"isObjectEmpty",(function(){return Q})),r.d(t,"parseUniformName",(function(){return Rt})),r.d(t,"getUniformSetter",(function(){return dt})),r.d(t,"getDebugTableForUniforms",(function(){return kt})),r.d(t,"getDebugTableForVertexArray",(function(){return Yt})),r.d(t,"getDebugTableForProgramConfiguration",(function(){return Zt}));var n=r(6);function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function i(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return a(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function E(e,t,r){return t&&o(e.prototype,t),r&&o(e,r),e}var u=r(18),_=Object(u.a)();function c(e){try{var t=window[e],r="__storage_test__";return t.setItem(r,r),t.removeItem(r),t}catch(e){return null}}var l=function(){function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"sessionStorage";s(this,e),this.storage=c(n),this.id=t,this.config={},Object.assign(this.config,r),this._loadConfiguration()}return E(e,[{key:"getConfiguration",value:function(){return this.config}},{key:"setConfiguration",value:function(e){return this.config={},this.updateConfiguration(e)}},{key:"updateConfiguration",value:function(e){if(Object.assign(this.config,e),this.storage){var t=JSON.stringify(this.config);this.storage.setItem(this.id,t)}return this}},{key:"_loadConfiguration",value:function(){var e={};if(this.storage){var t=this.storage.getItem(this.id);e=t?JSON.parse(t):{}}return Object.assign(this.config,e),this}}]),e}();function A(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:600,a=e.src.replace(/\(/g,"%28").replace(/\)/g,"%29");e.width>n&&(r=Math.min(r,n/e.width));var i=e.width*r,s=e.height*r,o=["font-size:1px;","padding:".concat(Math.floor(s/2),"px ").concat(Math.floor(i/2),"px;"),"line-height:".concat(s,"px;"),"background:url(".concat(a,");"),"background-size:".concat(i,"px ").concat(s,"px;"),"color:transparent;"].join("");return["".concat(t," %c+"),o]}var f={BLACK:30,RED:31,GREEN:32,YELLOW:33,BLUE:34,MAGENTA:35,CYAN:36,WHITE:37,BRIGHT_BLACK:90,BRIGHT_RED:91,BRIGHT_GREEN:92,BRIGHT_YELLOW:93,BRIGHT_BLUE:94,BRIGHT_MAGENTA:95,BRIGHT_CYAN:96,BRIGHT_WHITE:97};function h(e){return"string"==typeof e?f[e.toUpperCase()]||f.WHITE:e}function T(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return d(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return d(e,t)}(e))){var t=0,r=function(){};return{s:r,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,a,i=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw a}}}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function R(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["constructor"],n=Object.getPrototypeOf(e),a=Object.getOwnPropertyNames(n),i=T(a);try{var s=function(){var n=t.value;"function"==typeof e[n]&&(r.find((function(e){return n===e}))||(e[n]=e[n].bind(e)))};for(i.s();!(t=i.n()).done;)s()}catch(e){i.e(e)}finally{i.f()}}function g(e,t){if(!e)throw new Error(t||"Assertion failed")}var N=r(5);function m(){var e;if(_&&N.b.performance)e=N.b.performance.now();else if(N.a.hrtime){var t=N.a.hrtime();e=1e3*t[0]+t[1]/1e6}else e=Date.now();return e}var F={debug:_&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},O={enabled:!0,level:0};function b(){}var S={},I={once:!0};function L(e){for(var t in e)for(var r in e[t])return r||"untitled";return"empty"}var B=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.id;s(this,e),this.id=r,this.VERSION="8.4.3",this._startTs=m(),this._deltaTs=m(),this.LOG_THROTTLE_TIMEOUT=0,this._storage=new l("__probe-".concat(this.id,"__"),O),this.userData={},this.timeStamp("".concat(this.id," started")),R(this),Object.seal(this)}return E(e,[{key:"isEnabled",value:function(){return this._storage.config.enabled}},{key:"getLevel",value:function(){return this._storage.config.level}},{key:"getTotal",value:function(){return Number((m()-this._startTs).toPrecision(10))}},{key:"getDelta",value:function(){return Number((m()-this._deltaTs).toPrecision(10))}},{key:"getPriority",value:function(){return this.level}},{key:"enable",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._storage.updateConfiguration({enabled:e}),this}},{key:"setLevel",value:function(e){return this._storage.updateConfiguration({level:e}),this}},{key:"assert",value:function(e,t){g(e,t)}},{key:"warn",value:function(e){return this._getLogFunction(0,e,F.warn,arguments,I)}},{key:"error",value:function(e){return this._getLogFunction(0,e,F.error,arguments)}},{key:"deprecated",value:function(e,t){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(t,"` instead"))}},{key:"removed",value:function(e,t){return this.error("`".concat(e,"` has been removed. Use `").concat(t,"` instead"))}},{key:"probe",value:function(e,t){return this._getLogFunction(e,t,F.log,arguments,{time:!0,once:!0})}},{key:"log",value:function(e,t){return this._getLogFunction(e,t,F.debug,arguments)}},{key:"info",value:function(e,t){return this._getLogFunction(e,t,console.info,arguments)}},{key:"once",value:function(e,t){return this._getLogFunction(e,t,F.debug||F.info,arguments,I)}},{key:"table",value:function(e,t,r){return t?this._getLogFunction(e,t,console.table||b,r&&[r],{tag:L(t)}):b}},{key:"image",value:function(e){var t=e.logLevel,n=e.priority,a=e.image,s=e.message,o=void 0===s?"":s,E=e.scale,u=void 0===E?1:E;return this._shouldLog(t||n)?_?function(e){var t=e.image,r=e.message,n=void 0===r?"":r,a=e.scale,s=void 0===a?1:a;if("string"==typeof t){var o=new Image;return o.onload=function(){var e,t=A(o,n,s);(e=console).log.apply(e,i(t))},o.src=t,b}var E=t.nodeName||"";if("img"===E.toLowerCase()){var u;return(u=console).log.apply(u,i(A(t,n,s))),b}if("canvas"===E.toLowerCase()){var _=new Image;return _.onload=function(){var e;return(e=console).log.apply(e,i(A(_,n,s)))},_.src=t.toDataURL(),b}return b}({image:a,message:o,scale:u}):function(e){var t=e.image,n=(e.message,e.scale),a=void 0===n?1:n,i=null;try{i=r(28)}catch(e){}if(i)return function(){return i(t,{fit:"box",width:"".concat(Math.round(80*a),"%")}).then((function(e){return console.log(e)}))};return b}({image:a,message:o,scale:u}):b}},{key:"settings",value:function(){console.table?console.table(this._storage.config):console.log(this._storage.config)}},{key:"get",value:function(e){return this._storage.config[e]}},{key:"set",value:function(e,t){this._storage.updateConfiguration(function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}({},e,t))}},{key:"time",value:function(e,t){return this._getLogFunction(e,t,console.time?console.time:console.info)}},{key:"timeEnd",value:function(e,t){return this._getLogFunction(e,t,console.timeEnd?console.timeEnd:console.info)}},{key:"timeStamp",value:function(e,t){return this._getLogFunction(e,t,console.timeStamp||b)}},{key:"group",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{collapsed:!1},n=r=M({logLevel:e,message:t,opts:r}),a=n.collapsed;return r.method=(a?console.groupCollapsed:console.group)||console.info,this._getLogFunction(r)}},{key:"groupCollapsed",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.group(e,t,Object.assign({},r,{collapsed:!0}))}},{key:"groupEnd",value:function(e){return this._getLogFunction(e,"",console.groupEnd||b)}},{key:"withGroup",value:function(e,t,r){this.group(e,t)();try{r()}finally{this.groupEnd(e)()}}},{key:"trace",value:function(){console.trace&&console.trace()}},{key:"_shouldLog",value:function(e){return this.isEnabled()&&this.getLevel()>=C(e)}},{key:"_getLogFunction",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments.length>4?arguments[4]:void 0;if(this._shouldLog(e)){var s;a=M({logLevel:e,message:t,args:n,opts:a}),g(r=r||a.method),a.total=this.getTotal(),a.delta=this.getDelta(),this._deltaTs=m();var o=a.tag||a.message;if(a.once){if(S[o])return b;S[o]=m()}return t=p(this.id,a.message,a),(s=r).bind.apply(s,[console,t].concat(i(a.args)))}return b}},{key:"level",set:function(e){this.setLevel(e)},get:function(){return this.getLevel()}},{key:"priority",set:function(e){this.level=e},get:function(){return this.level}}]),e}();function C(e){if(!e)return 0;var t;switch(Object(n.a)(e)){case"number":t=e;break;case"object":t=e.logLevel||e.priority||0;break;default:return 0}return g(Number.isFinite(t)&&t>=0),t}function M(e){var t=e.logLevel,r=e.message;e.logLevel=C(t);for(var a=e.args?Array.from(e.args):[];a.length&&a.shift()!==r;);switch(e.args=a,Object(n.a)(t)){case"string":case"function":void 0!==r&&a.unshift(r),e.message=t;break;case"object":Object.assign(e,t)}"function"==typeof e.message&&(e.message=e.message());var i=Object(n.a)(e.message);return g("string"===i||"object"===i),Object.assign(e,e.opts)}function p(e,t,r){if("string"==typeof t){var n=r.time?function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,r=Math.max(t-e.length,0);return"".concat(" ".repeat(r)).concat(e)}((o=r.total)<10?"".concat(o.toFixed(2),"ms"):o<100?"".concat(o.toFixed(1),"ms"):o<1e3?"".concat(o.toFixed(0),"ms"):"".concat((o/1e3).toFixed(2),"s")):"";t=r.time?"".concat(e,": ").concat(n,"  ").concat(t):"".concat(e,": ").concat(t),a=t,i=r.color,s=r.background,_||"string"!=typeof a||(i&&(i=h(i),a="[".concat(i,"m").concat(a,"[39m")),s&&(i=h(s),a="[".concat(s+10,"m").concat(a,"[49m"))),t=a}var a,i,s,o;return t}B.VERSION="8.4.3";const U=new B({id:"luma.gl"});var y=r(2),P=(r(22),r(9)),D=(r(8),r(0)),v=r(3);r(4);const G=Object(v.isBrowser)();function x(e){const t=e.getParameter(D.a.VENDOR),r=e.getParameter(D.a.RENDERER),n=e.getExtension("WEBGL_debug_renderer_info");return{vendor:n&&e.getParameter(n.UNMASKED_VENDOR_WEBGL||D.a.VENDOR)||t,renderer:n&&e.getParameter(n.UNMASKED_RENDERER_WEBGL||D.a.RENDERER)||r,vendorMasked:t,rendererMasked:r,version:e.getParameter(D.a.VERSION),shadingLanguageVersion:e.getParameter(D.a.SHADING_LANGUAGE_VERSION)}}var w=r(15),H=function(){function e(t,r){s(this,e),this.name=t,this.type=r,this.sampleSize=1,this.reset()}return E(e,[{key:"setSampleSize",value:function(e){return this.sampleSize=e,this}},{key:"incrementCount",value:function(){return this.addCount(1),this}},{key:"decrementCount",value:function(){return this.subtractCount(1),this}},{key:"addCount",value:function(e){return this._count+=e,this._samples++,this._checkSampling(),this}},{key:"subtractCount",value:function(e){return this._count-=e,this._samples++,this._checkSampling(),this}},{key:"addTime",value:function(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}},{key:"timeStart",value:function(){return this._startTime=Object(w.a)(),this._timerPending=!0,this}},{key:"timeEnd",value:function(){return this._timerPending?(this.addTime(Object(w.a)()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}},{key:"getSampleAverageCount",value:function(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}},{key:"getSampleAverageTime",value:function(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}},{key:"getSampleHz",value:function(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}},{key:"getAverageCount",value:function(){return this.samples>0?this.count/this.samples:0}},{key:"getAverageTime",value:function(){return this.samples>0?this.time/this.samples:0}},{key:"getHz",value:function(){return this.time>0?this.samples/(this.time/1e3):0}},{key:"reset",value:function(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}},{key:"_checkSampling",value:function(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}]),e}(),X=function(){function e(t){var r=t.id,n=t.stats;s(this,e),this.id=r,this.stats={},this._initializeStats(n),Object.seal(this)}return E(e,[{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"count";return this._getOrCreate({name:e,type:t})}},{key:"reset",value:function(){for(var e in this.stats)this.stats[e].reset();return this}},{key:"forEach",value:function(e){for(var t in this.stats)e(this.stats[t])}},{key:"getTable",value:function(){var e={};return this.forEach((function(t){e[t.name]={time:t.time||0,count:t.count||0,average:t.getAverageTime()||0,hz:t.getHz()||0}})),e}},{key:"_initializeStats",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t.forEach((function(t){return e._getOrCreate(t)}))}},{key:"_getOrCreate",value:function(e){if(!e||!e.name)return null;var t=e.name,r=e.type;return this.stats[t]||(this.stats[t]=e instanceof H?e:new H(t,r)),this.stats[t]}},{key:"size",get:function(){return Object.keys(this.stats).length}}]),e}();const V=new class{constructor(){this.stats=new Map}get(e){return this.stats.has(e)||this.stats.set(e,new X({id:e})),this.stats.get(e)}};if(v.global.luma&&"8.4.3"!==v.global.luma.VERSION)throw new Error(`luma.gl - multiple VERSIONs detected: ${v.global.luma.VERSION} vs 8.4.3`);v.global.luma||(Object(v.isBrowser)()&&U.log(1,"luma.gl 8.4.3 - set luma.log.level=1 (or higher) to trace rendering")(),v.global.luma=v.global.luma||{VERSION:"8.4.3",version:"8.4.3",log:U,stats:V,globals:{modules:{},nodeIO:{}}});v.global.luma;function j(e){return"undefined"!=typeof window&&window.requestAnimationFrame?window.requestAnimationFrame(e):setTimeout(e,1e3/60)}function W(e){return"undefined"!=typeof window&&window.cancelAnimationFrame?window.cancelAnimationFrame(e):clearTimeout(e)}function k(e,t){if(!e)throw new Error(t||"luma.gl: assertion failed.")}function K(e,t){if("string"!=typeof t)return t;const r=Number(t);if(!isNaN(r))return r;const n=e[t=t.replace(/^.*\./,"")];return k(void 0!==n,"Accessing undefined constant GL."+t),n}function Y(e,t){t=Number(t);for(const r in e)if(e[r]===t)return"GL."+r;return String(t)}const z={};function $(e="id"){z[e]=z[e]||1;return`${e}-${z[e]++}`}function Z(e){return k("number"==typeof e,"Input must be a number"),e&&0==(e&e-1)}function Q(e){let t=!0;for(const r in e){t=!1;break}return t}function q(e,t,r,n){const a=`See luma.gl ${r} Upgrade Guide at https://luma.gl/docs/upgrade-guide`,i=Object.getPrototypeOf(e);n.forEach(e=>{i.methodName||(i[e]=()=>{throw U.removed(`Calling removed method ${t}.${e}: `,a)(),new Error(e)})})}const J="Resource subclass must define virtual methods";class ee{constructor(e,t={}){Object(y.b)(e);const{id:r,userData:n={}}=t;this.gl=e,this.gl2=e,this.id=r||$(this.constructor.name),this.userData=n,this._bound=!1,this._handle=t.handle,void 0===this._handle&&(this._handle=this._createHandle()),this.byteLength=0,this._addStats()}toString(){return`${this.constructor.name}(${this.id})`}get handle(){return this._handle}delete({deleteChildren:e=!1}={}){const t=this._handle&&this._deleteHandle(this._handle);return this._handle&&this._removeStats(),this._handle=null,t&&e&&t.filter(Boolean).forEach(e=>e.delete()),this}bind(e=this.handle){if("function"!=typeof e)return this._bindHandle(e),this;let t;return this._bound?t=e():(this._bindHandle(this.handle),this._bound=!0,t=e(),this._bound=!1,this._bindHandle(null)),t}unbind(){this.bind(null)}getParameter(e,t={}){k(e=K(this.gl,e));const r=(this.constructor.PARAMETERS||{})[e];if(r){const e=Object(y.e)(this.gl);if(!((!("webgl2"in r)||e)&&(!("extension"in r)||this.gl.getExtension(r.extension)))){const t=r.webgl1,n="webgl2"in r?r.webgl2:r.webgl1;return e?n:t}}return this._getParameter(e,t)}getParameters(e={}){const{parameters:t,keys:r}=e,n=this.constructor.PARAMETERS||{},a=Object(y.e)(this.gl),i={},s=t||Object.keys(n);for(const t of s){const s=n[t];if(s&&(!("webgl2"in s)||a)&&(!("extension"in s)||this.gl.getExtension(s.extension))){const n=r?Y(this.gl,t):t;i[n]=this.getParameter(t,e),r&&"GLenum"===s.type&&(i[n]=Y(this.gl,i[n]))}}return i}setParameter(e,t){k(e=K(this.gl,e));const r=(this.constructor.PARAMETERS||{})[e];if(r){const e=Object(y.e)(this.gl);if(!((!("webgl2"in r)||e)&&(!("extension"in r)||this.gl.getExtension(r.extension))))throw new Error("Parameter not available on this platform");"GLenum"===r.type&&(t=K(t))}return this._setParameter(e,t),this}setParameters(e){for(const t in e)this.setParameter(t,e[t]);return this}stubRemovedMethods(e,t,r){return q(this,e,t,r)}initialize(e){}_createHandle(){throw new Error(J)}_deleteHandle(){throw new Error(J)}_bindHandle(e){throw new Error(J)}_getOptsFromHandle(){throw new Error(J)}_getParameter(e,t){throw new Error(J)}_setParameter(e,t){throw new Error(J)}_context(){return this.gl.luma=this.gl.luma||{},this.gl.luma}_addStats(){const e=this.constructor.name,t=V.get("Resource Counts");t.get("Resources Created").incrementCount(),t.get(e+"s Created").incrementCount(),t.get(e+"s Active").incrementCount()}_removeStats(){const e=this.constructor.name;V.get("Resource Counts").get(e+"s Active").decrementCount()}_trackAllocatedMemory(e,t=this.constructor.name){const r=V.get("Memory Usage");r.get("GPU Memory").addCount(e),r.get(t+" Memory").addCount(e),this.byteLength=e}_trackDeallocatedMemory(e=this.constructor.name){const t=V.get("Memory Usage");t.get("GPU Memory").subtractCount(this.byteLength),t.get(e+" Memory").subtractCount(this.byteLength),this.byteLength=0}}function te(e){switch(ArrayBuffer.isView(e)?e.constructor:e){case Float32Array:return D.a.FLOAT;case Uint16Array:return D.a.UNSIGNED_SHORT;case Uint32Array:return D.a.UNSIGNED_INT;case Uint8Array:case Uint8ClampedArray:return D.a.UNSIGNED_BYTE;case Int8Array:return D.a.BYTE;case Int16Array:return D.a.SHORT;case Int32Array:return D.a.INT;default:throw new Error("Failed to deduce GL constant from typed array")}}function re(e,{clamped:t=!0}={}){switch(e){case D.a.FLOAT:return Float32Array;case D.a.UNSIGNED_SHORT:case D.a.UNSIGNED_SHORT_5_6_5:case D.a.UNSIGNED_SHORT_4_4_4_4:case D.a.UNSIGNED_SHORT_5_5_5_1:return Uint16Array;case D.a.UNSIGNED_INT:return Uint32Array;case D.a.UNSIGNED_BYTE:return t?Uint8ClampedArray:Uint8Array;case D.a.BYTE:return Int8Array;case D.a.SHORT:return Int16Array;case D.a.INT:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function ne({data:e,width:t,height:r}){const n=Math.round(t/2),a=Math.round(r/2),i=new Uint8Array(n*a*4);for(let r=0;r<a;r++)for(let a=0;a<n;a++)for(let s=0;s<4;s++)i[4*(r*n+a)+s]=e[4*(2*r*t+2*a)+s];return{data:i,width:n,height:a}}function ae(e,t,r){const{removedProps:n={},deprecatedProps:a={},replacedProps:i={}}=r;for(const r in n)if(r in t){const t=n[r]?`${e}.${n[r]}`:"N/A";U.removed(`${e}.${r}`,t)()}for(const r in a)if(r in t){const t=a[r];U.deprecated(`${e}.${r}`,`${e}.${t}`)()}let s=null;for(const r in i)if(r in t){const n=i[r];U.deprecated(`${e}.${r}`,`${e}.${n}`)(),s=s||Object.assign({},t),s[n]=t[r],delete s[r]}return s||t}const ie={offset:0,stride:0,type:D.a.FLOAT,size:1,divisor:0,normalized:!1,integer:!1},se={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}};class oe{static getBytesPerElement(e){return re(e.type||D.a.FLOAT).BYTES_PER_ELEMENT}static getBytesPerVertex(e){k(e.size);return re(e.type||D.a.FLOAT).BYTES_PER_ELEMENT*e.size}static resolve(...e){return new oe(...[ie,...e])}constructor(...e){e.forEach(e=>this._assign(e)),Object.freeze(this)}toString(){return JSON.stringify(this)}get BYTES_PER_ELEMENT(){return oe.getBytesPerElement(this)}get BYTES_PER_VERTEX(){return oe.getBytesPerVertex(this)}_assign(e={}){return void 0!==(e=ae("Accessor",e,se)).type&&(this.type=e.type,e.type!==D.a.INT&&e.type!==D.a.UNSIGNED_INT||(this.integer=!0)),void 0!==e.size&&(this.size=e.size),void 0!==e.offset&&(this.offset=e.offset),void 0!==e.stride&&(this.stride=e.stride),void 0!==e.normalized&&(this.normalized=e.normalized),void 0!==e.integer&&(this.integer=e.integer),void 0!==e.divisor&&(this.divisor=e.divisor),void 0!==e.buffer&&(this.buffer=e.buffer),void 0!==e.index&&("boolean"==typeof e.index?this.index=e.index?1:0:this.index=e.index),void 0!==e.instanced&&(this.divisor=e.instanced?1:0),void 0!==e.isInstanced&&(this.divisor=e.isInstanced?1:0),this}}const Ee={offset:"accessor.offset",stride:"accessor.stride",type:"accessor.type",size:"accessor.size",divisor:"accessor.divisor",normalized:"accessor.normalized",integer:"accessor.integer",instanced:"accessor.divisor",isInstanced:"accessor.divisor"},ue={removedProps:{},replacedProps:{bytes:"byteLength"},deprecatedProps:Ee},_e={removedProps:Ee};class ce extends ee{constructor(e,t={}){super(e,t),this.stubRemovedMethods("Buffer","v6.0",["layout","setLayout","getIndexedParameter"]),this.target=t.target||(this.gl.webgl2?D.a.COPY_READ_BUFFER:D.a.ARRAY_BUFFER),this.initialize(t),Object.seal(this)}getElementCount(e=this.accessor){return Math.round(this.byteLength/oe.getBytesPerElement(e))}getVertexCount(e=this.accessor){return Math.round(this.byteLength/oe.getBytesPerVertex(e))}initialize(e={}){return ArrayBuffer.isView(e)&&(e={data:e}),Number.isFinite(e)&&(e={byteLength:e}),e=ae("Buffer",e,ue),this.usage=e.usage||D.a.STATIC_DRAW,this.debugData=null,this.setAccessor(Object.assign({},e,e.accessor)),e.data?this._setData(e.data,e.offset,e.byteLength):this._setByteLength(e.byteLength||0),this}setProps(e){return"accessor"in(e=ae("Buffer",e,_e))&&this.setAccessor(e.accessor),this}setAccessor(e){return delete(e=Object.assign({},e)).buffer,this.accessor=new oe(e),this}reallocate(e){return e>this.byteLength?(this._setByteLength(e),!0):(this.bytesUsed=e,!1)}setData(e){return this.initialize(e)}subData(e){ArrayBuffer.isView(e)&&(e={data:e});const{data:t,offset:r=0,srcOffset:n=0}=e,a=e.byteLength||e.length;k(t);const i=this.gl.webgl2?D.a.COPY_WRITE_BUFFER:this.target;return this.gl.bindBuffer(i,this.handle),0!==n||void 0!==a?(Object(y.a)(this.gl),this.gl.bufferSubData(this.target,r,t,n,a)):this.gl.bufferSubData(i,r,t),this.gl.bindBuffer(i,null),this.debugData=null,this._inferType(t),this}copyData({sourceBuffer:e,readOffset:t=0,writeOffset:r=0,size:n}){const{gl:a}=this;return Object(y.a)(a),a.bindBuffer(D.a.COPY_READ_BUFFER,e.handle),a.bindBuffer(D.a.COPY_WRITE_BUFFER,this.handle),a.copyBufferSubData(D.a.COPY_READ_BUFFER,D.a.COPY_WRITE_BUFFER,t,r,n),a.bindBuffer(D.a.COPY_READ_BUFFER,null),a.bindBuffer(D.a.COPY_WRITE_BUFFER,null),this.debugData=null,this}getData({dstData:e=null,srcByteOffset:t=0,dstOffset:r=0,length:n=0}={}){Object(y.a)(this.gl);const a=re(this.accessor.type||D.a.FLOAT,{clamped:!1}),i=this._getAvailableElementCount(t),s=r;let o,E;e?(E=e.length,o=E-s):(o=Math.min(i,n||i),E=s+o);const u=Math.min(i,o);return k((n=n||u)<=u),e=e||new a(E),this.gl.bindBuffer(D.a.COPY_READ_BUFFER,this.handle),this.gl.getBufferSubData(D.a.COPY_READ_BUFFER,t,e,r,n),this.gl.bindBuffer(D.a.COPY_READ_BUFFER,null),e}bind({target:e=this.target,index:t=this.accessor&&this.accessor.index,offset:r=0,size:n}={}){return e===D.a.UNIFORM_BUFFER||e===D.a.TRANSFORM_FEEDBACK_BUFFER?void 0!==n?this.gl.bindBufferRange(e,t,this.handle,r,n):(k(0===r),this.gl.bindBufferBase(e,t,this.handle)):this.gl.bindBuffer(e,this.handle),this}unbind({target:e=this.target,index:t=this.accessor&&this.accessor.index}={}){return e===D.a.UNIFORM_BUFFER||e===D.a.TRANSFORM_FEEDBACK_BUFFER?this.gl.bindBufferBase(e,t,null):this.gl.bindBuffer(e,null),this}getDebugData(){return this.debugData?{data:this.debugData,changed:!1}:(this.debugData=this.getData({length:Math.min(10,this.byteLength)}),{data:this.debugData,changed:!0})}invalidateDebugData(){this.debugData=null}_setData(e,t=0,r=e.byteLength+t){k(ArrayBuffer.isView(e)),this._trackDeallocatedMemory();const n=this._getTarget();this.gl.bindBuffer(n,this.handle),this.gl.bufferData(n,r,this.usage),this.gl.bufferSubData(n,t,e),this.gl.bindBuffer(n,null),this.debugData=e.slice(0,10),this.bytesUsed=r,this._trackAllocatedMemory(r);const a=te(e);return k(a),this.setAccessor(new oe(this.accessor,{type:a})),this}_setByteLength(e,t=this.usage){k(e>=0),this._trackDeallocatedMemory();let r=e;0===e&&(r=new Float32Array(0));const n=this._getTarget();return this.gl.bindBuffer(n,this.handle),this.gl.bufferData(n,r,t),this.gl.bindBuffer(n,null),this.usage=t,this.debugData=null,this.bytesUsed=e,this._trackAllocatedMemory(e),this}_getTarget(){return this.gl.webgl2?D.a.COPY_WRITE_BUFFER:this.target}_getAvailableElementCount(e){const t=e/re(this.accessor.type||D.a.FLOAT,{clamped:!1}).BYTES_PER_ELEMENT;return this.getElementCount()-t}_inferType(e){this.accessor.type||this.setAccessor(new oe(this.accessor,{type:te(e)}))}_createHandle(){return this.gl.createBuffer()}_deleteHandle(){this.gl.deleteBuffer(this.handle),this._trackDeallocatedMemory()}_getParameter(e){this.gl.bindBuffer(this.target,this.handle);const t=this.gl.getBufferParameter(this.target,e);return this.gl.bindBuffer(this.target,null),t}get type(){return U.deprecated("Buffer.type","Buffer.accessor.type")(),this.accessor.type}get bytes(){return U.deprecated("Buffer.bytes","Buffer.byteLength")(),this.byteLength}setByteLength(e){return U.deprecated("setByteLength","reallocate")(),this.reallocate(e)}updateAccessor(e){return U.deprecated("updateAccessor(...)","setAccessor(new Accessor(buffer.accessor, ...)")(),this.accessor=new oe(this.accessor,e),this}}const le={[D.a.RGB]:{dataFormat:D.a.RGB,types:[D.a.UNSIGNED_BYTE,D.a.UNSIGNED_SHORT_5_6_5]},[D.a.RGBA]:{dataFormat:D.a.RGBA,types:[D.a.UNSIGNED_BYTE,D.a.UNSIGNED_SHORT_4_4_4_4,D.a.UNSIGNED_SHORT_5_5_5_1]},[D.a.ALPHA]:{dataFormat:D.a.ALPHA,types:[D.a.UNSIGNED_BYTE]},[D.a.LUMINANCE]:{dataFormat:D.a.LUMINANCE,types:[D.a.UNSIGNED_BYTE]},[D.a.LUMINANCE_ALPHA]:{dataFormat:D.a.LUMINANCE_ALPHA,types:[D.a.UNSIGNED_BYTE]},[D.a.R32F]:{dataFormat:D.a.RED,types:[D.a.FLOAT],gl2:!0},[D.a.RG32F]:{dataFormat:D.a.RG,types:[D.a.FLOAT],gl2:!0},[D.a.RGB32F]:{dataFormat:D.a.RGB,types:[D.a.FLOAT],gl2:!0},[D.a.RGBA32F]:{dataFormat:D.a.RGBA,types:[D.a.FLOAT],gl2:!0}},Ae={[D.a.RED]:1,[D.a.RED_INTEGER]:1,[D.a.RG]:2,[D.a.RG_INTEGER]:2,[D.a.RGB]:3,[D.a.RGB_INTEGER]:3,[D.a.RGBA]:4,[D.a.RGBA_INTEGER]:4,[D.a.DEPTH_COMPONENT]:1,[D.a.DEPTH_STENCIL]:1,[D.a.ALPHA]:1,[D.a.LUMINANCE]:1,[D.a.LUMINANCE_ALPHA]:2},fe={[D.a.FLOAT]:4,[D.a.UNSIGNED_INT]:4,[D.a.INT]:4,[D.a.UNSIGNED_SHORT]:2,[D.a.SHORT]:2,[D.a.HALF_FLOAT]:2,[D.a.BYTE]:1,[D.a.UNSIGNED_BYTE]:1};const he=[D.a.LINEAR,D.a.NEAREST],Te=v.global.WebGLBuffer||function(){};class de extends ee{static isSupported(e,t={}){const{format:r,linearFiltering:n}=t;let a=!0;return r&&(a=a&&function(e,t){const r=le[t];if(!r)return!1;if(void 0===r.gl1&&void 0===r.gl2)return!0;const n=Object(y.e)(e)&&r.gl2||r.gl1;return"string"==typeof n?e.getExtension(n):n}(e,r),a=a&&(!n||function(e,t){const r=le[t];switch(r&&r.types[0]){case D.a.FLOAT:return e.getExtension("OES_texture_float_linear");case D.a.HALF_FLOAT:return e.getExtension("OES_texture_half_float_linear");default:return!0}}(e,r))),a}constructor(e,t){const{id:r=$("texture"),handle:n,target:a}=t;super(e,{id:r,handle:n}),this.target=a,this.textureUnit=void 0,this.loaded=!1,this.width=void 0,this.height=void 0,this.depth=void 0,this.format=void 0,this.type=void 0,this.dataFormat=void 0,this.border=void 0,this.textureUnit=void 0,this.mipmaps=void 0}toString(){return`Texture(${this.id},${this.width}x${this.height})`}initialize(e={}){let t=e.data;if(t instanceof Promise)return t.then(t=>this.initialize(Object.assign({},e,{pixels:t,data:t}))),this;const r="undefined"!=typeof HTMLVideoElement&&t instanceof HTMLVideoElement;if(r&&t.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,t.addEventListener("loadeddata",()=>this.initialize(e)),this;const{pixels:n=null,format:a=D.a.RGBA,border:i=0,recreate:s=!1,parameters:o={},pixelStore:E={},textureUnit:u}=e;t||(t=n);let{width:_,height:c,dataFormat:l,type:A,compressed:f=!1,mipmaps:h=!0}=e;const{depth:T=0}=e;return({width:_,height:c,compressed:f,dataFormat:l,type:A}=this._deduceParameters({format:a,type:A,dataFormat:l,compressed:f,data:t,width:_,height:c})),this.width=_,this.height=c,this.depth=T,this.format=a,this.type=A,this.dataFormat=l,this.border=i,this.textureUnit=u,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(D.a.TEXTURE0+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),h&&this._isNPOT()&&(U.warn(`texture: ${this} is Non-Power-Of-Two, disabling mipmaping`)(),h=!1,this._updateForNPOT(o)),this.mipmaps=h,this.setImageData({data:t,width:_,height:c,depth:T,format:a,type:A,dataFormat:l,border:i,mipmaps:h,parameters:E,compressed:f}),h&&this.generateMipmap(),this.setParameters(o),s&&(this.data=t),r&&(this._video={video:t,parameters:o,lastTime:t.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?t.currentTime:-1}),this}update(){if(this._video){const{video:e,parameters:t,lastTime:r}=this._video;if(r===e.currentTime||e.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:e,parameters:t}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=e.currentTime}}resize({height:e,width:t,mipmaps:r=!1}){return t!==this.width||e!==this.height?this.initialize({width:t,height:e,format:this.format,type:this.type,dataFormat:this.dataFormat,border:this.border,mipmaps:r}):this}generateMipmap(e={}){return this._isNPOT()?(U.warn(`texture: ${this} is Non-Power-Of-Two, disabling mipmaping`)(),this):(this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),Object(P.c)(this.gl,e,()=>{this.gl.generateMipmap(this.target)}),this.gl.bindTexture(this.target,null),this)}setImageData(e){this._trackDeallocatedMemory("Texture");const{target:t=this.target,pixels:r=null,level:n=0,format:a=this.format,border:i=this.border,offset:s=0,parameters:o={}}=e;let{data:E=null,type:u=this.type,width:_=this.width,height:c=this.height,dataFormat:l=this.dataFormat,compressed:A=!1}=e;E||(E=r),({type:u,dataFormat:l,compressed:A,width:_,height:c}=this._deduceParameters({format:a,type:u,dataFormat:l,compressed:A,data:E,width:_,height:c}));const{gl:f}=this;f.bindTexture(this.target,this.handle);let h,T=null;if(({data:E,dataType:T}=this._getDataType({data:E,compressed:A})),Object(P.c)(this.gl,o,()=>{switch(T){case"null":f.texImage2D(t,n,a,_,c,i,l,u,E);break;case"typed-array":f.texImage2D(t,n,a,_,c,i,l,u,E,s);break;case"buffer":h=Object(y.a)(f),h.bindBuffer(D.a.PIXEL_UNPACK_BUFFER,E.handle||E),h.texImage2D(t,n,a,_,c,i,l,u,s),h.bindBuffer(D.a.PIXEL_UNPACK_BUFFER,null);break;case"browser-object":Object(y.e)(f)?f.texImage2D(t,n,a,_,c,i,l,u,E):f.texImage2D(t,n,a,l,u,E);break;case"compressed":for(const[e,r]of E.entries())f.compressedTexImage2D(t,e,r.format,r.width,r.height,i,r.data);break;default:k(!1,"Unknown image data type")}}),E&&E.byteLength)this._trackAllocatedMemory(E.byteLength,"Texture");else{const e=Ae[this.dataFormat]||4,t=fe[this.type]||1;this._trackAllocatedMemory(this.width*this.height*e*t,"Texture")}return this.loaded=!0,this}setSubImageData({target:e=this.target,pixels:t=null,data:r=null,x:n=0,y:a=0,width:i=this.width,height:s=this.height,level:o=0,format:E=this.format,type:u=this.type,dataFormat:_=this.dataFormat,compressed:c=!1,offset:l=0,border:A=this.border,parameters:f={}}){if(({type:u,dataFormat:_,compressed:c,width:i,height:s}=this._deduceParameters({format:E,type:u,dataFormat:_,compressed:c,data:r,width:i,height:s})),k(0===this.depth,"texSubImage not supported for 3D textures"),r||(r=t),r&&r.data){const e=r;r=e.data,i=e.shape[0],s=e.shape[1]}r instanceof ce&&(r=r.handle),this.gl.bindTexture(this.target,this.handle),Object(P.c)(this.gl,f,()=>{if(c)this.gl.compressedTexSubImage2D(e,o,n,a,i,s,E,r);else if(null===r)this.gl.texSubImage2D(e,o,n,a,i,s,_,u,null);else if(ArrayBuffer.isView(r))this.gl.texSubImage2D(e,o,n,a,i,s,_,u,r,l);else if(r instanceof Te){const t=Object(y.a)(this.gl);t.bindBuffer(D.a.PIXEL_UNPACK_BUFFER,r),t.texSubImage2D(e,o,n,a,i,s,_,u,l),t.bindBuffer(D.a.PIXEL_UNPACK_BUFFER,null)}else if(Object(y.e)(this.gl)){Object(y.a)(this.gl).texSubImage2D(e,o,n,a,i,s,_,u,r)}else this.gl.texSubImage2D(e,o,n,a,_,u,r)}),this.gl.bindTexture(this.target,null)}copyFramebuffer(e={}){return U.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}getActiveUnit(){return this.gl.getParameter(D.a.ACTIVE_TEXTURE)-D.a.TEXTURE0}bind(e=this.textureUnit){const{gl:t}=this;return void 0!==e&&(this.textureUnit=e,t.activeTexture(t.TEXTURE0+e)),t.bindTexture(this.target,this.handle),e}unbind(e=this.textureUnit){const{gl:t}=this;return void 0!==e&&(this.textureUnit=e,t.activeTexture(t.TEXTURE0+e)),t.bindTexture(this.target,null),e}_getDataType({data:e,compressed:t=!1}){return t?{data:e,dataType:"compressed"}:null===e?{data:e,dataType:"null"}:ArrayBuffer.isView(e)?{data:e,dataType:"typed-array"}:e instanceof ce?{data:e.handle,dataType:"buffer"}:e instanceof Te?{data:e,dataType:"buffer"}:{data:e,dataType:"browser-object"}}_deduceParameters(e){const{format:t,data:r}=e;let{width:n,height:a,dataFormat:i,type:s,compressed:o}=e;const E=le[t];return i=i||E&&E.dataFormat,s=s||E&&E.types[0],o=o||E&&E.compressed,({width:n,height:a}=this._deduceImageSize(r,n,a)),{dataFormat:i,type:s,compressed:o,width:n,height:a,format:t,data:r}}_deduceImageSize(e,t,r){let n;return n="undefined"!=typeof ImageData&&e instanceof ImageData?{width:e.width,height:e.height}:"undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement?{width:e.naturalWidth,height:e.naturalHeight}:"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap?{width:e.width,height:e.height}:"undefined"!=typeof HTMLVideoElement&&e instanceof HTMLVideoElement?{width:e.videoWidth,height:e.videoHeight}:e?{width:t,height:r}:{width:t>=0?t:1,height:r>=0?r:1},k(n,"Could not deduced texture size"),k(void 0===t||n.width===t,"Deduced texture width does not match supplied width"),k(void 0===r||n.height===r,"Deduced texture height does not match supplied height"),n}_createHandle(){return this.gl.createTexture()}_deleteHandle(){this.gl.deleteTexture(this.handle),this._trackDeallocatedMemory("Texture")}_getParameter(e){switch(e){case D.a.TEXTURE_WIDTH:return this.width;case D.a.TEXTURE_HEIGHT:return this.height;default:this.gl.bindTexture(this.target,this.handle);const t=this.gl.getTexParameter(this.target,e);return this.gl.bindTexture(this.target,null),t}}_setParameter(e,t){switch(this.gl.bindTexture(this.target,this.handle),t=this._getNPOTParam(e,t),e){case D.a.TEXTURE_MIN_LOD:case D.a.TEXTURE_MAX_LOD:this.gl.texParameterf(this.handle,e,t);break;case D.a.TEXTURE_WIDTH:case D.a.TEXTURE_HEIGHT:k(!1);break;default:this.gl.texParameteri(this.target,e,t)}return this.gl.bindTexture(this.target,null),this}_isNPOT(){return!Object(y.e)(this.gl)&&(!(!this.width||!this.height)&&(!Z(this.width)||!Z(this.height)))}_updateForNPOT(e){void 0===e[this.gl.TEXTURE_MIN_FILTER]&&(e[this.gl.TEXTURE_MIN_FILTER]=this.gl.LINEAR),void 0===e[this.gl.TEXTURE_WRAP_S]&&(e[this.gl.TEXTURE_WRAP_S]=this.gl.CLAMP_TO_EDGE),void 0===e[this.gl.TEXTURE_WRAP_T]&&(e[this.gl.TEXTURE_WRAP_T]=this.gl.CLAMP_TO_EDGE)}_getNPOTParam(e,t){if(this._isNPOT())switch(e){case D.a.TEXTURE_MIN_FILTER:-1===he.indexOf(t)&&(t=D.a.LINEAR);break;case D.a.TEXTURE_WRAP_S:case D.a.TEXTURE_WRAP_T:t!==D.a.CLAMP_TO_EDGE&&(t=D.a.CLAMP_TO_EDGE)}return t}}let Re="";function ge(e){Re=e}function Ne(e,t={}){k("string"==typeof e),e=Re+e;const r=t.dataType||"text";return fetch(e,t).then(e=>e[r]())}function me(e,t){return k("string"==typeof e),e=Re+e,new Promise((r,n)=>{try{const a=new Image;a.onload=()=>r(a),a.onerror=()=>n(new Error(`Could not load image ${e}.`)),a.crossOrigin=t&&t.crossOrigin||"anonymous",a.src=e}catch(e){n(e)}})}class Fe extends de{static isSupported(e,t){return de.isSupported(e,t)}constructor(e,t={}){Object(y.b)(e),(t instanceof Promise||"string"==typeof t)&&(t={data:t}),"string"==typeof t.data&&(t=Object.assign({},t,{data:me(t.data)})),super(e,Object.assign({},t,{target:D.a.TEXTURE_2D})),this.initialize(t),Object.seal(this)}}const Oe=[D.a.TEXTURE_CUBE_MAP_POSITIVE_X,D.a.TEXTURE_CUBE_MAP_NEGATIVE_X,D.a.TEXTURE_CUBE_MAP_POSITIVE_Y,D.a.TEXTURE_CUBE_MAP_NEGATIVE_Y,D.a.TEXTURE_CUBE_MAP_POSITIVE_Z,D.a.TEXTURE_CUBE_MAP_NEGATIVE_Z];class be extends de{constructor(e,t={}){Object(y.b)(e),super(e,Object.assign({},t,{target:D.a.TEXTURE_CUBE_MAP})),this.initialize(t),Object.seal(this)}initialize(e={}){const{mipmaps:t=!0,parameters:r={}}=e;return this.opts=e,this.setCubeMapImageData(e).then(()=>{this.loaded=!0,t&&this.generateMipmap(e),this.setParameters(r)}),this}subImage({face:e,data:t,x:r=0,y:n=0,mipmapLevel:a=0}){return this._subImage({target:e,data:t,x:r,y:n,mipmapLevel:a})}async setCubeMapImageData({width:e,height:t,pixels:r,data:n,border:a=0,format:i=D.a.RGBA,type:s=D.a.UNSIGNED_BYTE}){const{gl:o}=this,E=r||n,u=await Promise.all(Oe.map(e=>{const t=E[e];return Promise.all(Array.isArray(t)?t:[t])}));this.bind(),Oe.forEach((r,n)=>{u[n].length>1&&!1!==this.opts.mipmaps&&U.warn(this.id+" has mipmap and multiple LODs.")(),u[n].forEach((n,E)=>{e&&t?o.texImage2D(r,E,i,e,t,a,i,s,n):o.texImage2D(r,E,i,i,s,n)})}),this.unbind()}setImageDataForFace(e){const{face:t,width:r,height:n,pixels:a,data:i,border:s=0,format:o=D.a.RGBA,type:E=D.a.UNSIGNED_BYTE}=e,{gl:u}=this,_=a||i;return this.bind(),_ instanceof Promise?_.then(r=>this.setImageDataForFace(Object.assign({},e,{face:t,data:r,pixels:r}))):this.width||this.height?u.texImage2D(t,0,o,r,n,s,o,E,_):u.texImage2D(t,0,o,o,E,_),this}}be.FACES=Oe;class Se extends de{static isSupported(e){return Object(y.e)(e)}constructor(e,t={}){Object(y.a)(e),super(e,t=Object.assign({depth:1},t,{target:D.a.TEXTURE_3D,unpackFlipY:!1})),this.initialize(t),Object.seal(this)}setImageData({level:e=0,dataFormat:t=D.a.RGBA,width:r,height:n,depth:a=1,border:i=0,format:s,type:o=D.a.UNSIGNED_BYTE,offset:E=0,data:u,parameters:_={}}){if(this._trackDeallocatedMemory("Texture"),this.gl.bindTexture(this.target,this.handle),Object(P.c)(this.gl,_,()=>{ArrayBuffer.isView(u)&&this.gl.texImage3D(this.target,e,t,r,n,a,i,s,o,u),u instanceof ce&&(this.gl.bindBuffer(D.a.PIXEL_UNPACK_BUFFER,u.handle),this.gl.texImage3D(this.target,e,t,r,n,a,i,s,o,E))}),u&&u.byteLength)this._trackAllocatedMemory(u.byteLength,"Texture");else{const e=Ae[this.dataFormat]||4,t=fe[this.type]||1;this._trackAllocatedMemory(this.width*this.height*this.depth*e*t,"Texture")}return this.loaded=!0,this}}const Ie="EXT_color_buffer_float";var Le={[D.a.DEPTH_COMPONENT16]:{bpp:2},[D.a.DEPTH_COMPONENT24]:{gl2:!0,bpp:3},[D.a.DEPTH_COMPONENT32F]:{gl2:!0,bpp:4},[D.a.STENCIL_INDEX8]:{bpp:1},[D.a.DEPTH_STENCIL]:{bpp:4},[D.a.DEPTH24_STENCIL8]:{gl2:!0,bpp:4},[D.a.DEPTH32F_STENCIL8]:{gl2:!0,bpp:5},[D.a.RGBA4]:{bpp:2},[D.a.RGB565]:{bpp:2},[D.a.RGB5_A1]:{bpp:2},[D.a.R8]:{gl2:!0,bpp:1},[D.a.R8UI]:{gl2:!0,bpp:1},[D.a.R8I]:{gl2:!0,bpp:1},[D.a.R16UI]:{gl2:!0,bpp:2},[D.a.R16I]:{gl2:!0,bpp:2},[D.a.R32UI]:{gl2:!0,bpp:4},[D.a.R32I]:{gl2:!0,bpp:4},[D.a.RG8]:{gl2:!0,bpp:2},[D.a.RG8UI]:{gl2:!0,bpp:2},[D.a.RG8I]:{gl2:!0,bpp:2},[D.a.RG16UI]:{gl2:!0,bpp:4},[D.a.RG16I]:{gl2:!0,bpp:4},[D.a.RG32UI]:{gl2:!0,bpp:8},[D.a.RG32I]:{gl2:!0,bpp:8},[D.a.RGB8]:{gl2:!0,bpp:3},[D.a.RGBA8]:{gl2:!0,bpp:4},[D.a.RGB10_A2]:{gl2:!0,bpp:4},[D.a.RGBA8UI]:{gl2:!0,bpp:4},[D.a.RGBA8I]:{gl2:!0,bpp:4},[D.a.RGB10_A2UI]:{gl2:!0,bpp:4},[D.a.RGBA16UI]:{gl2:!0,bpp:8},[D.a.RGBA16I]:{gl2:!0,bpp:8},[D.a.RGBA32I]:{gl2:!0,bpp:16},[D.a.RGBA32UI]:{gl2:!0,bpp:16},[D.a.R16F]:{gl2:Ie,bpp:2},[D.a.RG16F]:{gl2:Ie,bpp:4},[D.a.RGBA16F]:{gl2:Ie,bpp:8},[D.a.R32F]:{gl2:Ie,bpp:4},[D.a.RG32F]:{gl2:Ie,bpp:8},[D.a.RGBA32F]:{gl2:Ie,bpp:16},[D.a.R11F_G11F_B10F]:{gl2:Ie,bpp:4}};class Be extends ee{static isSupported(e,{format:t}={format:null}){return!t||function(e,t,r){const n=r[t];if(!n)return!1;const a=Object(y.e)(e)&&n.gl2||n.gl1;return"string"==typeof a?e.getExtension(a):a}(e,t,Le)}static getSamplesForFormat(e,{format:t}){return e.getInternalformatParameter(D.a.RENDERBUFFER,t,D.a.SAMPLES)}constructor(e,t={}){super(e,t),this.initialize(t),Object.seal(this)}initialize({format:e,width:t=1,height:r=1,samples:n=0}){return k(e,"Needs format"),this._trackDeallocatedMemory(),this.gl.bindRenderbuffer(D.a.RENDERBUFFER,this.handle),0!==n&&Object(y.e)(this.gl)?this.gl.renderbufferStorageMultisample(D.a.RENDERBUFFER,n,e,t,r):this.gl.renderbufferStorage(D.a.RENDERBUFFER,e,t,r),this.format=e,this.width=t,this.height=r,this.samples=n,this._trackAllocatedMemory(this.width*this.height*(this.samples||1)*Le[this.format].bpp),this}resize({width:e,height:t}){return e!==this.width||t!==this.height?this.initialize({width:e,height:t,format:this.format,samples:this.samples}):this}_createHandle(){return this.gl.createRenderbuffer()}_deleteHandle(){this.gl.deleteRenderbuffer(this.handle),this._trackDeallocatedMemory()}_bindHandle(e){this.gl.bindRenderbuffer(D.a.RENDERBUFFER,e)}_syncHandle(e){this.format=this.getParameter(D.a.RENDERBUFFER_INTERNAL_FORMAT),this.width=this.getParameter(D.a.RENDERBUFFER_WIDTH),this.height=this.getParameter(D.a.RENDERBUFFER_HEIGHT),this.samples=this.getParameter(D.a.RENDERBUFFER_SAMPLES)}_getParameter(e){this.gl.bindRenderbuffer(D.a.RENDERBUFFER,this.handle);return this.gl.getRenderbufferParameter(D.a.RENDERBUFFER,e)}}function Ce(e,{framebuffer:t=null,color:r=null,depth:n=null,stencil:a=null}={}){const i={};t&&(i.framebuffer=t);let s=0;r&&(s|=16384,!0!==r&&(i.clearColor=r)),n&&(s|=256,!0!==n&&(i.clearDepth=n)),a&&(s|=1024,!0!==n&&(i.clearStencil=n)),k(0!==s,"clear: bad arguments"),Object(P.c)(e,i,()=>{e.clear(s)})}function Me(e,{framebuffer:t=null,buffer:r=6144,drawBuffer:n=0,value:a=[0,0,0,0]}={}){Object(y.a)(e),Object(P.c)(e,{framebuffer:t},()=>{switch(r){case 6144:switch(a.constructor){case Int32Array:e.clearBufferiv(r,n,a);break;case Uint32Array:e.clearBufferuiv(r,n,a);break;case Float32Array:default:e.clearBufferfv(r,n,a)}break;case 6145:e.clearBufferfv(6145,0,[a]);break;case 6146:e.clearBufferiv(6146,0,[a]);break;case 34041:const[t,i]=a;e.clearBufferfi(34041,0,t,i);break;default:k(!1,"clear: bad arguments")}})}function pe(e){switch(e){case D.a.ALPHA:case D.a.R32F:case D.a.RED:return 1;case D.a.RG32F:case D.a.RG:return 2;case D.a.RGB:case D.a.RGB32F:return 3;case D.a.RGBA:case D.a.RGBA32F:return 4;default:return k(!1),0}}function Ue(e,t={}){const{sourceX:r=0,sourceY:n=0,sourceFormat:a=D.a.RGBA}=t;let{sourceAttachment:i=D.a.COLOR_ATTACHMENT0,target:s=null,sourceWidth:o,sourceHeight:E,sourceType:u}=t;const{framebuffer:_,deleteFramebuffer:c}=xe(e);k(_);const{gl:l,handle:A,attachments:f}=_;o=o||_.width,E=E||_.height,i===D.a.COLOR_ATTACHMENT0&&null===A&&(i=D.a.FRONT),k(f[i]),u=u||f[i].type,s=function(e,t,r,n,a){if(e)return e;const i=re(t=t||D.a.UNSIGNED_BYTE,{clamped:!1}),s=pe(r);return new i(n*a*s)}(s,u,a,o,E),u=u||te(s);const h=l.bindFramebuffer(D.a.FRAMEBUFFER,A);return l.readPixels(r,n,o,E,a,u,s),l.bindFramebuffer(D.a.FRAMEBUFFER,h||null),c&&_.delete(),s}function ye(e,{sourceX:t=0,sourceY:r=0,sourceFormat:n=D.a.RGBA,target:a=null,targetByteOffset:i=0,sourceWidth:s,sourceHeight:o,sourceType:E}){const{framebuffer:u,deleteFramebuffer:_}=xe(e);k(u),s=s||u.width,o=o||u.height;const c=Object(y.a)(u.gl);if(E=E||(a?a.type:D.a.UNSIGNED_BYTE),!a){const e=pe(n),t=function(e){switch(e){case D.a.UNSIGNED_BYTE:return 1;case D.a.UNSIGNED_SHORT_5_6_5:case D.a.UNSIGNED_SHORT_4_4_4_4:case D.a.UNSIGNED_SHORT_5_5_5_1:return 2;case D.a.FLOAT:return 4;default:return k(!1),0}}(E);a=new ce(c,{byteLength:i+s*o*e*t,accessor:{type:E,size:e}})}return a.bind({target:D.a.PIXEL_PACK_BUFFER}),Object(P.c)(c,{framebuffer:u},()=>{c.readPixels(t,r,s,o,n,E,i)}),a.unbind({target:D.a.PIXEL_PACK_BUFFER}),_&&u.delete(),a}function Pe(e,{sourceAttachment:t=D.a.COLOR_ATTACHMENT0,targetMaxHeight:r=Number.MAX_SAFE_INTEGER}={}){let n=Ue(e,{sourceAttachment:t}),{width:a,height:i}=e;for(;i>r;)({data:n,width:a,height:i}=ne({data:n,width:a,height:i}));!function({data:e,width:t,height:r,bytesPerPixel:n=4,temp:a}){const i=t*n;a=a||new Uint8Array(i);for(let t=0;t<r/2;++t){const n=t*i,s=(r-t-1)*i;a.set(e.subarray(n,n+i)),e.copyWithin(n,s,s+i),e.set(a,s)}}({data:n,width:a,height:i});const s=document.createElement("canvas");s.width=a,s.height=i;const o=s.getContext("2d"),E=o.createImageData(a,i);return E.data.set(n),o.putImageData(E,0,0),s.toDataURL()}function De(e,{sourceAttachment:t=D.a.COLOR_ATTACHMENT0,targetImage:r=null}={}){const n=Pe(e,{sourceAttachment:t});return(r=r||new Image).src=n,r}function ve(e,t,r={}){const{sourceX:n=0,sourceY:a=0,targetMipmaplevel:i=0,targetInternalFormat:s=D.a.RGBA}=r;let{targetX:o,targetY:E,targetZ:u,width:_,height:c}=r;const{framebuffer:l,deleteFramebuffer:A}=xe(e);k(l);const{gl:f,handle:h}=l,T=void 0!==o||void 0!==E||void 0!==u;o=o||0,E=E||0,u=u||0;const d=f.bindFramebuffer(D.a.FRAMEBUFFER,h);k(t);let R=null;if(t instanceof de&&(R=t,_=Number.isFinite(_)?_:R.width,c=Number.isFinite(c)?c:R.height,R.bind(0),t=R.target),T)switch(t){case D.a.TEXTURE_2D:case D.a.TEXTURE_CUBE_MAP:f.copyTexSubImage2D(t,i,o,E,n,a,_,c);break;case D.a.TEXTURE_2D_ARRAY:case D.a.TEXTURE_3D:Object(y.a)(f).copyTexSubImage3D(t,i,o,E,u,n,a,_,c)}else f.copyTexImage2D(t,i,s,n,a,_,c,0);return R&&R.unbind(),f.bindFramebuffer(D.a.FRAMEBUFFER,d||null),A&&l.delete(),R}function Ge(e,t,r={}){const{sourceX0:n=0,sourceY0:a=0,targetX0:i=0,targetY0:s=0,color:o=!0,depth:E=!1,stencil:u=!1,filter:_=D.a.NEAREST}=r;let{sourceX1:c,sourceY1:l,targetX1:A,targetY1:f,sourceAttachment:h=D.a.COLOR_ATTACHMENT0,mask:T=0}=r;const{framebuffer:d,deleteFramebuffer:R}=xe(e),{framebuffer:g,deleteFramebuffer:N}=xe(t);k(d),k(g);const{gl:m,handle:F,width:O,height:b,readBuffer:S}=g,I=Object(y.a)(m);d.handle||h!==D.a.COLOR_ATTACHMENT0||(h=D.a.FRONT),o&&(T|=D.a.COLOR_BUFFER_BIT),E&&(T|=D.a.DEPTH_BUFFER_BIT),u&&(T|=D.a.STENCIL_BUFFER_BIT),(R||N)&&T&(D.a.DEPTH_BUFFER_BIT|D.a.STENCIL_BUFFER_BIT)&&(T=D.a.COLOR_BUFFER_BIT,U.warn("Blitting from or into a Texture object, forcing mask to GL.COLOR_BUFFER_BIT")()),k(T),c=void 0===c?d.width:c,l=void 0===l?d.height:l,A=void 0===A?O:A,f=void 0===f?b:f;const L=m.bindFramebuffer(D.a.DRAW_FRAMEBUFFER,F),B=m.bindFramebuffer(D.a.READ_FRAMEBUFFER,d.handle);return I.readBuffer(h),I.blitFramebuffer(n,a,c,l,i,s,A,f,T,_),I.readBuffer(S),I.bindFramebuffer(D.a.READ_FRAMEBUFFER,B||null),I.bindFramebuffer(D.a.DRAW_FRAMEBUFFER,L||null),R&&d.delete(),N&&g.delete(),g}function xe(e){return e instanceof ke?{framebuffer:e,deleteFramebuffer:!1}:{framebuffer:ze(e),deleteFramebuffer:!0}}const we={WEBGL2:"WEBGL2",VERTEX_ARRAY_OBJECT:"VERTEX_ARRAY_OBJECT",TIMER_QUERY:"TIMER_QUERY",INSTANCED_RENDERING:"INSTANCED_RENDERING",MULTIPLE_RENDER_TARGETS:"MULTIPLE_RENDER_TARGETS",ELEMENT_INDEX_UINT32:"ELEMENT_INDEX_UINT32",BLEND_EQUATION_MINMAX:"BLEND_EQUATION_MINMAX",FLOAT_BLEND:"FLOAT_BLEND",COLOR_ENCODING_SRGB:"COLOR_ENCODING_SRGB",TEXTURE_DEPTH:"TEXTURE_DEPTH",TEXTURE_FLOAT:"TEXTURE_FLOAT",TEXTURE_HALF_FLOAT:"TEXTURE_HALF_FLOAT",TEXTURE_FILTER_LINEAR_FLOAT:"TEXTURE_FILTER_LINEAR_FLOAT",TEXTURE_FILTER_LINEAR_HALF_FLOAT:"TEXTURE_FILTER_LINEAR_HALF_FLOAT",TEXTURE_FILTER_ANISOTROPIC:"TEXTURE_FILTER_ANISOTROPIC",COLOR_ATTACHMENT_RGBA32F:"COLOR_ATTACHMENT_RGBA32F",COLOR_ATTACHMENT_FLOAT:"COLOR_ATTACHMENT_FLOAT",COLOR_ATTACHMENT_HALF_FLOAT:"COLOR_ATTACHMENT_HALF_FLOAT",GLSL_FRAG_DATA:"GLSL_FRAG_DATA",GLSL_FRAG_DEPTH:"GLSL_FRAG_DEPTH",GLSL_DERIVATIVES:"GLSL_DERIVATIVES",GLSL_TEXTURE_LOD:"GLSL_TEXTURE_LOD"};var He={[we.WEBGL2]:[!1,!0],[we.VERTEX_ARRAY_OBJECT]:["OES_vertex_array_object",!0],[we.TIMER_QUERY]:["EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2"],[we.INSTANCED_RENDERING]:["ANGLE_instanced_arrays",!0],[we.MULTIPLE_RENDER_TARGETS]:["WEBGL_draw_buffers",!0],[we.ELEMENT_INDEX_UINT32]:["OES_element_index_uint",!0],[we.BLEND_EQUATION_MINMAX]:["EXT_blend_minmax",!0],[we.FLOAT_BLEND]:["EXT_float_blend"],[we.COLOR_ENCODING_SRGB]:["EXT_sRGB",!0],[we.TEXTURE_DEPTH]:["WEBGL_depth_texture",!0],[we.TEXTURE_FLOAT]:["OES_texture_float",!0],[we.TEXTURE_HALF_FLOAT]:["OES_texture_half_float",!0],[we.TEXTURE_FILTER_LINEAR_FLOAT]:["OES_texture_float_linear"],[we.TEXTURE_FILTER_LINEAR_HALF_FLOAT]:["OES_texture_half_float_linear"],[we.TEXTURE_FILTER_ANISOTROPIC]:["EXT_texture_filter_anisotropic"],[we.COLOR_ATTACHMENT_RGBA32F]:[function(e){const t=new Fe(e,{format:e.RGBA,type:e.FLOAT,dataFormat:e.RGBA}),r=new ke(e,{id:"test-framebuffer",check:!1,attachments:{[e.COLOR_ATTACHMENT0]:t}}),n=r.getStatus();return t.delete(),r.delete(),n===e.FRAMEBUFFER_COMPLETE},"EXT_color_buffer_float"],[we.COLOR_ATTACHMENT_FLOAT]:[!1,"EXT_color_buffer_float"],[we.COLOR_ATTACHMENT_HALF_FLOAT]:["EXT_color_buffer_half_float"],[we.GLSL_FRAG_DATA]:["WEBGL_draw_buffers",!0],[we.GLSL_FRAG_DEPTH]:["EXT_frag_depth",!0],[we.GLSL_DERIVATIVES]:["OES_standard_derivatives",!0],[we.GLSL_TEXTURE_LOD]:["EXT_shader_texture_lod",!0]};function Xe(e,t){return Ve(e,t)}function Ve(e,t){return(t=Array.isArray(t)?t:[t]).every(t=>We(e,t))}function je(e){e.luma=e.luma||{},e.luma.caps=e.luma.caps||{};for(const t in He)void 0===e.luma.caps[t]&&(e.luma.caps[t]=We(e,t));return e.luma.caps}function We(e,t){return e.luma=e.luma||{},e.luma.caps=e.luma.caps||{},void 0===e.luma.caps[t]&&(e.luma.caps[t]=function(e,t){const r=He[t];let n;k(r,t);const a=Object(y.e)(e)&&r[1]||r[0];if("function"==typeof a)n=a(e);else if(Array.isArray(a)){n=!0;for(const t of a)n=n&&Boolean(e.getExtension(t))}else"string"==typeof a?n=Boolean(e.getExtension(a)):"boolean"==typeof a?n=a:k(!1);return n}(e,t)),e.luma.caps[t]||U.log(2,`Feature: ${t} not supported`)(),e.luma.caps[t]}class ke extends ee{static isSupported(e,t={}){const{colorBufferFloat:r,colorBufferHalfFloat:n}=t;let a=!0;return r&&(a=Boolean(e.getExtension("EXT_color_buffer_float")||e.getExtension("WEBGL_color_buffer_float")||e.getExtension("OES_texture_float"))),n&&(a=a&&Boolean(e.getExtension("EXT_color_buffer_float")||e.getExtension("EXT_color_buffer_half_float"))),a}static getDefaultFramebuffer(e){return e.luma=e.luma||{},e.luma.defaultFramebuffer=e.luma.defaultFramebuffer||new ke(e,{id:"default-framebuffer",handle:null,attachments:{}}),e.luma.defaultFramebuffer}get MAX_COLOR_ATTACHMENTS(){const e=Object(y.a)(this.gl);return e.getParameter(e.MAX_COLOR_ATTACHMENTS)}get MAX_DRAW_BUFFERS(){const e=Object(y.a)(this.gl);return e.getParameter(e.MAX_DRAW_BUFFERS)}constructor(e,t={}){super(e,t),this.width=null,this.height=null,this.attachments={},this.readBuffer=D.a.COLOR_ATTACHMENT0,this.drawBuffers=[D.a.COLOR_ATTACHMENT0],this.ownResources=[],this.initialize(t),Object.seal(this)}get color(){return this.attachments[D.a.COLOR_ATTACHMENT0]||null}get texture(){return this.attachments[D.a.COLOR_ATTACHMENT0]||null}get depth(){return this.attachments[D.a.DEPTH_ATTACHMENT]||this.attachments[D.a.DEPTH_STENCIL_ATTACHMENT]||null}get stencil(){return this.attachments[D.a.STENCIL_ATTACHMENT]||this.attachments[D.a.DEPTH_STENCIL_ATTACHMENT]||null}initialize({width:e=1,height:t=1,attachments:r=null,color:n=!0,depth:a=!0,stencil:i=!1,check:s=!0,readBuffer:o,drawBuffers:E}){if(k(e>=0&&t>=0,"Width and height need to be integers"),this.width=e,this.height=t,r)for(const n in r){const a=r[n];(Array.isArray(a)?a[0]:a).resize({width:e,height:t})}else r=this._createDefaultAttachments(n,a,i,e,t);this.update({clearAttachments:!0,attachments:r,readBuffer:o,drawBuffers:E}),r&&s&&this.checkStatus()}delete(){for(const e of this.ownResources)e.delete();return super.delete(),this}update({attachments:e={},readBuffer:t,drawBuffers:r,clearAttachments:n=!1,resizeAttachments:a=!0}){this.attach(e,{clearAttachments:n,resizeAttachments:a});const{gl:i}=this,s=i.bindFramebuffer(D.a.FRAMEBUFFER,this.handle);return t&&this._setReadBuffer(t),r&&this._setDrawBuffers(r),i.bindFramebuffer(D.a.FRAMEBUFFER,s||null),this}resize(e={}){let{width:t,height:r}=e;if(null===this.handle)return k(void 0===t&&void 0===r),this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;void 0===t&&(t=this.gl.drawingBufferWidth),void 0===r&&(r=this.gl.drawingBufferHeight),t!==this.width&&r!==this.height&&U.log(2,`Resizing framebuffer ${this.id} to ${t}x${r}`)();for(const e in this.attachments)this.attachments[e].resize({width:t,height:r});return this.width=t,this.height=r,this}attach(e,{clearAttachments:t=!1,resizeAttachments:r=!0}={}){const n={};t&&Object.keys(this.attachments).forEach(e=>{n[e]=null}),Object.assign(n,e);const a=this.gl.bindFramebuffer(D.a.FRAMEBUFFER,this.handle);for(const e in n){k(void 0!==e,"Misspelled framebuffer binding point?");const t=Number(e),a=n[t];let i=a;if(i)if(i instanceof Be)this._attachRenderbuffer({attachment:t,renderbuffer:i});else if(Array.isArray(a)){const[e,r=0,n=0]=a;i=e,this._attachTexture({attachment:t,texture:e,layer:r,level:n})}else this._attachTexture({attachment:t,texture:i,layer:0,level:0});else this._unattach(t);r&&i&&i.resize({width:this.width,height:this.height})}this.gl.bindFramebuffer(D.a.FRAMEBUFFER,a||null),Object.assign(this.attachments,e),Object.keys(this.attachments).filter(e=>!this.attachments[e]).forEach(e=>{delete this.attachments[e]})}checkStatus(){const{gl:e}=this,t=this.getStatus();if(t!==e.FRAMEBUFFER_COMPLETE)throw new Error(function(e){return(ke.STATUS||{})[e]||"Framebuffer error "+e}(t));return this}getStatus(){const{gl:e}=this,t=e.bindFramebuffer(D.a.FRAMEBUFFER,this.handle),r=e.checkFramebufferStatus(D.a.FRAMEBUFFER);return e.bindFramebuffer(D.a.FRAMEBUFFER,t||null),r}clear(e={}){const{color:t,depth:r,stencil:n,drawBuffers:a=[]}=e,i=this.gl.bindFramebuffer(D.a.FRAMEBUFFER,this.handle);return(t||r||n)&&Ce(this.gl,{color:t,depth:r,stencil:n}),a.forEach((e,t)=>{Me({drawBuffer:t,value:e})}),this.gl.bindFramebuffer(D.a.FRAMEBUFFER,i||null),this}readPixels(e={}){return U.error("Framebuffer.readPixels() is no logner supported, use readPixelsToArray(framebuffer)")(),null}readPixelsToBuffer(e={}){return U.error("Framebuffer.readPixelsToBuffer()is no logner supported, use readPixelsToBuffer(framebuffer)")(),null}copyToDataUrl(e={}){return U.error("Framebuffer.copyToDataUrl() is no logner supported, use copyToDataUrl(framebuffer)")(),null}copyToImage(e={}){return U.error("Framebuffer.copyToImage() is no logner supported, use copyToImage(framebuffer)")(),null}copyToTexture(e={}){return U.error("Framebuffer.copyToTexture({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}blit(e={}){return U.error("Framebuffer.blit({...}) is no logner supported, use blit(source, target, opts)")(),null}invalidate({attachments:e=[],x:t=0,y:r=0,width:n,height:a}){const i=Object(y.a)(this.gl),s=i.bindFramebuffer(D.a.READ_FRAMEBUFFER,this.handle);return 0===t&&0===r&&void 0===n&&void 0===a?i.invalidateFramebuffer(D.a.READ_FRAMEBUFFER,e):i.invalidateFramebuffer(D.a.READ_FRAMEBUFFER,e,t,r,n,a),i.bindFramebuffer(D.a.READ_FRAMEBUFFER,s),this}getAttachmentParameter(e,t,r){let n=this._getAttachmentParameterFallback(t);return null===n&&(this.gl.bindFramebuffer(D.a.FRAMEBUFFER,this.handle),n=this.gl.getFramebufferAttachmentParameter(D.a.FRAMEBUFFER,e,t),this.gl.bindFramebuffer(D.a.FRAMEBUFFER,null)),r&&n>1e3&&(n=Y(this.gl,n)),n}getAttachmentParameters(e=D.a.COLOR_ATTACHMENT0,t,r=this.constructor.ATTACHMENT_PARAMETERS||[]){const n={};for(const a of r){n[t?Y(this.gl,a):a]=this.getAttachmentParameter(e,a,t)}return n}getParameters(e=!0){const t=Object.keys(this.attachments),r={};for(const n of t){const t=Number(n);r[e?Y(this.gl,t):t]=this.getAttachmentParameters(t,e)}return r}show(){return"undefined"!=typeof window&&window.open(Pe(this),"luma-debug-texture"),this}log(e=0,t=""){if(e>U.level||"undefined"==typeof window)return this;t=t||"Framebuffer "+this.id;const r=Pe(this,{targetMaxHeight:100});return U.image({logLevel:e,message:t,image:r},t)(),this}bind({target:e=D.a.FRAMEBUFFER}={}){return this.gl.bindFramebuffer(e,this.handle),this}unbind({target:e=D.a.FRAMEBUFFER}={}){return this.gl.bindFramebuffer(e,null),this}_createDefaultAttachments(e,t,r,n,a){let i=null;return e&&(i=i||{},i[D.a.COLOR_ATTACHMENT0]=new Fe(this.gl,{id:this.id+"-color0",pixels:null,format:D.a.RGBA,type:D.a.UNSIGNED_BYTE,width:n,height:a,mipmaps:!1,parameters:{[D.a.TEXTURE_MIN_FILTER]:D.a.LINEAR,[D.a.TEXTURE_MAG_FILTER]:D.a.LINEAR,[D.a.TEXTURE_WRAP_S]:D.a.CLAMP_TO_EDGE,[D.a.TEXTURE_WRAP_T]:D.a.CLAMP_TO_EDGE}}),this.ownResources.push(i[D.a.COLOR_ATTACHMENT0])),t&&r?(i=i||{},i[D.a.DEPTH_STENCIL_ATTACHMENT]=new Be(this.gl,{id:this.id+"-depth-stencil",format:D.a.DEPTH24_STENCIL8,width:n,height:111}),this.ownResources.push(i[D.a.DEPTH_STENCIL_ATTACHMENT])):t?(i=i||{},i[D.a.DEPTH_ATTACHMENT]=new Be(this.gl,{id:this.id+"-depth",format:D.a.DEPTH_COMPONENT16,width:n,height:a}),this.ownResources.push(i[D.a.DEPTH_ATTACHMENT])):r&&k(!1),i}_unattach(e){const t=this.attachments[e];t&&(t instanceof Be?this.gl.framebufferRenderbuffer(D.a.FRAMEBUFFER,e,D.a.RENDERBUFFER,null):this.gl.framebufferTexture2D(D.a.FRAMEBUFFER,e,D.a.TEXTURE_2D,null,0),delete this.attachments[e])}_attachRenderbuffer({attachment:e=D.a.COLOR_ATTACHMENT0,renderbuffer:t}){const{gl:r}=this;r.framebufferRenderbuffer(D.a.FRAMEBUFFER,e,D.a.RENDERBUFFER,t.handle),this.attachments[e]=t}_attachTexture({attachment:e=D.a.COLOR_ATTACHMENT0,texture:t,layer:r,level:n}){const{gl:a}=this;switch(a.bindTexture(t.target,t.handle),t.target){case D.a.TEXTURE_2D_ARRAY:case D.a.TEXTURE_3D:Object(y.a)(a).framebufferTextureLayer(D.a.FRAMEBUFFER,e,t.target,n,r);break;case D.a.TEXTURE_CUBE_MAP:const i=function(e){return e<D.a.TEXTURE_CUBE_MAP_POSITIVE_X?e+D.a.TEXTURE_CUBE_MAP_POSITIVE_X:e}(r);a.framebufferTexture2D(D.a.FRAMEBUFFER,e,i,t.handle,n);break;case D.a.TEXTURE_2D:a.framebufferTexture2D(D.a.FRAMEBUFFER,e,D.a.TEXTURE_2D,t.handle,n);break;default:k(!1,"Illegal texture type")}a.bindTexture(t.target,null),this.attachments[e]=t}_setReadBuffer(e){const t=Object(y.c)(this.gl);t?t.readBuffer(e):k(e===D.a.COLOR_ATTACHMENT0||e===D.a.BACK,"Multiple render targets not supported"),this.readBuffer=e}_setDrawBuffers(e){const{gl:t}=this,r=Object(y.a)(t);if(r)r.drawBuffers(e);else{const r=t.getExtension("WEBGL_draw_buffers");r?r.drawBuffersWEBGL(e):k(1===e.length&&(e[0]===D.a.COLOR_ATTACHMENT0||e[0]===D.a.BACK),"Multiple render targets not supported")}this.drawBuffers=e}_getAttachmentParameterFallback(e){const t=je(this.gl);switch(e){case D.a.FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER:return t.WEBGL2?null:0;case D.a.FRAMEBUFFER_ATTACHMENT_RED_SIZE:case D.a.FRAMEBUFFER_ATTACHMENT_GREEN_SIZE:case D.a.FRAMEBUFFER_ATTACHMENT_BLUE_SIZE:case D.a.FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE:case D.a.FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE:case D.a.FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE:return t.WEBGL2?null:8;case D.a.FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE:return t.WEBGL2?null:D.a.UNSIGNED_INT;case D.a.FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING:return t.WEBGL2||t.EXT_sRGB?null:D.a.LINEAR;default:return null}}_createHandle(){return this.gl.createFramebuffer()}_deleteHandle(){this.gl.deleteFramebuffer(this.handle)}_bindHandle(e){return this.gl.bindFramebuffer(D.a.FRAMEBUFFER,e)}}const Ke=[D.a.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME,D.a.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE,D.a.FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING,D.a.FRAMEBUFFER_ATTACHMENT_RED_SIZE,D.a.FRAMEBUFFER_ATTACHMENT_GREEN_SIZE,D.a.FRAMEBUFFER_ATTACHMENT_BLUE_SIZE,D.a.FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE,D.a.FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE,D.a.FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE];function Ye(e,t){k(e instanceof Fe||e instanceof be||e instanceof Se);const r=e.constructor,{gl:n,width:a,height:i,format:s,type:o,dataFormat:E,border:u,mipmaps:_}=e;return new r(n,Object.assign({width:a,height:i,format:s,type:o,dataFormat:E,border:u,mipmaps:_},t))}function ze(e,t){const{gl:r,width:n,height:a,id:i}=e;return new ke(r,Object.assign({},t,{id:"framebuffer-for-"+i,width:n,height:a,attachments:{[D.a.COLOR_ATTACHMENT0]:e}}))}ke.ATTACHMENT_PARAMETERS=Ke;var $e={[D.a.ALIASED_LINE_WIDTH_RANGE]:{gl1:new Float32Array([1,1])},[D.a.ALIASED_POINT_SIZE_RANGE]:{gl1:new Float32Array([1,1])},[D.a.MAX_TEXTURE_SIZE]:{gl1:64,gl2:2048},[D.a.MAX_CUBE_MAP_TEXTURE_SIZE]:{gl1:16},[D.a.MAX_TEXTURE_IMAGE_UNITS]:{gl1:8},[D.a.MAX_COMBINED_TEXTURE_IMAGE_UNITS]:{gl1:8},[D.a.MAX_VERTEX_TEXTURE_IMAGE_UNITS]:{gl1:0},[D.a.MAX_RENDERBUFFER_SIZE]:{gl1:1},[D.a.MAX_VARYING_VECTORS]:{gl1:8},[D.a.MAX_VERTEX_ATTRIBS]:{gl1:8},[D.a.MAX_VERTEX_UNIFORM_VECTORS]:{gl1:128},[D.a.MAX_FRAGMENT_UNIFORM_VECTORS]:{gl1:16},[D.a.MAX_VIEWPORT_DIMS]:{gl1:new Int32Array([0,0])},[D.a.MAX_3D_TEXTURE_SIZE]:{gl1:0,gl2:256},[D.a.MAX_ARRAY_TEXTURE_LAYERS]:{gl1:0,gl2:256},[D.a.MAX_CLIENT_WAIT_TIMEOUT_WEBGL]:{gl1:0,gl2:0},[D.a.MAX_COLOR_ATTACHMENTS]:{gl1:0,gl2:4},[D.a.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS]:{gl1:0,gl2:0},[D.a.MAX_COMBINED_UNIFORM_BLOCKS]:{gl1:0,gl2:0},[D.a.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS]:{gl1:0,gl2:0},[D.a.MAX_DRAW_BUFFERS]:{gl1:0,gl2:4},[D.a.MAX_ELEMENT_INDEX]:{gl1:0,gl2:0},[D.a.MAX_ELEMENTS_INDICES]:{gl1:0,gl2:0},[D.a.MAX_ELEMENTS_VERTICES]:{gl1:0,gl2:0},[D.a.MAX_FRAGMENT_INPUT_COMPONENTS]:{gl1:0,gl2:0},[D.a.MAX_FRAGMENT_UNIFORM_BLOCKS]:{gl1:0,gl2:0},[D.a.MAX_FRAGMENT_UNIFORM_COMPONENTS]:{gl1:0,gl2:0},[D.a.MAX_SAMPLES]:{gl1:0,gl2:0},[D.a.MAX_SERVER_WAIT_TIMEOUT]:{gl1:0,gl2:0},[D.a.MAX_TEXTURE_LOD_BIAS]:{gl1:0,gl2:0},[D.a.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS]:{gl1:0,gl2:0},[D.a.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS]:{gl1:0,gl2:0},[D.a.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS]:{gl1:0,gl2:0},[D.a.MAX_UNIFORM_BLOCK_SIZE]:{gl1:0,gl2:0},[D.a.MAX_UNIFORM_BUFFER_BINDINGS]:{gl1:0,gl2:0},[D.a.MAX_VARYING_COMPONENTS]:{gl1:0,gl2:0},[D.a.MAX_VERTEX_OUTPUT_COMPONENTS]:{gl1:0,gl2:0},[D.a.MAX_VERTEX_UNIFORM_BLOCKS]:{gl1:0,gl2:0},[D.a.MAX_VERTEX_UNIFORM_COMPONENTS]:{gl1:0,gl2:0},[D.a.MIN_PROGRAM_TEXEL_OFFSET]:{gl1:0,gl2:-8,negative:!0},[D.a.MAX_PROGRAM_TEXEL_OFFSET]:{gl1:0,gl2:7},[D.a.UNIFORM_BUFFER_OFFSET_ALIGNMENT]:{gl1:0,gl2:0}};function Ze(e){if(e.luma=e.luma||{},!e.luma.limits){e.luma.limits={},e.luma.webgl1MinLimits={},e.luma.webgl2MinLimits={};const t=Object(y.e)(e);for(const r in $e){const n=$e[r],a=n.gl1,i="gl2"in n?n.gl2:n.gl1,s=t?i:a,o="gl2"in n&&!t||"extension"in n&&!e.getExtension(n.extension)?s:e.getParameter(r);e.luma.limits[r]=o,e.luma.webgl1MinLimits[r]=a,e.luma.webgl2MinLimits[r]=i}}return e.luma.limits}function Qe(e){e.luma=e.luma||{};const t=x(e);return e.luma.info||(e.luma.info={[D.a.UNMASKED_VENDOR_WEBGL]:t.vendor,[D.a.UNMASKED_RENDERER_WEBGL]:t.renderer,[D.a.VENDOR]:t.vendorMasked,[D.a.RENDERER]:t.rendererMasked,[D.a.VERSION]:t.version,[D.a.SHADING_LANGUAGE_VERSION]:t.shadingLanguageVersion}),e.luma.info}function qe(e){return Object.assign(x(e),{limits:Ze(e),info:Qe(e),webgl1MinLimits:e.luma.webgl1MinLimits,webgl2MinLimits:e.luma.webgl2MinLimits})}const Je={};function et(e,t,r={}){const n=He[t];if(k(n,t),!function(e={}){const t="undefined"!=typeof window&&window.navigator||{},r=e.userAgent||t.userAgent||"",n=-1!==r.indexOf("MSIE "),a=-1!==r.indexOf("Trident/");return n||a}(r))return!0;if(t in Je)return Je[t];const a=`#extension GL_${n[0]} : enable\nvoid main(void) {}`,i=e.createShader(e.VERTEX_SHADER);e.shaderSource(i,a),e.compileShader(i);const s=e.getShaderParameter(i,e.COMPILE_STATUS);return e.deleteShader(i),Je[t]=s,s}function tt(e,t="unnamed"){const r=e.match(/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/);return r?r[1]:t}function rt(e,t,r,n){const a=e.split(/\r?\n/),i={},s={},o=n||tt(t)||"(unnamed)",E=`${function(e){switch(e){case 35632:return"fragment";case 35633:return"vertex";default:return"unknown type"}}(r)} shader ${o}`;for(let t=0;t<a.length;t++){const r=a[t];if(r.length<=1)continue;const n=r.split(":"),o=n[0],u=parseInt(n[2],10);if(isNaN(u))throw new Error(`GLSL compilation error in ${E}: ${e}`);"WARNING"!==o?i[u]=r:s[u]=r}const u=function(e,t=1,r=": "){const n=e.split(/\r?\n/),a=String(n.length+t-1).length;return n.map((e,n)=>{const i=String(n+t),s=i.length;return at(i,a-s)+r+e})}(t);return{shaderName:E,errors:nt(i,u),warnings:nt(s,u)}}function nt(e,t){let r="";for(let n=0;n<t.length;n++){const a=t[n];if((e[n+3]||e[n+2]||e[n+1])&&(r+=a+"\n",e[n+1])){const t=e[n+1],a=t.split(":",3),i=a[0],s=parseInt(a[1],10)||0;r+=at(`^^^ ${i}: ${t.substring(a.join(":").length+1).trim()}\n\n`,s)}}return r}function at(e,t){let r="";for(let e=0;e<t;++e)r+=" ";return`${r}${e}`}class it extends ee{static getTypeName(e){switch(e){case D.a.VERTEX_SHADER:return"vertex-shader";case D.a.FRAGMENT_SHADER:return"fragment-shader";default:return k(!1),"unknown"}}constructor(e,t){Object(y.b)(e),k("string"==typeof t.source,"Shader: GLSL source code must be a JavaScript string");super(e,{id:tt(t.source,null)||t.id||$("unnamed "+it.getTypeName(t.shaderType))}),this.shaderType=t.shaderType,this.source=t.source,this.initialize(t)}initialize({source:e}){const t=tt(e,null);t&&(this.id=$(t)),this._compile(e)}getParameter(e){return this.gl.getShaderParameter(this.handle,e)}toString(){return`${it.getTypeName(this.shaderType)}:${this.id}`}getName(){return tt(this.source)||"unnamed-shader"}getSource(){return this.gl.getShaderSource(this.handle)}getTranslatedSource(){const e=this.gl.getExtension("WEBGL_debug_shaders");return e?e.getTranslatedShaderSource(this.handle):"No translated source available. WEBGL_debug_shaders not implemented"}_compile(e=this.source){e.startsWith("#version ")||(e="#version 100\n"+e),this.source=e,this.gl.shaderSource(this.handle,this.source),this.gl.compileShader(this.handle);if(!this.getParameter(D.a.COMPILE_STATUS)){const e=this.gl.getShaderInfoLog(this.handle),{shaderName:t,errors:r,warnings:n}=rt(e,this.source,this.shaderType,this.id);throw U.error(`GLSL compilation errors in ${t}\n${r}`)(),U.warn(`GLSL compilation warnings in ${t}\n${n}`)(),new Error("GLSL compilation errors in "+t)}}_deleteHandle(){this.gl.deleteShader(this.handle)}_getOptsFromHandle(){return{type:this.getParameter(D.a.SHADER_TYPE),source:this.getSource()}}}class st extends it{constructor(e,t){"string"==typeof t&&(t={source:t}),super(e,Object.assign({},t,{shaderType:D.a.VERTEX_SHADER}))}_createHandle(){return this.gl.createShader(D.a.VERTEX_SHADER)}}class ot extends it{constructor(e,t){"string"==typeof t&&(t={source:t}),super(e,Object.assign({},t,{shaderType:D.a.FRAGMENT_SHADER}))}_createHandle(){return this.gl.createShader(D.a.FRAGMENT_SHADER)}}const Et={[D.a.FLOAT]:Ft.bind(null,"uniform1fv",ft,1,Ot),[D.a.FLOAT_VEC2]:Ft.bind(null,"uniform2fv",ft,2,Ot),[D.a.FLOAT_VEC3]:Ft.bind(null,"uniform3fv",ft,3,Ot),[D.a.FLOAT_VEC4]:Ft.bind(null,"uniform4fv",ft,4,Ot),[D.a.INT]:Ft.bind(null,"uniform1iv",ht,1,Ot),[D.a.INT_VEC2]:Ft.bind(null,"uniform2iv",ht,2,Ot),[D.a.INT_VEC3]:Ft.bind(null,"uniform3iv",ht,3,Ot),[D.a.INT_VEC4]:Ft.bind(null,"uniform4iv",ht,4,Ot),[D.a.BOOL]:Ft.bind(null,"uniform1iv",ht,1,Ot),[D.a.BOOL_VEC2]:Ft.bind(null,"uniform2iv",ht,2,Ot),[D.a.BOOL_VEC3]:Ft.bind(null,"uniform3iv",ht,3,Ot),[D.a.BOOL_VEC4]:Ft.bind(null,"uniform4iv",ht,4,Ot),[D.a.FLOAT_MAT2]:Ft.bind(null,"uniformMatrix2fv",ft,4,bt),[D.a.FLOAT_MAT3]:Ft.bind(null,"uniformMatrix3fv",ft,9,bt),[D.a.FLOAT_MAT4]:Ft.bind(null,"uniformMatrix4fv",ft,16,bt),[D.a.SAMPLER_2D]:mt,[D.a.SAMPLER_CUBE]:mt,[D.a.UNSIGNED_INT]:Ft.bind(null,"uniform1uiv",Tt,1,Ot),[D.a.UNSIGNED_INT_VEC2]:Ft.bind(null,"uniform2uiv",Tt,2,Ot),[D.a.UNSIGNED_INT_VEC3]:Ft.bind(null,"uniform3uiv",Tt,3,Ot),[D.a.UNSIGNED_INT_VEC4]:Ft.bind(null,"uniform4uiv",Tt,4,Ot),[D.a.FLOAT_MAT2x3]:Ft.bind(null,"uniformMatrix2x3fv",ft,6,bt),[D.a.FLOAT_MAT2x4]:Ft.bind(null,"uniformMatrix2x4fv",ft,8,bt),[D.a.FLOAT_MAT3x2]:Ft.bind(null,"uniformMatrix3x2fv",ft,6,bt),[D.a.FLOAT_MAT3x4]:Ft.bind(null,"uniformMatrix3x4fv",ft,12,bt),[D.a.FLOAT_MAT4x2]:Ft.bind(null,"uniformMatrix4x2fv",ft,8,bt),[D.a.FLOAT_MAT4x3]:Ft.bind(null,"uniformMatrix4x3fv",ft,12,bt),[D.a.SAMPLER_2D]:mt,[D.a.SAMPLER_CUBE]:mt,[D.a.SAMPLER_3D]:mt,[D.a.SAMPLER_2D_SHADOW]:mt,[D.a.SAMPLER_2D_ARRAY]:mt,[D.a.SAMPLER_2D_ARRAY_SHADOW]:mt,[D.a.SAMPLER_CUBE_SHADOW]:mt,[D.a.INT_SAMPLER_2D]:mt,[D.a.INT_SAMPLER_3D]:mt,[D.a.INT_SAMPLER_CUBE]:mt,[D.a.INT_SAMPLER_2D_ARRAY]:mt,[D.a.UNSIGNED_INT_SAMPLER_2D]:mt,[D.a.UNSIGNED_INT_SAMPLER_3D]:mt,[D.a.UNSIGNED_INT_SAMPLER_CUBE]:mt,[D.a.UNSIGNED_INT_SAMPLER_2D_ARRAY]:mt},ut={},_t={},ct={},lt=[0];function At(e,t,r,n){1===t&&"boolean"==typeof e&&(e=e?1:0),Number.isFinite(e)&&(lt[0]=e,e=lt);const a=e.length;if(a%t&&U.warn("Uniform size should be multiples of "+t,e)(),e instanceof r)return e;let i=n[a];i||(i=new r(a),n[a]=i);for(let t=0;t<a;t++)i[t]=e[t];return i}function ft(e,t){return At(e,t,Float32Array,ut)}function ht(e,t){return At(e,t,Int32Array,_t)}function Tt(e,t){return At(e,t,Uint32Array,ct)}function dt(e,t,r){const n=Et[r.type];if(!n)throw new Error("Unknown GLSL uniform type "+r.type);return n().bind(null,e,t)}function Rt(e){if("]"!==e[e.length-1])return{name:e,length:1,isArray:!1};const t=e.match(/([^[]*)(\[[0-9]+\])?/);if(!t||t.length<2)throw new Error("Failed to parse GLSL uniform name "+e);return{name:t[1],length:t[2]||1,isArray:Boolean(t[2])}}function gt(e){return Array.isArray(e)||ArrayBuffer.isView(e)?function(e){if(0===e.length)return!1;const t=Math.min(e.length,16);for(let r=0;r<t;++r)if(!Number.isFinite(e[r]))return!1;return!0}(e):!!isFinite(e)||(!0===e||!1===e||(e instanceof de||(e instanceof Be||e instanceof ke&&Boolean(e.texture))))}function Nt(e,t,r){if(Array.isArray(r)||ArrayBuffer.isView(r))if(e[t]){const n=e[t];for(let e=0,t=r.length;e<t;++e)n[e]=r[e]}else e[t]=r.slice();else e[t]=r}function mt(){let e=null;return(t,r,n)=>{const a=e!==n;return a&&(t.uniform1i(r,n),e=n),a}}function Ft(e,t,r,n){let a=null,i=null;return(s,o,E)=>{const u=t(E,r),_=u.length;let c=!1;if(null===a)a=new Float32Array(_),i=_,c=!0;else{k(i===_,"Uniform length cannot change.");for(let e=0;e<_;++e)if(u[e]!==a[e]){c=!0;break}}return c&&(n(s,e,o,u),a.set(u)),c}}function Ot(e,t,r,n){e[t](r,n)}function bt(e,t,r,n){e[t](r,!1,n)}const St={5126:[5126,1,"float"],35664:[5126,2,"vec2"],35665:[5126,3,"vec3"],35666:[5126,4,"vec4"],5124:[5124,1,"int"],35667:[5124,2,"ivec2"],35668:[5124,3,"ivec3"],35669:[5124,4,"ivec4"],5125:[5125,1,"uint"],36294:[5125,2,"uvec2"],36295:[5125,3,"uvec3"],36296:[5125,4,"uvec4"],35670:[5126,1,"bool"],35671:[5126,2,"bvec2"],35672:[5126,3,"bvec3"],35673:[5126,4,"bvec4"],35674:[5126,8,"mat2"],35685:[5126,8,"mat2x3"],35686:[5126,8,"mat2x4"],35675:[5126,12,"mat3"],35687:[5126,12,"mat3x2"],35688:[5126,12,"mat3x4"],35676:[5126,16,"mat4"],35689:[5126,16,"mat4x2"],35690:[5126,16,"mat4x3"]};function It(e){switch(e){case 0:return 0;case 1:case 3:case 2:return 1;case 4:case 5:case 6:return 4;default:return k(!1),0}}function Lt(e){const t=St[e];if(!t)return null;const[r,n]=t;return{type:r,components:n}}function Bt(e,t){switch(e){case 5120:case 5121:case 5122:case 5123:e=5126}for(const r in St){const[n,a,i]=St[r];if(n===e&&a===t)return{glType:r,name:i}}return null}class Ct{constructor(e){this.id=e.id,this.attributeInfos=[],this.attributeInfosByName={},this.attributeInfosByLocation=[],this.varyingInfos=[],this.varyingInfosByName={},Object.seal(this),this._readAttributesFromProgram(e),this._readVaryingsFromProgram(e)}getAttributeInfo(e){const t=Number(e);return Number.isFinite(t)?this.attributeInfosByLocation[t]:this.attributeInfosByName[e]||null}getAttributeLocation(e){const t=this.getAttributeInfo(e);return t?t.location:-1}getAttributeAccessor(e){const t=this.getAttributeInfo(e);return t?t.accessor:null}getVaryingInfo(e){const t=Number(e);return Number.isFinite(t)?this.varyingInfos[t]:this.varyingInfosByName[e]||null}getVaryingIndex(e){const t=this.getVaryingInfo();return t?t.location:-1}getVaryingAccessor(e){const t=this.getVaryingInfo();return t?t.accessor:null}_readAttributesFromProgram(e){const{gl:t}=e,r=t.getProgramParameter(e.handle,t.ACTIVE_ATTRIBUTES);for(let n=0;n<r;n++){const{name:r,type:a,size:i}=t.getActiveAttrib(e.handle,n),s=t.getAttribLocation(e.handle,r);s>=0&&this._addAttribute(s,r,a,i)}this.attributeInfos.sort((e,t)=>e.location-t.location)}_readVaryingsFromProgram(e){const{gl:t}=e;if(!Object(y.e)(t))return;const r=t.getProgramParameter(e.handle,t.TRANSFORM_FEEDBACK_VARYINGS);for(let n=0;n<r;n++){const{name:r,type:a,size:i}=t.getTransformFeedbackVarying(e.handle,n);this._addVarying(n,r,a,i)}this.varyingInfos.sort((e,t)=>e.location-t.location)}_addAttribute(e,t,r,n){const{type:a,components:i}=Lt(r),s={type:a,size:n*i};this._inferProperties(e,t,s);const o={location:e,name:t,accessor:new oe(s)};this.attributeInfos.push(o),this.attributeInfosByLocation[e]=o,this.attributeInfosByName[o.name]=o}_inferProperties(e,t,r){/instance/i.test(t)&&(r.divisor=1)}_addVarying(e,t,r,n){const{type:a,components:i}=Lt(r),s={location:e,name:t,accessor:new oe({type:a,size:n*i})};this.varyingInfos.push(s),this.varyingInfosByName[s.name]=s}}const Mt=35981,pt=["setVertexArray","setAttributes","setBuffers","unsetBuffers","use","getUniformCount","getUniformInfo","getUniformLocation","getUniformValue","getVarying","getFragDataLocation","getAttachedShaders","getAttributeCount","getAttributeLocation","getAttributeInfo"];class Ut extends ee{constructor(e,t={}){super(e,t),this.stubRemovedMethods("Program","v6.0",pt),this._isCached=!1,this.initialize(t),Object.seal(this),this._setId(t.id)}initialize(e={}){const{hash:t,vs:r,fs:n,varyings:a,bufferMode:i=Mt}=e;return this.hash=t||"",this.vs="string"==typeof r?new st(this.gl,{id:e.id+"-vs",source:r}):r,this.fs="string"==typeof n?new ot(this.gl,{id:e.id+"-fs",source:n}):n,k(this.vs instanceof st),k(this.fs instanceof ot),this.uniforms={},this._textureUniforms={},a&&a.length>0&&(Object(y.a)(this.gl),this.varyings=a,this.gl2.transformFeedbackVaryings(this.handle,a,i)),this._compileAndLink(),this._readUniformLocationsFromLinkedProgram(),this.configuration=new Ct(this),this.setProps(e)}delete(e={}){return this._isCached?this:super.delete(e)}setProps(e){return"uniforms"in e&&this.setUniforms(e.uniforms),this}draw({logPriority:e,drawMode:t=D.a.TRIANGLES,vertexCount:r,offset:n=0,start:a,end:i,isIndexed:s=!1,indexType:o=D.a.UNSIGNED_SHORT,instanceCount:E=0,isInstanced:u=E>0,vertexArray:_=null,transformFeedback:c,framebuffer:l,parameters:A={},uniforms:f,samplers:h}){if((f||h)&&(U.deprecated("Program.draw({uniforms})","Program.setUniforms(uniforms)")(),this.setUniforms(f||{})),U.priority>=e){const n=l?l.id:"default",a=`mode=${Y(this.gl,t)} verts=${r} instances=${E} indexType=${Y(this.gl,o)} isInstanced=${u} isIndexed=${s} Framebuffer=`+n;U.log(e,a)()}return k(_),this.gl.useProgram(this.handle),!(!this._areTexturesRenderable()||0===r||u&&0===E)&&(_.bindForDraw(r,E,()=>{if(void 0!==l&&(A=Object.assign({},A,{framebuffer:l})),c){const e=It(t);c.begin(e)}this._bindTextures(),Object(P.c)(this.gl,A,()=>{s&&u?this.gl2.drawElementsInstanced(t,r,o,n,E):s&&Object(y.e)(this.gl)&&!isNaN(a)&&!isNaN(i)?this.gl2.drawRangeElements(t,a,i,r,o,n):s?this.gl.drawElements(t,r,o,n):u?this.gl2.drawArraysInstanced(t,n,r,E):this.gl.drawArrays(t,n,r)}),c&&c.end()}),!0)}setUniforms(e={}){U.priority>=2&&function(e,t,r){for(const n in e){const a=e[n];if((!r||Boolean(r[n]))&&!gt(a))throw t=t?t+" ":"",console.error(`${t} Bad uniform ${n}`,a),new Error(`${t} Bad uniform ${n}`)}}(e,this.id,this._uniformSetters),this.gl.useProgram(this.handle);for(const t in e){const r=e[t],n=this._uniformSetters[t];if(n){let e=r,a=!1;if(e instanceof ke&&(e=e.texture),e instanceof de)if(a=this.uniforms[t]!==r,a){void 0===n.textureIndex&&(n.textureIndex=this._textureIndexCounter++);const r=e,{textureIndex:a}=n;r.bind(a),e=a,this._textureUniforms[t]=r}else e=n.textureIndex;else this._textureUniforms[t]&&delete this._textureUniforms[t];(n(e)||a)&&Nt(this.uniforms,t,r)}}return this}_areTexturesRenderable(){let e=!0;for(const t in this._textureUniforms){const r=this._textureUniforms[t];r.update(),e=e&&r.loaded}return e}_bindTextures(){for(const e in this._textureUniforms){const t=this._uniformSetters[e].textureIndex;this._textureUniforms[e].bind(t)}}_createHandle(){return this.gl.createProgram()}_deleteHandle(){this.gl.deleteProgram(this.handle)}_getOptionsFromHandle(e){const t=this.gl.getAttachedShaders(e),r={};for(const e of t){switch(this.gl.getShaderParameter(this.handle,D.a.SHADER_TYPE)){case D.a.VERTEX_SHADER:r.vs=new st({handle:e});break;case D.a.FRAGMENT_SHADER:r.fs=new ot({handle:e})}}return r}_getParameter(e){return this.gl.getProgramParameter(this.handle,e)}_setId(e){if(!e){const e=this._getName();this.id=$(e)}}_getName(){let e=this.vs.getName()||this.fs.getName();return e=e.replace(/shader/i,""),e=e?e+"-program":"program",e}_compileAndLink(){const{gl:e}=this;if(e.attachShader(this.handle,this.vs.handle),e.attachShader(this.handle,this.fs.handle),U.time(4,"linkProgram for "+this._getName())(),e.linkProgram(this.handle),U.timeEnd(4,"linkProgram for "+this._getName())(),e.debug||U.level>0){if(!e.getProgramParameter(this.handle,e.LINK_STATUS))throw new Error("Error linking: "+e.getProgramInfoLog(this.handle));e.validateProgram(this.handle);if(!e.getProgramParameter(this.handle,e.VALIDATE_STATUS))throw new Error("Error validating: "+e.getProgramInfoLog(this.handle))}}_readUniformLocationsFromLinkedProgram(){const{gl:e}=this;this._uniformSetters={},this._uniformCount=this._getParameter(D.a.ACTIVE_UNIFORMS);for(let t=0;t<this._uniformCount;t++){const r=this.gl.getActiveUniform(this.handle,t),{name:n}=Rt(r.name);let a=e.getUniformLocation(this.handle,n);if(this._uniformSetters[n]=dt(e,a,r),r.size>1)for(let t=0;t<r.size;t++)a=e.getUniformLocation(this.handle,`${n}[${t}]`),this._uniformSetters[`${n}[${t}]`]=dt(e,a,r)}this._textureIndexCounter=0}getActiveUniforms(e,t){return this.gl2.getActiveUniforms(this.handle,e,t)}getUniformBlockIndex(e){return this.gl2.getUniformBlockIndex(this.handle,e)}getActiveUniformBlockParameter(e,t){return this.gl2.getActiveUniformBlockParameter(this.handle,e,t)}uniformBlockBinding(e,t){this.gl2.uniformBlockBinding(this.handle,e,t)}}class yt extends ee{static isSupported(e,t=[]){const r=Object(y.e)(e),n=Ve(e,we.TIMER_QUERY);let a=r||n;for(const e of t)switch(e){case"queries":a=a&&r;break;case"timers":a=a&&n;break;default:k(!1)}return a}constructor(e,t={}){super(e,t),this.target=null,this._queryPending=!1,this._pollingPromise=null,Object.seal(this)}beginTimeElapsedQuery(){return this.begin(35007)}beginOcclusionQuery({conservative:e=!1}={}){return this.begin(e?36202:35887)}beginTransformFeedbackQuery(){return this.begin(35976)}begin(e){return this._queryPending||(this.target=e,this.gl2.beginQuery(this.target,this.handle)),this}end(){return this._queryPending||this.target&&(this.gl2.endQuery(this.target),this.target=null,this._queryPending=!0),this}isResultAvailable(){if(!this._queryPending)return!1;const e=this.gl2.getQueryParameter(this.handle,34919);return e&&(this._queryPending=!1),e}isTimerDisjoint(){return this.gl2.getParameter(36795)}getResult(){return this.gl2.getQueryParameter(this.handle,34918)}getTimerMilliseconds(){return this.getResult()/1e6}createPoll(e=Number.POSITIVE_INFINITY){if(this._pollingPromise)return this._pollingPromise;let t=0;return this._pollingPromise=new Promise((r,n)=>{const a=()=>{this.isResultAvailable()?(r(this.getResult()),this._pollingPromise=null):t++>e?(n("Timed out"),this._pollingPromise=null):requestAnimationFrame(a)};requestAnimationFrame(a)}),this._pollingPromise}_createHandle(){return yt.isSupported(this.gl)?this.gl2.createQuery():null}_deleteHandle(){this.gl2.deleteQuery(this.handle)}}class Pt extends ee{static isSupported(e){return Object(y.e)(e)}constructor(e,t={}){Object(y.a)(e),super(e,t),this.initialize(t),this.stubRemovedMethods("TransformFeedback","v6.0",["pause","resume"]),Object.seal(this)}initialize(e={}){return this.buffers={},this.unused={},this.configuration=null,this.bindOnUse=!0,Q(this.buffers)||this.bind(()=>this._unbindBuffers()),this.setProps(e),this}setProps(e){"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"bindOnUse"in e&&(e=e.bindOnUse),"buffers"in e&&this.setBuffers(e.buffers)}setBuffers(e={}){return this.bind(()=>{for(const t in e)this.setBuffer(t,e[t])}),this}setBuffer(e,t){const r=this._getVaryingIndex(e),{buffer:n,byteSize:a,byteOffset:i}=this._getBufferParams(t);return r<0?(this.unused[e]=n,U.warn(()=>`${this.id} unused varying buffer ${e}`)(),this):(this.buffers[r]=t,this.bindOnUse||this._bindBuffer(r,n,i,a),this)}begin(e=D.a.POINTS){return this.gl.bindTransformFeedback(D.a.TRANSFORM_FEEDBACK,this.handle),this._bindBuffers(),this.gl.beginTransformFeedback(e),this}end(){return this.gl.endTransformFeedback(),this._unbindBuffers(),this.gl.bindTransformFeedback(D.a.TRANSFORM_FEEDBACK,null),this}_getBufferParams(e){let t,r,n;return e instanceof ce==!1?(n=e.buffer,r=e.byteSize,t=e.byteOffset):n=e,void 0===t&&void 0===r||(t=t||0,r=r||n.byteLength-t),{buffer:n,byteOffset:t,byteSize:r}}_getVaryingInfo(e){return this.configuration&&this.configuration.getVaryingInfo(e)}_getVaryingIndex(e){if(this.configuration)return this.configuration.getVaryingInfo(e).location;const t=Number(e);return Number.isFinite(t)?t:-1}_bindBuffers(){if(this.bindOnUse)for(const e in this.buffers){const{buffer:t,byteSize:r,byteOffset:n}=this._getBufferParams(this.buffers[e]);this._bindBuffer(e,t,n,r)}}_unbindBuffers(){if(this.bindOnUse)for(const e in this.buffers)this._bindBuffer(e,null)}_bindBuffer(e,t,r=0,n){const a=t&&t.handle;return a&&void 0!==n?this.gl.bindBufferRange(D.a.TRANSFORM_FEEDBACK_BUFFER,e,a,r,n):this.gl.bindBufferBase(D.a.TRANSFORM_FEEDBACK_BUFFER,e,a),this}_createHandle(){return this.gl.createTransformFeedback()}_deleteHandle(){this.gl.deleteTransformFeedback(this.handle)}_bindHandle(e){this.gl.bindTransformFeedback(D.a.TRANSFORM_FEEDBACK,this.handle)}}let Dt=null;function vt(e,t){var r;return new e((r=e.BYTES_PER_ELEMENT*t,(!Dt||Dt.byteLength<r)&&(Dt=new ArrayBuffer(r)),Dt),0,t)}var Gt=r(19);class xt extends ee{static isSupported(e,t={}){return!t.constantAttributeZero||(Object(y.e)(e)||"Chrome"===function(e){if(!e&&!Object(u.a)())return"Node";if(Object(Gt.a)(e))return"Electron";var t="undefined"!=typeof navigator?navigator:{},r=e||t.userAgent||"";if(r.indexOf("Edge")>-1)return"Edge";var n=-1!==r.indexOf("MSIE "),a=-1!==r.indexOf("Trident/");return n||a?"IE":N.b.chrome?"Chrome":N.b.safari?"Safari":N.b.mozInnerScreenX?"Firefox":"Unknown"}())}static getDefaultArray(e){return e.luma=e.luma||{},e.luma.defaultVertexArray||(e.luma.defaultVertexArray=new xt(e,{handle:null,isDefaultArray:!0})),e.luma.defaultVertexArray}static getMaxAttributes(e){return xt.MAX_ATTRIBUTES=xt.MAX_ATTRIBUTES||e.getParameter(e.MAX_VERTEX_ATTRIBS),xt.MAX_ATTRIBUTES}static setConstant(e,t,r){switch(r.constructor){case Float32Array:xt._setConstantFloatArray(e,t,r);break;case Int32Array:xt._setConstantIntArray(e,t,r);break;case Uint32Array:xt._setConstantUintArray(e,t,r);break;default:k(!1)}}constructor(e,t={}){const r=t.id||t.program&&t.program.id;super(e,Object.assign({},t,{id:r})),this.buffer=null,this.bufferValue=null,this.isDefaultArray=t.isDefaultArray||!1,this.gl2=e,this.initialize(t),Object.seal(this)}delete(){return super.delete(),this.buffer&&this.buffer.delete(),this}get MAX_ATTRIBUTES(){return xt.getMaxAttributes(this.gl)}initialize(e={}){return this.setProps(e)}setProps(e){return this}setElementBuffer(e=null,t={}){return k(!e||e.target===D.a.ELEMENT_ARRAY_BUFFER,"elements must be GL.ELEMENT_ARRAY_BUFFER"),this.bind(()=>{this.gl.bindBuffer(D.a.ELEMENT_ARRAY_BUFFER,e?e.handle:null)}),this}setBuffer(e,t,r){if(t.target===D.a.ELEMENT_ARRAY_BUFFER)return this.setElementBuffer(t,r);const{size:n,type:a,stride:i,offset:s,normalized:o,integer:E,divisor:u}=r,{gl:_,gl2:c}=this;return e=Number(e),this.bind(()=>{_.bindBuffer(_.ARRAY_BUFFER,t.handle),E?(k(Object(y.e)(_)),c.vertexAttribIPointer(e,n,a,i,s)):_.vertexAttribPointer(e,n,a,o,i,s),_.enableVertexAttribArray(e),c.vertexAttribDivisor(e,u||0)}),this}enable(e,t=!0){return!t&&0===e&&!xt.isSupported(this.gl,{constantAttributeZero:!0})||(e=Number(e),this.bind(()=>t?this.gl.enableVertexAttribArray(e):this.gl.disableVertexAttribArray(e))),this}getConstantBuffer(e,t){const r=this._normalizeConstantArrayValue(t),n=r.byteLength*e,a=r.length*e;let i=!this.buffer;if(this.buffer=this.buffer||new ce(this.gl,n),i=i||this.buffer.reallocate(n),i=i||!this._compareConstantArrayValues(r,this.bufferValue),i){const e=vt(t.constructor,a);!function({target:e,source:t,start:r=0,count:n=1}){const a=t.length,i=n*a;let s=0;for(let n=r;s<a;s++)e[n++]=t[s];for(;s<i;)s<i-s?(e.copyWithin(r+s,r,r+s),s*=2):(e.copyWithin(r+s,r,r+i-s),s=i)}({target:e,source:r,start:0,count:a}),this.buffer.subData(e),this.bufferValue=t}return this.buffer}_normalizeConstantArrayValue(e){return Array.isArray(e)?new Float32Array(e):e}_compareConstantArrayValues(e,t){if(!e||!t||e.length!==t.length||e.constructor!==t.constructor)return!1;for(let r=0;r<e.length;++r)if(e[r]!==t[r])return!1;return!0}static _setConstantFloatArray(e,t,r){switch(r.length){case 1:e.vertexAttrib1fv(t,r);break;case 2:e.vertexAttrib2fv(t,r);break;case 3:e.vertexAttrib3fv(t,r);break;case 4:e.vertexAttrib4fv(t,r);break;default:k(!1)}}static _setConstantIntArray(e,t,r){switch(k(Object(y.e)(e)),r.length){case 1:e.vertexAttribI1iv(t,r);break;case 2:e.vertexAttribI2iv(t,r);break;case 3:e.vertexAttribI3iv(t,r);break;case 4:e.vertexAttribI4iv(t,r);break;default:k(!1)}}static _setConstantUintArray(e,t,r){switch(k(Object(y.e)(e)),r.length){case 1:e.vertexAttribI1uiv(t,r);break;case 2:e.vertexAttribI2uiv(t,r);break;case 3:e.vertexAttribI3uiv(t,r);break;case 4:e.vertexAttribI4uiv(t,r);break;default:k(!1)}}_createHandle(){return this.gl.createVertexArray()}_deleteHandle(e){return this.gl2.deleteVertexArray(e),[this.elements]}_bindHandle(e){this.gl2.bindVertexArray(e)}_getParameter(e,{location:t}){return k(Number.isFinite(t)),this.bind(()=>{switch(e){case D.a.VERTEX_ATTRIB_ARRAY_POINTER:return this.gl.getVertexAttribOffset(t,e);default:return this.gl.getVertexAttrib(t,e)}})}}const wt=/^(.+)__LOCATION_([0-9]+)$/,Ht=["setBuffers","setGeneric","clearBindings","setLocations","setGenericValues","setDivisor","enable","disable"];class Xt{constructor(e,t={}){const r=t.id||t.program&&t.program.id;this.id=r,this.gl=e,this.configuration=null,this.elements=null,this.elementsAccessor=null,this.values=null,this.accessors=null,this.unused=null,this.drawParams=null,this.buffer=null,this.attributes={},this.vertexArrayObject=new xt(e),q(this,"VertexArray","v6.0",Ht),this.initialize(t),Object.seal(this)}delete(){this.buffer&&this.buffer.delete(),this.vertexArrayObject.delete()}initialize(e={}){return this.reset(),this.configuration=null,this.bindOnUse=!1,this.setProps(e)}reset(){this.elements=null,this.elementsAccessor=null;const{MAX_ATTRIBUTES:e}=this.vertexArrayObject;return this.values=new Array(e).fill(null),this.accessors=new Array(e).fill(null),this.unused={},this.drawParams=null,this}setProps(e){return"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"attributes"in e&&this.setAttributes(e.attributes),"elements"in e&&this.setElementBuffer(e.elements),"bindOnUse"in e&&(e=e.bindOnUse),this}clearDrawParams(){this.drawParams=null}getDrawParams(){return this.drawParams=this.drawParams||this._updateDrawParams(),this.drawParams}setAttributes(e){return Object.assign(this.attributes,e),this.vertexArrayObject.bind(()=>{for(const t in e){const r=e[t];this._setAttribute(t,r)}this.gl.bindBuffer(D.a.ARRAY_BUFFER,null)}),this}setElementBuffer(e=null,t={}){return this.elements=e,this.elementsAccessor=t,this.clearDrawParams(),this.vertexArrayObject.setElementBuffer(e,t),this}setBuffer(e,t,r={}){if(t.target===D.a.ELEMENT_ARRAY_BUFFER)return this.setElementBuffer(t,r);const{location:n,accessor:a}=this._resolveLocationAndAccessor(e,t,t.accessor,r);return n>=0&&(this.values[n]=t,this.accessors[n]=a,this.clearDrawParams(),this.vertexArrayObject.setBuffer(n,t,a)),this}setConstant(e,t,r={}){const{location:n,accessor:a}=this._resolveLocationAndAccessor(e,t,Object.assign({size:t.length},r));return n>=0&&(t=this.vertexArrayObject._normalizeConstantArrayValue(t),this.values[n]=t,this.accessors[n]=a,this.clearDrawParams(),this.vertexArrayObject.enable(n,!1)),this}unbindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.vertexArrayObject.setElementBuffer(null),this.buffer=this.buffer||new ce(this.gl,{accessor:{size:4}});for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++)this.values[e]instanceof ce&&(this.gl.disableVertexAttribArray(e),this.gl.bindBuffer(D.a.ARRAY_BUFFER,this.buffer.handle),this.gl.vertexAttribPointer(e,1,D.a.FLOAT,!1,0,0))}),this}bindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.setElementBuffer(this.elements);for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++){const t=this.values[e];t instanceof ce&&this.setBuffer(e,t)}}),this}bindForDraw(e,t,r){let n;return this.vertexArrayObject.bind(()=>{this._setConstantAttributes(e,t),n=r()}),n}_resolveLocationAndAccessor(e,t,r,n){const a={location:-1,accessor:null},{location:i,name:s}=this._getAttributeIndex(e);if(!Number.isFinite(i)||i<0)return this.unused[e]=t,U.once(3,()=>`unused value ${e} in ${this.id}`)(),a;const o=this._getAttributeInfo(s||i);if(!o)return a;const E=this.accessors[i]||{},u=oe.resolve(o.accessor,E,r,n),{size:_,type:c}=u;return k(Number.isFinite(_)&&Number.isFinite(c)),{location:i,accessor:u}}_getAttributeInfo(e){return this.configuration&&this.configuration.getAttributeInfo(e)}_getAttributeIndex(e){const t=Number(e);if(Number.isFinite(t))return{location:t};const r=wt.exec(e),n=r?r[1]:e,a=r?Number(r[2]):0;return this.configuration?{location:this.configuration.getAttributeLocation(n)+a,name:n}:{location:-1}}_setAttribute(e,t){if(t instanceof ce)this.setBuffer(e,t);else if(Array.isArray(t)&&t.length&&t[0]instanceof ce){const r=t[0],n=t[1];this.setBuffer(e,r,n)}else if(ArrayBuffer.isView(t)||Array.isArray(t)){const r=t;this.setConstant(e,r)}else{if(!(t.buffer instanceof ce))throw new Error("VertexArray: attributes must be Buffers or constants (i.e. typed array)");{const r=t;this.setBuffer(e,r.buffer,r)}}}_setConstantAttributes(e,t){const r=Math.max(0|e,0|t);let n=this.values[0];ArrayBuffer.isView(n)&&this._setConstantAttributeZero(n,r);for(let e=1;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++)n=this.values[e],ArrayBuffer.isView(n)&&this._setConstantAttribute(e,n)}_setConstantAttributeZero(e,t){if(xt.isSupported(this.gl,{constantAttributeZero:!0}))return void this._setConstantAttribute(0,e);const r=this.vertexArrayObject.getConstantBuffer(t,e);this.vertexArrayObject.setBuffer(0,r,this.accessors[0])}_setConstantAttribute(e,t){xt.setConstant(this.gl,e,t)}_updateDrawParams(){const e={isIndexed:!1,isInstanced:!1,indexCount:1/0,vertexCount:1/0,instanceCount:1/0};for(let t=0;t<this.vertexArrayObject.MAX_ATTRIBUTES;t++)this._updateDrawParamsForLocation(e,t);return this.elements&&(e.elementCount=this.elements.getElementCount(this.elements.accessor),e.isIndexed=!0,e.indexType=this.elementsAccessor.type||this.elements.accessor.type,e.indexOffset=this.elementsAccessor.offset||0),e.indexCount===1/0&&(e.indexCount=0),e.vertexCount===1/0&&(e.vertexCount=0),e.instanceCount===1/0&&(e.instanceCount=0),e}_updateDrawParamsForLocation(e,t){const r=this.values[t],n=this.accessors[t];if(!r)return;const{divisor:a}=n,i=a>0;if(e.isInstanced=e.isInstanced||i,r instanceof ce){const t=r;if(i){const r=t.getVertexCount(n);e.instanceCount=Math.min(e.instanceCount,r)}else{const r=t.getVertexCount(n);e.vertexCount=Math.min(e.vertexCount,r)}}}setElements(e=null,t={}){return U.deprecated("setElements","setElementBuffer")(),this.setElementBuffer(e,t)}}class Vt{constructor(e){this.layout={},this.size=0;for(const t in e)this._addUniform(t,e[t]);this.size+=(4-this.size%4)%4;const t=new Float32Array(this.size);this.typedArray={5126:t,5124:new Int32Array(t.buffer),5125:new Uint32Array(t.buffer)}}getBytes(){return 4*this.size}getData(){return this.typedArray[5126]}getSubData(e){let t,r;if(void 0===e)t=this.data,r=0;else{const n=this.offsets[e],a=n+this.sizes[e];t=this.data.subarray(n,a),r=4*n}return{data:t,offset:r}}setUniforms(e){for(const t in e)this._setValue(t,e[t]);return this}_setValue(e,t){const r=this.layout[e];k(r,"UniformLayoutStd140 illegal argument");const n=this.typedArray[r.type];1===r.size?n[r.offset]=t:n.set(t,r.offset)}_addUniform(e,t){const r=Lt(t);k(r,"UniformBufferLayout illegal argument");const{type:n,components:a}=r;this.size=this._alignTo(this.size,a);const i=this.size;this.size+=a,this.layout[e]={type:n,size:a,offset:i}}_alignTo(e,t){switch(t){case 1:return e;case 2:return e+e%2;default:return e+(4-e%4)%4}}}function jt(e){let t=100;const r=e.match(/[^\s]+/g);if(r.length>=2&&"#version"===r[0]){const e=parseInt(r[1],10);Number.isFinite(e)&&(t=e)}return t}function Wt(e,t={}){const{isInteger:r=!1}=t;if(Array.isArray(e)||ArrayBuffer.isView(e))return function(e,t){const{maxElts:r=16,size:n=1}=t;let a="[";for(let i=0;i<e.length&&i<r;++i)i>0&&(a+=","+(i%n==0?" ":"")),a+=Wt(e[i],t);return`${a}${e.length>r?"...":"]"}`}(e,t);if(!Number.isFinite(e))return String(e);if(Math.abs(e)<1e-16)return r?"0":"0.";if(r)return e.toFixed(0);if(Math.abs(e)>100&&Math.abs(e)<1e4)return e.toFixed(0);const n=e.toPrecision(2);return n.indexOf(".0")===n.length-2?n.slice(0,-1):n}function kt({header:e="Uniforms",program:t,uniforms:r,undefinedOnly:n=!1}){k(t);const a=t._uniformSetters,i={},s=Object.keys(a).sort();let o=0;for(const t of s)t.match(".*_.*")||t.match(".*Matrix")||Kt({table:i,header:e,uniforms:r,uniformName:t,undefinedOnly:n})&&o++;for(const t of s)t.match(".*Matrix")&&Kt({table:i,header:e,uniforms:r,uniformName:t,undefinedOnly:n})&&o++;for(const t of s)i[t]||Kt({table:i,header:e,uniforms:r,uniformName:t,undefinedOnly:n})&&o++;let E=0;const u={};if(!n)for(const t in r){const n=r[t];i[t]||(E++,u[t]={Type:"NOT USED: "+n,[e]:Wt(n)})}return{table:i,count:o,unusedTable:u,unusedCount:E}}function Kt({table:e,header:t,uniforms:r,uniformName:n,undefinedOnly:a}){const i=r[n],s=function(e){return null!=e}(i);return(!a||!s)&&(e[n]={[t]:s?Wt(i):"N/A","Uniform Type":s?i:"NOT PROVIDED"},!0)}function Yt({vertexArray:e,header:t="Attributes"}){if(!e.configuration)return{};const r={};e.elements&&(r.ELEMENT_ARRAY_BUFFER=zt(e,e.elements,null,t));const n=e.values;for(const a in n){const i=e._getAttributeInfo(a);if(i){let s=`${a}: ${i.name}`;const o=e.accessors[i.location];o&&(s=`${a}: ${$t(i.name,o)}`),r[s]=zt(e,n[a],o,t)}}return r}function zt(e,t,r,n){const{gl:a}=e;if(!t)return{[n]:"null","Format ":"N/A"};let i,s,o,E="NOT PROVIDED",u=1,_=0,c=0;if(r&&(E=r.type,u=r.size,E=String(E).replace("Array",""),i=-1!==E.indexOf("nt")),t instanceof ce){const e=t,{data:l,changed:A}=e.getDebugData();let f;if(s=A?"*":"",o=l,c=e.byteLength,_=c/l.BYTES_PER_ELEMENT/u,r){f=`${r.divisor>0?"I ":"P "} ${_} (x${u}=${c} bytes ${Y(a,E)})`}else i=!0,f=c+" bytes";return{[n]:`${s}${Wt(o,{size:u,isInteger:i})}`,"Format ":f}}return o=t,u=t.length,E=String(t.constructor.name).replace("Array",""),i=-1!==E.indexOf("nt"),{[n]:Wt(o,{size:u,isInteger:i})+" (constant)","Format ":`${u}x${E} (constant)`}}function $t(e,t){const{type:r,size:n}=t,a=Bt(r,n);return a?`${e} (${a.name})`:e}function Zt(e){const t={},r="Accessors for "+e.id;for(const n of e.attributeInfos)if(n){t["in "+Qt(n)]={[r]:JSON.stringify(n.accessor)}}for(const n of e.varyingInfos)if(n){t["out "+Qt(n)]={[r]:JSON.stringify(n.accessor)}}return t}function Qt(e){const{type:t,size:r}=e.accessor,n=Bt(t,r);return n?`${n.name} ${e.name}`:e.name}}])}));