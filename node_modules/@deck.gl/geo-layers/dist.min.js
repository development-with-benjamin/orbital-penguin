!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("deck"),require("h3"),require("luma")):"function"==typeof define&&define.amd?define(["deck","h3","luma"],t):"object"==typeof exports?exports.deck=t(require("deck"),require("h3"),require("luma")):e.deck=t(e.deck,e.h3,e.luma)}(window,(function(e,t,r){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=37)}([function(e,t,r){e.exports=r(46)},function(t,r){t.exports=e},function(e,t){function r(t){return e.exports=r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},r(t)}e.exports=r},function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t){function r(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}e.exports=function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}},function(e,t,r){var n=r(40),i=r(41),o=r(42);e.exports=function(e,t){return n(e)||i(e,t)||o()}},function(e,t,r){var n=r(38);e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&n(e,t)}},function(e,t,r){var n=r(23),i=r(39);e.exports=function(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?i(e):t}},function(e,r){e.exports=t},function(e,t,r){var n=r(47);function i(t,r,o){return"undefined"!=typeof Reflect&&Reflect.get?e.exports=i=Reflect.get:e.exports=i=function(e,t,r){var i=n(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(r):o.value}},i(t,r,o||t)}e.exports=i},function(e,t){e.exports=function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}},function(e,t,r){var n=r(43),i=r(44),o=r(45);e.exports=function(e){return n(e)||i(e)||o()}},,function(e,t){function r(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}e.exports=function(e){return function(){var t=this,n=arguments;return new Promise((function(i,o){var a=e.apply(t,n);function s(e){r(a,i,o,s,u,"next",e)}function u(e){r(a,i,o,s,u,"throw",e)}s(void 0)}))}}},function(e,t,r){var n,i,o;
/**
 * @license long.js (c) 2013 Daniel Wirtz <dcode@dcode.io>
 * Released under the Apache License, Version 2.0
 * see: https://github.com/dcodeIO/long.js for details
 */i=[],void 0===(o="function"==typeof(n=function(){"use strict";function e(e,t,r){this.low=0|e,this.high=0|t,this.unsigned=!!r}function t(e){return!0===(e&&e.__isLong__)}e.prototype.__isLong__,Object.defineProperty(e.prototype,"__isLong__",{value:!0,enumerable:!1,configurable:!1}),e.isLong=t;var r={},n={};function i(e,t){var i,o,s;return t?(s=0<=(e>>>=0)&&e<256)&&(o=n[e])?o:(i=a(e,(0|e)<0?-1:0,!0),s&&(n[e]=i),i):(s=-128<=(e|=0)&&e<128)&&(o=r[e])?o:(i=a(e,e<0?-1:0,!1),s&&(r[e]=i),i)}function o(e,t){if(isNaN(e)||!isFinite(e))return t?y:d;if(t){if(e<0)return y;if(e>=f)return w}else{if(e<=-h)return x;if(e+1>=h)return b}return e<0?o(-e,t).neg():a(e%l|0,e/l|0,t)}function a(t,r,n){return new e(t,r,n)}e.fromInt=i,e.fromNumber=o,e.fromBits=a;var s=Math.pow;function u(e,t,r){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return d;if("number"==typeof t?(r=t,t=!1):t=!!t,(r=r||10)<2||36<r)throw RangeError("radix");var n;if((n=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===n)return u(e.substring(1),t,r).neg();for(var i=o(s(r,8)),a=d,c=0;c<e.length;c+=8){var l=Math.min(8,e.length-c),f=parseInt(e.substring(c,c+l),r);if(l<8){var h=o(s(r,l));a=a.mul(h).add(o(f))}else a=(a=a.mul(i)).add(o(f))}return a.unsigned=t,a}function c(t){return t instanceof e?t:"number"==typeof t?o(t):"string"==typeof t?u(t):a(t.low,t.high,t.unsigned)}e.fromString=u,e.fromValue=c;var l=4294967296,f=l*l,h=f/2,p=i(1<<24),d=i(0);e.ZERO=d;var y=i(0,!0);e.UZERO=y;var v=i(1);e.ONE=v;var g=i(1,!0);e.UONE=g;var m=i(-1);e.NEG_ONE=m;var b=a(-1,2147483647,!1);e.MAX_VALUE=b;var w=a(-1,-1,!0);e.MAX_UNSIGNED_VALUE=w;var x=a(0,-2147483648,!1);e.MIN_VALUE=x;var k=e.prototype;return k.toInt=function(){return this.unsigned?this.low>>>0:this.low},k.toNumber=function(){return this.unsigned?(this.high>>>0)*l+(this.low>>>0):this.high*l+(this.low>>>0)},k.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(x)){var t=o(e),r=this.div(t),n=r.mul(t).sub(this);return r.toString(e)+n.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var i=o(s(e,6),this.unsigned),a=this,u="";;){var c=a.div(i),l=(a.sub(c.mul(i)).toInt()>>>0).toString(e);if((a=c).isZero())return l+u;for(;l.length<6;)l="0"+l;u=""+l+u}},k.getHighBits=function(){return this.high},k.getHighBitsUnsigned=function(){return this.high>>>0},k.getLowBits=function(){return this.low},k.getLowBitsUnsigned=function(){return this.low>>>0},k.getNumBitsAbs=function(){if(this.isNegative())return this.eq(x)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&0==(e&1<<t);t--);return 0!=this.high?t+33:t+1},k.isZero=function(){return 0===this.high&&0===this.low},k.isNegative=function(){return!this.unsigned&&this.high<0},k.isPositive=function(){return this.unsigned||this.high>=0},k.isOdd=function(){return 1==(1&this.low)},k.isEven=function(){return 0==(1&this.low)},k.equals=function(e){return t(e)||(e=c(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&this.high===e.high&&this.low===e.low},k.eq=k.equals,k.notEquals=function(e){return!this.eq(e)},k.neq=k.notEquals,k.lessThan=function(e){return this.comp(e)<0},k.lt=k.lessThan,k.lessThanOrEqual=function(e){return this.comp(e)<=0},k.lte=k.lessThanOrEqual,k.greaterThan=function(e){return this.comp(e)>0},k.gt=k.greaterThan,k.greaterThanOrEqual=function(e){return this.comp(e)>=0},k.gte=k.greaterThanOrEqual,k.compare=function(e){if(t(e)||(e=c(e)),this.eq(e))return 0;var r=this.isNegative(),n=e.isNegative();return r&&!n?-1:!r&&n?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},k.comp=k.compare,k.negate=function(){return!this.unsigned&&this.eq(x)?x:this.not().add(v)},k.neg=k.negate,k.add=function(e){t(e)||(e=c(e));var r=this.high>>>16,n=65535&this.high,i=this.low>>>16,o=65535&this.low,s=e.high>>>16,u=65535&e.high,l=e.low>>>16,f=0,h=0,p=0,d=0;return p+=(d+=o+(65535&e.low))>>>16,h+=(p+=i+l)>>>16,f+=(h+=n+u)>>>16,f+=r+s,a((p&=65535)<<16|(d&=65535),(f&=65535)<<16|(h&=65535),this.unsigned)},k.subtract=function(e){return t(e)||(e=c(e)),this.add(e.neg())},k.sub=k.subtract,k.multiply=function(e){if(this.isZero())return d;if(t(e)||(e=c(e)),e.isZero())return d;if(this.eq(x))return e.isOdd()?x:d;if(e.eq(x))return this.isOdd()?x:d;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(p)&&e.lt(p))return o(this.toNumber()*e.toNumber(),this.unsigned);var r=this.high>>>16,n=65535&this.high,i=this.low>>>16,s=65535&this.low,u=e.high>>>16,l=65535&e.high,f=e.low>>>16,h=65535&e.low,y=0,v=0,g=0,m=0;return g+=(m+=s*h)>>>16,v+=(g+=i*h)>>>16,g&=65535,v+=(g+=s*f)>>>16,y+=(v+=n*h)>>>16,v&=65535,y+=(v+=i*f)>>>16,v&=65535,y+=(v+=s*l)>>>16,y+=r*h+n*f+i*l+s*u,a((g&=65535)<<16|(m&=65535),(y&=65535)<<16|(v&=65535),this.unsigned)},k.mul=k.multiply,k.divide=function(e){if(t(e)||(e=c(e)),e.isZero())throw Error("division by zero");if(this.isZero())return this.unsigned?y:d;var r,n,i;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return y;if(e.gt(this.shru(1)))return g;i=y}else{if(this.eq(x))return e.eq(v)||e.eq(m)?x:e.eq(x)?v:(r=this.shr(1).div(e).shl(1)).eq(d)?e.isNegative()?v:m:(n=this.sub(e.mul(r)),i=r.add(n.div(e)));if(e.eq(x))return this.unsigned?y:d;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();i=d}for(n=this;n.gte(e);){r=Math.max(1,Math.floor(n.toNumber()/e.toNumber()));for(var a=Math.ceil(Math.log(r)/Math.LN2),u=a<=48?1:s(2,a-48),l=o(r),f=l.mul(e);f.isNegative()||f.gt(n);)f=(l=o(r-=u,this.unsigned)).mul(e);l.isZero()&&(l=v),i=i.add(l),n=n.sub(f)}return i},k.div=k.divide,k.modulo=function(e){return t(e)||(e=c(e)),this.sub(this.div(e).mul(e))},k.mod=k.modulo,k.not=function(){return a(~this.low,~this.high,this.unsigned)},k.and=function(e){return t(e)||(e=c(e)),a(this.low&e.low,this.high&e.high,this.unsigned)},k.or=function(e){return t(e)||(e=c(e)),a(this.low|e.low,this.high|e.high,this.unsigned)},k.xor=function(e){return t(e)||(e=c(e)),a(this.low^e.low,this.high^e.high,this.unsigned)},k.shiftLeft=function(e){return t(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?a(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):a(0,this.low<<e-32,this.unsigned)},k.shl=k.shiftLeft,k.shiftRight=function(e){return t(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?a(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):a(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},k.shr=k.shiftRight,k.shiftRightUnsigned=function(e){if(t(e)&&(e=e.toInt()),0==(e&=63))return this;var r=this.high;return e<32?a(this.low>>>e|r<<32-e,r>>>e,this.unsigned):a(32===e?r:r>>>e-32,0,this.unsigned)},k.shru=k.shiftRightUnsigned,k.toSigned=function(){return this.unsigned?a(this.low,this.high,!1):this},k.toUnsigned=function(){return this.unsigned?this:a(this.low,this.high,!0)},k.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},k.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24&255,255&e,e>>>8&255,e>>>16&255,e>>>24&255]},k.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24&255,e>>>16&255,e>>>8&255,255&e,t>>>24&255,t>>>16&255,t>>>8&255,255&t]},e})?n.apply(t,i):n)||(e.exports=o)},,function(e,t){},,,,,,,function(e,t){function r(t){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?e.exports=r=function(e){return typeof e}:e.exports=r=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(t)}e.exports=r},function(e,t){},,,function(e,t){e.exports=r},function(e,t,r){"use strict";e.exports=i;var n=r(48);function i(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}i.Varint=0,i.Fixed64=1,i.Bytes=2,i.Fixed32=5;var o="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function a(e){return e.type===i.Bytes?e.readVarint()+e.pos:e.pos+1}function s(e,t,r){return r?4294967296*t+(e>>>0):4294967296*(t>>>0)+(e>>>0)}function u(e,t,r){var n=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));r.realloc(n);for(var i=r.pos-1;i>=e;i--)r.buf[i+n]=r.buf[i]}function c(e,t){for(var r=0;r<e.length;r++)t.writeVarint(e[r])}function l(e,t){for(var r=0;r<e.length;r++)t.writeSVarint(e[r])}function f(e,t){for(var r=0;r<e.length;r++)t.writeFloat(e[r])}function h(e,t){for(var r=0;r<e.length;r++)t.writeDouble(e[r])}function p(e,t){for(var r=0;r<e.length;r++)t.writeBoolean(e[r])}function d(e,t){for(var r=0;r<e.length;r++)t.writeFixed32(e[r])}function y(e,t){for(var r=0;r<e.length;r++)t.writeSFixed32(e[r])}function v(e,t){for(var r=0;r<e.length;r++)t.writeFixed64(e[r])}function g(e,t){for(var r=0;r<e.length;r++)t.writeSFixed64(e[r])}function m(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+16777216*e[t+3]}function b(e,t,r){e[r]=t,e[r+1]=t>>>8,e[r+2]=t>>>16,e[r+3]=t>>>24}function w(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}i.prototype={destroy:function(){this.buf=null},readFields:function(e,t,r){for(r=r||this.length;this.pos<r;){var n=this.readVarint(),i=n>>3,o=this.pos;this.type=7&n,e(i,t,this),this.pos===o&&this.skip(n)}return t},readMessage:function(e,t){return this.readFields(e,t,this.readVarint()+this.pos)},readFixed32:function(){var e=m(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=w(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=m(this.buf,this.pos)+4294967296*m(this.buf,this.pos+4);return this.pos+=8,e},readSFixed64:function(){var e=m(this.buf,this.pos)+4294967296*w(this.buf,this.pos+4);return this.pos+=8,e},readFloat:function(){var e=n.read(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=n.read(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(e){var t,r,n=this.buf;return t=127&(r=n[this.pos++]),r<128?t:(t|=(127&(r=n[this.pos++]))<<7,r<128?t:(t|=(127&(r=n[this.pos++]))<<14,r<128?t:(t|=(127&(r=n[this.pos++]))<<21,r<128?t:function(e,t,r){var n,i,o=r.buf;if(i=o[r.pos++],n=(112&i)>>4,i<128)return s(e,n,t);if(i=o[r.pos++],n|=(127&i)<<3,i<128)return s(e,n,t);if(i=o[r.pos++],n|=(127&i)<<10,i<128)return s(e,n,t);if(i=o[r.pos++],n|=(127&i)<<17,i<128)return s(e,n,t);if(i=o[r.pos++],n|=(127&i)<<24,i<128)return s(e,n,t);if(i=o[r.pos++],n|=(1&i)<<31,i<128)return s(e,n,t);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(r=n[this.pos]))<<28,e,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2==1?(e+1)/-2:e/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var e=this.readVarint()+this.pos,t=this.pos;return this.pos=e,e-t>=12&&o?function(e,t,r){return o.decode(e.subarray(t,r))}(this.buf,t,e):function(e,t,r){var n="",i=t;for(;i<r;){var o,a,s,u=e[i],c=null,l=u>239?4:u>223?3:u>191?2:1;if(i+l>r)break;1===l?u<128&&(c=u):2===l?128==(192&(o=e[i+1]))&&(c=(31&u)<<6|63&o)<=127&&(c=null):3===l?(o=e[i+1],a=e[i+2],128==(192&o)&&128==(192&a)&&((c=(15&u)<<12|(63&o)<<6|63&a)<=2047||c>=55296&&c<=57343)&&(c=null)):4===l&&(o=e[i+1],a=e[i+2],s=e[i+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&((c=(15&u)<<18|(63&o)<<12|(63&a)<<6|63&s)<=65535||c>=1114112)&&(c=null)),null===c?(c=65533,l=1):c>65535&&(c-=65536,n+=String.fromCharCode(c>>>10&1023|55296),c=56320|1023&c),n+=String.fromCharCode(c),i+=l}return n}(this.buf,t,e)},readBytes:function(){var e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);return this.pos=e,t},readPackedVarint:function(e,t){if(this.type!==i.Bytes)return e.push(this.readVarint(t));var r=a(this);for(e=e||[];this.pos<r;)e.push(this.readVarint(t));return e},readPackedSVarint:function(e){if(this.type!==i.Bytes)return e.push(this.readSVarint());var t=a(this);for(e=e||[];this.pos<t;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){if(this.type!==i.Bytes)return e.push(this.readBoolean());var t=a(this);for(e=e||[];this.pos<t;)e.push(this.readBoolean());return e},readPackedFloat:function(e){if(this.type!==i.Bytes)return e.push(this.readFloat());var t=a(this);for(e=e||[];this.pos<t;)e.push(this.readFloat());return e},readPackedDouble:function(e){if(this.type!==i.Bytes)return e.push(this.readDouble());var t=a(this);for(e=e||[];this.pos<t;)e.push(this.readDouble());return e},readPackedFixed32:function(e){if(this.type!==i.Bytes)return e.push(this.readFixed32());var t=a(this);for(e=e||[];this.pos<t;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){if(this.type!==i.Bytes)return e.push(this.readSFixed32());var t=a(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){if(this.type!==i.Bytes)return e.push(this.readFixed64());var t=a(this);for(e=e||[];this.pos<t;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){if(this.type!==i.Bytes)return e.push(this.readSFixed64());var t=a(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed64());return e},skip:function(e){var t=7&e;if(t===i.Varint)for(;this.buf[this.pos++]>127;);else if(t===i.Bytes)this.pos=this.readVarint()+this.pos;else if(t===i.Fixed32)this.pos+=4;else{if(t!==i.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(e,t){this.writeVarint(e<<3|t)},realloc:function(e){for(var t=this.length||16;t<this.pos+e;)t*=2;if(t!==this.length){var r=new Uint8Array(t);r.set(this.buf),this.buf=r,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),b(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),b(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),b(this.buf,-1&e,this.pos),b(this.buf,Math.floor(e*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),b(this.buf,-1&e,this.pos),b(this.buf,Math.floor(e*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(e){(e=+e||0)>268435455||e<0?function(e,t){var r,n;e>=0?(r=e%4294967296|0,n=e/4294967296|0):(n=~(-e/4294967296),4294967295^(r=~(-e%4294967296))?r=r+1|0:(r=0,n=n+1|0));if(e>=0x10000000000000000||e<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");t.realloc(10),function(e,t,r){r.buf[r.pos++]=127&e|128,e>>>=7,r.buf[r.pos++]=127&e|128,e>>>=7,r.buf[r.pos++]=127&e|128,e>>>=7,r.buf[r.pos++]=127&e|128,e>>>=7,r.buf[r.pos]=127&e}(r,0,t),function(e,t){var r=(7&e)<<4;if(t.buf[t.pos++]|=r|((e>>>=3)?128:0),!e)return;if(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),!e)return;if(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),!e)return;if(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),!e)return;if(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),!e)return;t.buf[t.pos++]=127&e}(n,t)}(e,this):(this.realloc(4),this.buf[this.pos++]=127&e|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=e>>>7&127))))},writeSVarint:function(e){this.writeVarint(e<0?2*-e-1:2*e)},writeBoolean:function(e){this.writeVarint(Boolean(e))},writeString:function(e){e=String(e),this.realloc(4*e.length),this.pos++;var t=this.pos;this.pos=function(e,t,r){for(var n,i,o=0;o<t.length;o++){if((n=t.charCodeAt(o))>55295&&n<57344){if(!i){n>56319||o+1===t.length?(e[r++]=239,e[r++]=191,e[r++]=189):i=n;continue}if(n<56320){e[r++]=239,e[r++]=191,e[r++]=189,i=n;continue}n=i-55296<<10|n-56320|65536,i=null}else i&&(e[r++]=239,e[r++]=191,e[r++]=189,i=null);n<128?e[r++]=n:(n<2048?e[r++]=n>>6|192:(n<65536?e[r++]=n>>12|224:(e[r++]=n>>18|240,e[r++]=n>>12&63|128),e[r++]=n>>6&63|128),e[r++]=63&n|128)}return r}(this.buf,e,this.pos);var r=this.pos-t;r>=128&&u(t,r,this),this.pos=t-1,this.writeVarint(r),this.pos+=r},writeFloat:function(e){this.realloc(4),n.write(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),n.write(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(e){var t=e.length;this.writeVarint(t),this.realloc(t);for(var r=0;r<t;r++)this.buf[this.pos++]=e[r]},writeRawMessage:function(e,t){this.pos++;var r=this.pos;e(t,this);var n=this.pos-r;n>=128&&u(r,n,this),this.pos=r-1,this.writeVarint(n),this.pos+=n},writeMessage:function(e,t,r){this.writeTag(e,i.Bytes),this.writeRawMessage(t,r)},writePackedVarint:function(e,t){t.length&&this.writeMessage(e,c,t)},writePackedSVarint:function(e,t){t.length&&this.writeMessage(e,l,t)},writePackedBoolean:function(e,t){t.length&&this.writeMessage(e,p,t)},writePackedFloat:function(e,t){t.length&&this.writeMessage(e,f,t)},writePackedDouble:function(e,t){t.length&&this.writeMessage(e,h,t)},writePackedFixed32:function(e,t){t.length&&this.writeMessage(e,d,t)},writePackedSFixed32:function(e,t){t.length&&this.writeMessage(e,y,t)},writePackedFixed64:function(e,t){t.length&&this.writeMessage(e,v,t)},writePackedSFixed64:function(e,t){t.length&&this.writeMessage(e,g,t)},writeBytesField:function(e,t){this.writeTag(e,i.Bytes),this.writeBytes(t)},writeFixed32Field:function(e,t){this.writeTag(e,i.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(e,t){this.writeTag(e,i.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(e,t){this.writeTag(e,i.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(e,t){this.writeTag(e,i.Fixed64),this.writeSFixed64(t)},writeVarintField:function(e,t){this.writeTag(e,i.Varint),this.writeVarint(t)},writeSVarintField:function(e,t){this.writeTag(e,i.Varint),this.writeSVarint(t)},writeStringField:function(e,t){this.writeTag(e,i.Bytes),this.writeString(t)},writeFloatField:function(e,t){this.writeTag(e,i.Fixed32),this.writeFloat(t)},writeDoubleField:function(e,t){this.writeTag(e,i.Fixed64),this.writeDouble(t)},writeBooleanField:function(e,t){this.writeVarintField(e,Boolean(t))}}},function(e,t,r){"use strict";function n(e,t){this.x=e,this.y=t}e.exports=n,n.prototype={clone:function(){return new n(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,t){return this.clone()._rotateAround(e,t)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var t=e.x-this.x,r=e.y-this.y;return t*t+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult:function(e){var t=e[0]*this.x+e[1]*this.y,r=e[2]*this.x+e[3]*this.y;return this.x=t,this.y=r,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var t=Math.cos(e),r=Math.sin(e),n=t*this.x-r*this.y,i=r*this.x+t*this.y;return this.x=n,this.y=i,this},_rotateAround:function(e,t){var r=Math.cos(e),n=Math.sin(e),i=t.x+r*(this.x-t.x)-n*(this.y-t.y),o=t.y+n*(this.x-t.x)+r*(this.y-t.y);return this.x=i,this.y=o,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},n.convert=function(e){return e instanceof n?e:Array.isArray(e)?new n(e[0],e[1]):e}},,,,,,,,function(e,t,r){var n=r(49),i=("undefined"==typeof window?global:window).deck||{};if(!i.LineLayer)throw new Error("@deck.gl/layers is not found");e.exports=Object.assign(i,n)},function(e,t){function r(t,n){return e.exports=r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},r(t,n)}e.exports=r},function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}},function(e,t){e.exports=function(e){if(Array.isArray(e))return e}},function(e,t){e.exports=function(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var r=[],n=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){i=!0,o=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw o}}return r}}},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}},function(e,t){e.exports=function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}},function(e,t){e.exports=function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}},function(e,t,r){var n=function(e){"use strict";var t=Object.prototype,r=t.hasOwnProperty,n="function"==typeof Symbol?Symbol:{},i=n.iterator||"@@iterator",o=n.asyncIterator||"@@asyncIterator",a=n.toStringTag||"@@toStringTag";function s(e,t,r,n){var i=t&&t.prototype instanceof l?t:l,o=Object.create(i.prototype),a=new k(n||[]);return o._invoke=function(e,t,r){var n="suspendedStart";return function(i,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw o;return O()}for(r.method=i,r.arg=o;;){var a=r.delegate;if(a){var s=b(a,r);if(s){if(s===c)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=u(e,t,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===c)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}(e,r,a),o}function u(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=s;var c={};function l(){}function f(){}function h(){}var p={};p[i]=function(){return this};var d=Object.getPrototypeOf,y=d&&d(d(_([])));y&&y!==t&&r.call(y,i)&&(p=y);var v=h.prototype=l.prototype=Object.create(p);function g(e){["next","throw","return"].forEach((function(t){e[t]=function(e){return this._invoke(t,e)}}))}function m(e){var t;this._invoke=function(n,i){function o(){return new Promise((function(t,o){!function t(n,i,o,a){var s=u(e[n],e,i);if("throw"!==s.type){var c=s.arg,l=c.value;return l&&"object"==typeof l&&r.call(l,"__await")?Promise.resolve(l.__await).then((function(e){t("next",e,o,a)}),(function(e){t("throw",e,o,a)})):Promise.resolve(l).then((function(e){c.value=e,o(c)}),(function(e){return t("throw",e,o,a)}))}a(s.arg)}(n,i,t,o)}))}return t=t?t.then(o,o):o()}}function b(e,t){var r=e.iterator[t.method];if(void 0===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,b(e,t),"throw"===t.method))return c;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return c}var n=u(r,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,c;var i=n.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,c):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,c)}function w(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function x(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(w,this),this.reset(!0)}function _(e){if(e){var t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,o=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:O}}function O(){return{value:void 0,done:!0}}return f.prototype=v.constructor=h,h.constructor=f,h[a]=f.displayName="GeneratorFunction",e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,h):(e.__proto__=h,a in e||(e[a]="GeneratorFunction")),e.prototype=Object.create(v),e},e.awrap=function(e){return{__await:e}},g(m.prototype),m.prototype[o]=function(){return this},e.AsyncIterator=m,e.async=function(t,r,n,i){var o=new m(s(t,r,n,i));return e.isGeneratorFunction(r)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},g(v),v[a]="Generator",v[i]=function(){return this},v.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},e.values=_,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(x),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return a.type="throw",a.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var s=r.call(o,"catchLoc"),u=r.call(o,"finallyLoc");if(s&&u){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,c):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),c},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),x(r),c}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;x(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:_(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),c}},e}(e.exports);try{regeneratorRuntime=n}catch(e){Function("r","regeneratorRuntime = r")(n)}},function(e,t,r){var n=r(2);e.exports=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=n(e)););return e}},function(e,t){t.read=function(e,t,r,n,i){var o,a,s=8*i-n-1,u=(1<<s)-1,c=u>>1,l=-7,f=r?i-1:0,h=r?-1:1,p=e[t+f];for(f+=h,o=p&(1<<-l)-1,p>>=-l,l+=s;l>0;o=256*o+e[t+f],f+=h,l-=8);for(a=o&(1<<-l)-1,o>>=-l,l+=n;l>0;a=256*a+e[t+f],f+=h,l-=8);if(0===o)o=1-c;else{if(o===u)return a?NaN:1/0*(p?-1:1);a+=Math.pow(2,n),o-=c}return(p?-1:1)*a*Math.pow(2,o-n)},t.write=function(e,t,r,n,i,o){var a,s,u,c=8*o-i-1,l=(1<<c)-1,f=l>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:o-1,d=n?1:-1,y=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=l):(a=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-a))<1&&(a--,u*=2),(t+=a+f>=1?h/u:h*Math.pow(2,1-f))*u>=2&&(a++,u/=2),a+f>=l?(s=0,a=l):a+f>=1?(s=(t*u-1)*Math.pow(2,i),a+=f):(s=t*Math.pow(2,f-1)*Math.pow(2,i),a=0));i>=8;e[r+p]=255&s,p+=d,s/=256,i-=8);for(a=a<<i|s,c+=i;c>0;e[r+p]=255&a,p+=d,a/=256,c-=8);e[r+p-d]|=128*y}},function(e,t,r){"use strict";r.r(t);var n={};r.r(n),r.d(n,"dirname",(function(){return ts}));var i={};r.r(i),r.d(i,"decode",(function(){return Ql})),r.d(i,"encode",(function(){return Yl}));var o={};r.r(o),r.d(o,"decode",(function(){return of})),r.d(o,"encode",(function(){return af}));var a={};r.r(a),r.d(a,"decode",(function(){return cf})),r.d(a,"encode",(function(){return lf}));var s={};r.r(s),r.d(s,"decode",(function(){return pf})),r.d(s,"encode",(function(){return df}));var u=r(3),c=r.n(u),l=r(6),f=r.n(l),h=r(7),p=r.n(h),d=r(2),y=r.n(d),v=r(1);function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return p()(this,r)}}var m=function(e){f()(r,e);var t=g(r);function r(){return c()(this,r),t.apply(this,arguments)}return r}(v.ArcLayer);m.layerName="GreatCircleLayer",m.defaultProps={getHeight:{type:"accessor",value:0},greatCircle:!0};var b=r(4),w=r.n(b),x=r(5),k=r.n(x),_=r(14),O=r.n(_),T=180/Math.PI;function S(e,t,r){var n=1<<t;return[(e[0]+r[0])/n,(e[1]+r[1])/n]}function A(e){return e>=.5?1/3*(4*e*e-1):1/3*(1-4*(1-e)*(1-e))}function P(e){return[A(e[0]),A(e[1])]}function E(e,t){var r=k()(t,2),n=r[0],i=r[1];switch(e){case 0:return[1,n,i];case 1:return[-n,1,i];case 2:return[-n,-i,1];case 3:return[-1,-i,-n];case 4:return[i,-1,-n];case 5:return[i,n,-1];default:throw new Error("Invalid face")}}function M(e,t,r,n){if(0===n){1===r&&(t[0]=e-1-t[0],t[1]=e-1-t[1]);var i=t[0];t[0]=t[1],t[1]=i}}function j(e){if("string"==typeof e){if(e.indexOf("/")>0)return e;e=function(e){var t=e.padEnd(16,"0");return O.a.fromString(t,16)}(e)}return function(e){for(var t=O.a.fromString(e,!0,10).toString(2);t.length<64;)t="0"+t;for(var r=t.lastIndexOf("1"),n=t.substring(0,3),i=t.substring(3,r),o=i.length/2,a=O.a.fromString(n,!0,2).toString(10),s=O.a.fromString(i,!0,2).toString(4);s.length<o;)s="0"+s;return"".concat(a,"/").concat(s)}(e.toString())}function I(e){return function(e){for(var t,r,n,i,o,a,s=e.face,u=e.ij,c=e.level,l=[[0,0],[0,1],[1,1],[1,0],[0,0]],f=Math.max(1,Math.ceil(100*Math.pow(2,-c))),h=new Float64Array(4*f*2+2),p=0,d=0,y=0;y<4;y++)for(var v=l[y].slice(0),g=l[y+1],m=(g[0]-v[0])/f,b=(g[1]-v[1])/f,w=0;w<f;w++){v[0]+=m,v[1]+=b;var x=E(s,P(S(u,c,v))),_=(t=x,r=void 0,n=void 0,i=void 0,o=void 0,a=void 0,r=k()(t,3),n=r[0],i=r[1],o=r[2],a=Math.atan2(o,Math.sqrt(n*n+i*i)),[Math.atan2(i,n)*T,a*T]);Math.abs(_[1])>89.999&&(_[0]=d);var O=_[0]-d;_[0]+=O>180?-360:O<-180?360:0,h[p++]=_[0],h[p++]=_[1],d=_[0]}return h[p++]=h[0],h[p++]=h[1],h}(function(e){for(var t,r=e.split("/"),n=parseInt(r[0],10),i=r[1],o=i.length,a=[0,0],s=o-1;s>=0;s--){t=o-s;var u=i[s],c=0,l=0;"1"===u?l=1:"2"===u?(c=1,l=1):"3"===u&&(c=1);var f=Math.pow(2,t-1);M(f,a,c,l),a[0]+=f*c,a[1]+=f*l}if(n%2==1){var h=a[0];a[0]=a[1],a[1]=h}return{face:n,ij:a,level:t}}(j(e)))}function L(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return p()(this,r)}}var R=Object.assign({getS2Token:{type:"accessor",value:function(e){return e.token}}},v.PolygonLayer.defaultProps),C=function(e){f()(r,e);var t=L(r);function r(){return c()(this,r),t.apply(this,arguments)}return w()(r,[{key:"renderLayers",value:function(){var e=this.props,t=e.data,r=e.getS2Token,n=this.props,i=n.elevationScale,o=n.extruded,a=n.wireframe,s=n.filled,u=n.stroked,c=n.lineWidthUnits,l=n.lineWidthScale,f=n.lineWidthMinPixels,h=n.lineWidthMaxPixels,p=n.lineJointRounded,d=n.lineMiterLimit,y=n.lineDashJustified,g=n.getElevation,m=n.getFillColor,b=n.getLineColor,w=n.getLineWidth,x=n.getLineDashArray,k=this.props,_=k.updateTriggers,O=k.material;return new(this.getSubLayerClass("cell",v.PolygonLayer))({filled:s,wireframe:a,extruded:o,elevationScale:i,stroked:u,lineWidthUnits:c,lineWidthScale:l,lineWidthMinPixels:f,lineWidthMaxPixels:h,lineJointRounded:p,lineMiterLimit:d,lineDashJustified:y,material:O,getElevation:g,getFillColor:m,getLineColor:b,getLineWidth:w,getLineDashArray:x},this.getSubLayerProps({id:"cell",updateTriggers:{getElevation:_.getElevation,getFillColor:_.getFillColor,getLineColor:_.getLineColor,getLineWidth:_.getLineWidth,getLineDashArray:_.getLineDashArray}}),{data:t,_normalize:!1,positionFormat:"XY",getPolygon:function(e,t){return I(r(e,t))}})}}]),r}(v.CompositeLayer);C.layerName="S2Layer",C.defaultProps=R;var N=r(10),D=r.n(N),U=r(0),F=r.n(U);function B(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function V(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function a(e){B(o,n,i,a,s,"next",e)}function s(e){B(o,n,i,a,s,"throw",e)}a(void 0)}))}}function z(e){return(z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var q=function(e){return"boolean"==typeof e},G=function(e){return"function"==typeof e},W=function(e){return null!==e&&"object"===z(e)},H=function(e){return W(e)&&e.constructor==={}.constructor},Z=function(e){return e&&"function"==typeof e[Symbol.iterator]},Q=function(e){return e&&"function"==typeof e[Symbol.asyncIterator]},K=function(e){return"undefined"!=typeof Response&&e instanceof Response||e&&e.arrayBuffer&&e.text&&e.json},Y=function(e){return"undefined"!=typeof Blob&&e instanceof Blob},J=function(e){return function(e){return"undefined"!=typeof ReadableStream&&e instanceof ReadableStream||W(e)&&G(e.tee)&&G(e.cancel)&&G(e.getReader)}(e)||function(e){return W(e)&&G(e.read)&&G(e.pipe)&&q(e.readable)}(e)};function $(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function X(e,t){if(!e)throw new Error(t||"loader assertion failed.")}function ee(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function te(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ee(Object(r),!0).forEach((function(t){$(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ee(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function re(e){if(!e)return!1;Array.isArray(e)&&(e=e[0]);var t=e.parseTextSync||e.parseSync||e.parse||e.parseStream||e.parseInBatches,r=e.options&&e.options[e.id];return t=t||r&&r.workerUrl}function ne(e){var t;return X(e,"null loader"),X(re(e),"invalid loader"),Array.isArray(e)&&(t=e[1],e=te(te({},e=e[0]),{},{options:te(te({},e.options),t)})),e.extension&&(e.extensions=e.extensions||e.extension,delete e.extension),Array.isArray(e.extensions)||(e.extensions=[e.extensions]),X(e.extensions&&e.extensions.length>0&&e.extensions[0]),(e.parseTextSync||e.parseText)&&(e.text=!0),e.text||(e.binary=!0),e}var ie={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:"undefined"!=typeof global&&global,document:"undefined"!=typeof document&&document},oe=ie.global||ie.self||ie.window,ae="object"!==("undefined"==typeof process?"undefined":z(process))||"[object process]"!==String(process)||process.browser,se="function"==typeof importScripts,ue="undefined"!=typeof process&&process.version&&process.version.match(/v([0-9]*)/),ce=ue&&parseFloat(ue[1])||0,le="",fe={};function he(e){for(var t in fe)if(e.startsWith(t)){var r=fe[t];e=e.replace(t,r)}return e.startsWith("http://")||e.startsWith("https://")||(e="".concat(le).concat(e)),e}var pe=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,de=/^([-\w.]+\/[-\w.+]+)/;function ye(e){if("string"!=typeof e)return"";var t=e.match(pe);return t?t[1]:""}var ve=/\?.*/;function ge(e){if(K(e)){var t=function(e){if("string"!=typeof e)return"";var t=e.match(de);return t?t[1]:e}(e.headers.get("content-type")),r=ye(e.url);return{url:be(e.url||""),type:t||r||null}}return Y(e)?{url:be(e.name||""),type:e.type||""}:"string"==typeof e?{url:be(e),type:ye(e)}:{url:"",type:""}}function me(e){return K(e)?e.headers["content-length"]||-1:Y(e)?e.size:"string"==typeof e?e.length:e instanceof ArrayBuffer?e.byteLength:ArrayBuffer.isView(e)?e.byteLength:-1}function be(e){return e.replace(ve,"")}function we(e){return xe.apply(this,arguments)}function xe(){return(xe=V(F.a.mark((function e(t){var r,n,i,o,a,s,u;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!K(t)){e.next=2;break}return e.abrupt("return",t);case 2:return r={},(n=me(t))>=0&&(r["content-length"]=String(n)),i=ge(t),o=i.url,(a=i.type)&&(r["content-type"]=a),e.next=9,Se(t);case 9:return(s=e.sent)&&(r["x-first-bytes"]=s),"string"==typeof t&&(t=(new TextEncoder).encode(t)),u=new Response(t,{headers:r}),Object.defineProperty(u,"url",{value:o}),e.abrupt("return",u);case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ke(e){return _e.apply(this,arguments)}function _e(){return(_e=V(F.a.mark((function e(t){var r;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.ok){e.next=5;break}return e.next=3,Oe(t);case 3:throw r=e.sent,new Error(r);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Oe(e){return Te.apply(this,arguments)}function Te(){return(Te=V(F.a.mark((function e(t){var r,n,i;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r="Failed to fetch resource ".concat(t.url," (").concat(t.status,"): "),e.prev=1,n=t.headers.get("Content-Type"),i=t.statusText,!n.includes("application/json")){e.next=11;break}return e.t0=i,e.t1=" ",e.next=9,t.text();case 9:e.t2=e.sent,i=e.t0+=e.t1.concat.call(e.t1,e.t2);case 11:r=(r+=i).length>60?"".concat(r.slice(60),"..."):r,e.next=17;break;case 15:e.prev=15,e.t3=e.catch(1);case 17:return e.abrupt("return",r);case 18:case"end":return e.stop()}}),e,null,[[1,15]])})))).apply(this,arguments)}function Se(e){return Ae.apply(this,arguments)}function Ae(){return(Ae=V(F.a.mark((function e(t){var r,n,i,o;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=5,"string"!=typeof t){e.next=3;break}return e.abrupt("return","data:,".concat(t.slice(0,r)));case 3:if(!(t instanceof Blob)){e.next=8;break}return n=t.slice(0,5),e.next=7,new Promise((function(e){var t=new FileReader;t.onload=function(t){return e(t.target&&t.target.result)},t.readAsDataURL(n)}));case 7:return e.abrupt("return",e.sent);case 8:if(!(t instanceof ArrayBuffer)){e.next=12;break}return i=t.slice(0,r),o=Pe(i),e.abrupt("return","data:base64,".concat(o));case 12:return e.abrupt("return",null);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Pe(e){for(var t="",r=new Uint8Array(e),n=0;n<r.byteLength;n++)t+=String.fromCharCode(r[n]);return btoa(t)}function Ee(e){return Me.apply(this,arguments)}function Me(){return(Me=V(F.a.mark((function e(t){var r;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r="Failed to fetch resource ".concat(t.url," (").concat(t.status,"): "),e.prev=1,!t.headers.get("Content-Type").includes("application/json")){e.next=10;break}return e.t0=r,e.next=7,t.text();case 7:r=e.t0+=e.sent,e.next=11;break;case 10:r+=t.statusText;case 11:e.next=16;break;case 13:return e.prev=13,e.t1=e.catch(1),e.abrupt("return",r);case 16:return e.abrupt("return",r);case 17:case"end":return e.stop()}}),e,null,[[1,13]])})))).apply(this,arguments)}function je(e){return Ie.apply(this,arguments)}function Ie(){return(Ie=V(F.a.mark((function e(t){var r,n,i=arguments;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=i.length>1&&void 0!==i[1]?i[1]:{},"string"==typeof t){e.next=5;break}return e.next=4,we(t);case 4:return e.abrupt("return",e.sent);case 5:return t=he(t),e.next=8,fetch(t,r);case 8:if((n=e.sent).ok||!r.throws){e.next=15;break}return e.t0=Error,e.next=13,Ee(n);case 13:throw e.t1=e.sent,new e.t0(e.t1);case 15:return e.abrupt("return",n);case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Le(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Re(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ce(e,t,r){return t&&Re(e.prototype,t),r&&Re(e,r),e}var Ne=function(){function e(){Le(this,e)}return Ce(e,[{key:"log",value:function(){return function(e){}}},{key:"info",value:function(){return function(e){}}},{key:"warn",value:function(){return function(e){}}},{key:"error",value:function(){return function(e){}}}]),e}();function De(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return Ue(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ue(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function Ue(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Fe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Be(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Fe(Object(r),!0).forEach((function(t){$(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Fe(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Ve={baseUri:"",fetch:null,CDN:"https://unpkg.com/@loaders.gl",worker:!0,log:new(function(){function e(){Le(this,e),this.console=console}return Ce(e,[{key:"log",value:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.console.log).bind.apply(e,[this.console].concat(r))}},{key:"info",value:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.console.info).bind.apply(e,[this.console].concat(r))}},{key:"warn",value:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.console.warn).bind.apply(e,[this.console].concat(r))}},{key:"error",value:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.console.error).bind.apply(e,[this.console].concat(r))}}]),e}()),metadata:!1,transforms:[],reuseWorkers:!0},ze={dataType:"(no longer used)",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"},qe=function(){oe.loaders=oe.loaders||{};var e=oe.loaders;return e._state=e._state||{},e._state},Ge=function(){var e=qe();return e.globalOptions=e.globalOptions||Be({},Ve),e.globalOptions};function We(e,t,r,n){return r=r||[],function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console;Ze(e,null,r,Ve,ze,t);var n,i=De(t);try{for(i.s();!(n=i.n()).done;){var o=n.value,a=e&&e[o.id]||{},s=o.options&&o.options[o.id]||{},u=o.defaultOptions&&o.defaultOptions[o.id]||{};Ze(a,o.id,r,s,u,t)}}catch(e){i.e(e)}finally{i.f()}}(e,r=Array.isArray(r)?r:[r]),Ke(t,e,n)}function He(e,t){var r=Ge(),n=e.fetch||r.fetch;return"function"==typeof n?n:W(n)?function(e){return je(e,n)}:t&&t.fetch?t.fetch:function(t){return je(t,e)}}function Ze(e,t,r,n,i,o){var a=t||"Top level",s=t?"".concat(t,"."):"";for(var u in e){var c=!t&&W(e[u]);if(!(u in n))if(u in i)r.warn("".concat(a," loader option '").concat(s).concat(u,"' deprecated, use '").concat(i[u],"'"));else if(!c){var l=Qe(u,o);r.warn("".concat(a," loader option '").concat(s).concat(u,"' not recognized. ").concat(l))}}}function Qe(e,t){var r,n=e.toLowerCase(),i="",o=De(t);try{for(o.s();!(r=o.n()).done;){var a=r.value;for(var s in a.options){if(e===s)return"Did you mean '".concat(a.id,".").concat(s,"'?");var u=s.toLowerCase();(n.startsWith(u)||u.startsWith(n))&&(i=i||"Did you mean '".concat(a.id,".").concat(s,"'?"))}}}catch(e){o.e(e)}finally{o.f()}return i}function Ke(e,t,r){var n=Be({},e.options||{});return null===n.log&&(n.log=new Ne),Ye(n,Ge()),Ye(n,t),function(e,t){t&&!e.baseUri&&(e.baseUri=t)}(n,r),n}function Ye(e,t){for(var r in t)if(r in t){var n=t[r];H(n)&&H(e[r])?e[r]=Be(Be({},e[r]),t[r]):e[r]=t[r]}}function Je(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"2.3.13";X(e,"no loader provided");var r=e.version;t&&r&&(t=$e(t),r=$e(r))}function $e(e){var t=e.split(".").map(Number);return{major:t[0],minor:t[1]}}function Xe(e){var t;if("undefined"!=typeof Symbol){if(Symbol.asyncIterator&&null!=(t=e[Symbol.asyncIterator]))return t.call(e);if(Symbol.iterator&&null!=(t=e[Symbol.iterator]))return t.call(e)}throw new TypeError("Object is not async iterable")}var et=r(24);function tt(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return rt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return rt(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function rt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function nt(e){if(et.toArrayBuffer&&(e=et.toArrayBuffer(e)),e instanceof ArrayBuffer)return e;if(ArrayBuffer.isView(e))return e.buffer;if("string"==typeof e){var t=e;return(new TextEncoder).encode(t).buffer}return e&&"object"===z(e)&&e._toArrayBuffer?e._toArrayBuffer():X(!1)}function it(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n,i=t.map((function(e){return e instanceof ArrayBuffer?new Uint8Array(e):e})),o=i.reduce((function(e,t){return e+t.byteLength}),0),a=new Uint8Array(o),s=0,u=tt(i);try{for(u.s();!(n=u.n()).done;){var c=n.value;a.set(c,s),s+=c.byteLength}}catch(e){u.e(e)}finally{u.f()}return a.buffer}function ot(e){return at.apply(this,arguments)}function at(){return(at=V(F.a.mark((function e(t){var r,n,i,o,a,s,u,c,l;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=[],n=[],i=!0,o=!1,e.prev=4,s=Xe(t);case 6:return e.next=8,s.next();case 8:return u=e.sent,i=u.done,e.next=12,u.value;case 12:if(c=e.sent,i){e.next=19;break}"string"==typeof(l=c)?n.push(l):r.push(l);case 16:i=!0,e.next=6;break;case 19:e.next=25;break;case 21:e.prev=21,e.t0=e.catch(4),o=!0,a=e.t0;case 25:if(e.prev=25,e.prev=26,i||null==s.return){e.next=30;break}return e.next=30,s.return();case 30:if(e.prev=30,!o){e.next=33;break}throw a;case 33:return e.finish(30);case 34:return e.finish(25);case 35:if(!(n.length>0)){e.next=38;break}return X(0===r.length),e.abrupt("return",n.join(""));case 38:return e.abrupt("return",it.apply(void 0,r));case 39:case"end":return e.stop()}}),e,null,[[4,21,25,35],[26,,30,34]])})))).apply(this,arguments)}var st=F.a.mark(ut);function ut(e){var t,r,n,i,o,a,s,u=arguments;return F.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:t=u.length>1&&void 0!==u[1]?u[1]:{},r=t.chunkSize,n=void 0===r?262144:r,i=0,o=new TextEncoder;case 4:if(!(i<e.length)){c.next=12;break}return a=Math.min(e.length-i,n),s=e.slice(i,i+a),i+=a,c.next=10,o.encode(s);case 10:c.next=4;break;case 12:case"end":return c.stop()}}),st)}var ct=F.a.mark(lt);function lt(e){var t,r,n,i,o,a,s,u=arguments;return F.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:t=u.length>1&&void 0!==u[1]?u[1]:{},r=t.chunkSize,n=void 0===r?262144:r,i=0;case 3:if(!(i<e.byteLength)){c.next=14;break}return o=Math.min(e.byteLength-i,n),a=new ArrayBuffer(o),s=new Uint8Array(e,i,o),new Uint8Array(a).set(s),i+=o,c.next=12,a;case 12:c.next=3;break;case 14:case"end":return c.stop()}}),ct)}function ft(e){this.wrapped=e}function ht(e){return new ft(e)}function pt(e){var t,r;function n(t,r){try{var o=e[t](r),a=o.value,s=a instanceof ft;Promise.resolve(s?a.wrapped:a).then((function(e){s?n("return"===t?"return":"next",e):i(o.done?"return":"normal",e)}),(function(e){n("throw",e)}))}catch(e){i("throw",e)}}function i(e,i){switch(e){case"return":t.resolve({value:i,done:!0});break;case"throw":t.reject(i);break;default:t.resolve({value:i,done:!1})}(t=t.next)?n(t.key,t.arg):r=null}this._invoke=function(e,i){return new Promise((function(o,a){var s={key:e,arg:i,resolve:o,reject:a,next:null};r?r=r.next=s:(t=r=s,n(e,i))}))},"function"!=typeof e.return&&(this.return=void 0)}function dt(e){return function(){return new pt(e.apply(this,arguments))}}"function"==typeof Symbol&&Symbol.asyncIterator&&(pt.prototype[Symbol.asyncIterator]=function(){return this}),pt.prototype.next=function(e){return this._invoke("next",e)},pt.prototype.throw=function(e){return this._invoke("throw",e)},pt.prototype.return=function(e){return this._invoke("return",e)};function yt(e){return vt.apply(this,arguments)}function vt(){return(vt=dt(F.a.mark((function e(t){var r,n,i,o,a,s=arguments;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=s.length>1&&void 0!==s[1]?s[1]:{},n=r.chunkSize||1048576,i=0;case 3:if(!(i<t.size)){e.next=13;break}return o=i+n,e.next=7,ht(gt(t,i,o));case 7:return a=e.sent,i=o,e.next=11,a;case 11:e.next=3;break;case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function gt(e,t,r){return mt.apply(this,arguments)}function mt(){return(mt=V(F.a.mark((function e(t,r,n){return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e,i){var o=t.slice(r,n),a=new FileReader;a.onload=function(t){return e(t.target&&t.target.result)},a.onerror=function(e){return i(e)},a.readAsArrayBuffer(o)}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function bt(e){if(ae||ce>=10){if("function"==typeof e[Symbol.asyncIterator])return function(e){return wt.apply(this,arguments)}(e);if("function"==typeof e.getIterator)return e.getIterator()}return ae?function(e){return xt.apply(this,arguments)}(e):function(e){return kt.apply(this,arguments)}(e)}function wt(){return(wt=dt(F.a.mark((function e(t){var r,n,i,o,a,s,u;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=!0,n=!1,e.prev=2,o=Xe(t);case 4:return e.next=6,ht(o.next());case 6:return a=e.sent,r=a.done,e.next=10,ht(a.value);case 10:if(s=e.sent,r){e.next=18;break}return u=s,e.next=15,nt(u);case 15:r=!0,e.next=4;break;case 18:e.next=24;break;case 20:e.prev=20,e.t0=e.catch(2),n=!0,i=e.t0;case 24:if(e.prev=24,e.prev=25,r||null==o.return){e.next=29;break}return e.next=29,ht(o.return());case 29:if(e.prev=29,!n){e.next=32;break}throw i;case 32:return e.finish(29);case 33:return e.finish(24);case 34:case"end":return e.stop()}}),e,null,[[2,20,24,34],[25,,29,33]])})))).apply(this,arguments)}function xt(){return(xt=dt(F.a.mark((function e(t){var r,n,i,o;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t.getReader(),e.prev=1;case 2:return e.next=5,ht(r.read());case 5:if(n=e.sent,i=n.done,o=n.value,!i){e.next=10;break}return e.abrupt("return");case 10:return e.next=12,nt(o);case 12:e.next=2;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(1),r.releaseLock();case 19:case"end":return e.stop()}}),e,null,[[1,16]])})))).apply(this,arguments)}function kt(){return(kt=dt(F.a.mark((function e(t){var r;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ht(t);case 2:t=e.sent;case 3:if(null===(r=t.read())){e.next=9;break}return e.next=8,nt(r);case 8:return e.abrupt("continue",3);case 9:if(!t._readableState.ended){e.next=11;break}return e.abrupt("return");case 11:return e.next=13,ht(_t(t));case 13:e.next=3;break;case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _t(e){return Ot.apply(this,arguments)}function Ot(){return(Ot=V(F.a.mark((function e(t){return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){t.once("readable",e)})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Tt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"string"==typeof e?ut(e,t):e instanceof ArrayBuffer?lt(e,t):Y(e)?yt(e,t):J(e)?bt(e):K(e)?bt(e.body):X(!1)}var St="Cannot convert supplied data type";function At(e,t){if(t.text&&"string"==typeof e)return e;if(e instanceof ArrayBuffer){var r=e;return t.text&&!t.binary?new TextDecoder("utf8").decode(r):r}if(ArrayBuffer.isView(e)||(o=e)&&"object"===z(o)&&o.isBuffer){if(t.text&&!t.binary)return new TextDecoder("utf8").decode(e);var n=e.buffer,i=e.byteLength||e.length;return 0===e.byteOffset&&i===n.byteLength||(n=n.slice(e.byteOffset,e.byteOffset+i)),n}var o;throw new Error(St)}function Pt(e,t){return Et.apply(this,arguments)}function Et(){return(Et=V(F.a.mark((function e(t,r){var n,i;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t instanceof ArrayBuffer||ArrayBuffer.isView(t),"string"!=typeof t&&!n){e.next=3;break}return e.abrupt("return",At(t,r));case 3:if(!Y(t)){e.next=7;break}return e.next=6,we(t);case 6:t=e.sent;case 7:if(!K(t)){e.next=21;break}return i=t,e.next=11,ke(i);case 11:if(!r.binary){e.next=17;break}return e.next=14,i.arrayBuffer();case 14:e.t0=e.sent,e.next=20;break;case 17:return e.next=19,i.text();case 19:e.t0=e.sent;case 20:return e.abrupt("return",e.t0);case 21:if(J(t)&&(t=Tt(t)),!Z(t)&&!Q(t)){e.next=24;break}return e.abrupt("return",ot(t));case 24:throw new Error(St);case 25:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Mt(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function jt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function It(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?jt(Object(r),!0).forEach((function(t){$(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):jt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Lt(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return r||(e=It({fetch:He(t||{},e)},e),Array.isArray(e.loaders)||(e.loaders=null),e)}function Rt(e,t){if(!t&&e&&!Array.isArray(e))return e;var r;if(e&&(r=Array.isArray(e)?e:[e]),t&&t.loaders){var n=Array.isArray(t.loaders)?t.loaders:[t.loaders];r=r?[].concat(Mt(r),Mt(n)):n}return r&&r.length?r:null}var Ct=new Map;function Nt(e){return"try {\n  importScripts('".concat(e,"');\n} catch (error) {\n  console.error(error);\n}")}function Dt(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2?arguments[2]:void 0,n=r||new Set;if(e){if(Ut(e))n.add(e);else if(Ut(e.buffer))n.add(e.buffer);else if(ArrayBuffer.isView(e));else if(t&&"object"===z(e))for(var i in e)Dt(e[i],t,n)}else;return void 0===r?Array.from(n):[]}function Ut(e){return!!e&&(e instanceof ArrayBuffer||("undefined"!=typeof MessagePort&&e instanceof MessagePort||("undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap||"undefined"!=typeof OffscreenCanvas&&e instanceof OffscreenCanvas)))}var Ft=0;function Bt(e){var t=e.data;(0,e.resolve)(t)}var Vt=function(){function e(t){var r=t.source,n=t.name,i=void 0===n?"web-worker-".concat(Ft++):n,o=t.onMessage;Le(this,e);var a=function(e){if(arguments.length>1&&void 0!==arguments[1]&&arguments[1],X("string"==typeof e,"worker source"),e.startsWith("url(")&&e.endsWith(")")){var t=e.match(/^url\((.*)\)$/)[1];if(t&&!t.startsWith("http"))return t;e=Nt(t)}var r=Ct.get(e);if(!r){var n=new Blob([e],{type:"application/javascript"});r=URL.createObjectURL(n),Ct.set(e,r)}return r}(r,i);this.worker=new Worker(a,{name:i}),this.name=i,this.onMessage=o||Bt}var t;return Ce(e,[{key:"process",value:(t=V(F.a.mark((function e(t){var r=this;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){r.worker.onmessage=function(t){r.onMessage({worker:r.worker,data:t.data,resolve:e,reject:n})},r.worker.onerror=function(e){var t="".concat(r.name,": WorkerThread.process() failed");e.message&&(t+=" ".concat(e.message," ").concat(e.filename,":").concat(e.lineno,":").concat(e.colno));var i=new Error(t);console.error(e),n(i)};var i=Dt(t);r.worker.postMessage(t,i)})));case 1:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})},{key:"destroy",value:function(){this.worker.terminate(),this.worker=null}}]),e}(),zt=function(){function e(t){var r=t.source,n=t.name,i=void 0===n?"unnamed":n,o=t.maxConcurrency,a=void 0===o?1:o,s=t.onMessage,u=t.onDebug,c=void 0===u?function(){}:u,l=t.reuseWorkers,f=void 0===l||l;Le(this,e),this.source=r,this.name=i,this.maxConcurrency=a,this.onMessage=s,this.onDebug=c,this.jobQueue=[],this.idleQueue=[],this.count=0,this.isDestroyed=!1,this.reuseWorkers=f}var t;return Ce(e,[{key:"destroy",value:function(){this.idleQueue.forEach((function(e){return e.destroy()})),this.isDestroyed=!0}},{key:"process",value:function(e,t){var r=this;return new Promise((function(n,i){r.jobQueue.push({data:e,jobName:t,resolve:n,reject:i}),r._startQueuedJob()}))}},{key:"_startQueuedJob",value:(t=V(F.a.mark((function e(){var t,r;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.jobQueue.length){e.next=2;break}return e.abrupt("return");case 2:if(t=this._getAvailableWorker()){e.next=5;break}return e.abrupt("return");case 5:return r=this.jobQueue.shift(),this.onDebug({message:"processing",worker:t.name,job:r.jobName,backlog:this.jobQueue.length}),e.prev=7,e.t0=r,e.next=11,t.process(r.data);case 11:e.t1=e.sent,e.t0.resolve.call(e.t0,e.t1),e.next=18;break;case 15:e.prev=15,e.t2=e.catch(7),r.reject(e.t2);case 18:return e.prev=18,this._onWorkerDone(t),e.finish(18);case 21:case"end":return e.stop()}}),e,this,[[7,15,18,21]])}))),function(){return t.apply(this,arguments)})},{key:"_onWorkerDone",value:function(e){this.isDestroyed?e.destroy():(this.reuseWorkers?this.idleQueue.push(e):(e.destroy(),this.count--),this._startQueuedJob())}},{key:"_getAvailableWorker",value:function(){if(this.idleQueue.length>0)return this.idleQueue.shift();if(this.count<this.maxConcurrency){this.count++;var e="".concat(this.name.toLowerCase()," (#").concat(this.count," of ").concat(this.maxConcurrency,")");return new Vt({source:this.source,onMessage:this.onMessage,name:e})}return null}}]),e}(),qt=function(){function e(t){var r=t.maxConcurrency,n=void 0===r?5:r,i=t.onMessage,o=void 0===i?null:i,a=t.onDebug,s=void 0===a?function(){}:a,u=t.reuseWorkers,c=void 0===u||u;Le(this,e),this.maxConcurrency=n,this.onMessage=o,this.onDebug=s,this.workerPools=new Map,this.reuseWorkers=c}var t;return Ce(e,null,[{key:"isSupported",value:function(){return"undefined"!=typeof Worker}}]),Ce(e,[{key:"setProps",value:function(e){"maxConcurrency"in e&&(this.maxConcurrency=e.maxConcurrency),"onDebug"in e&&(this.onDebug=e.onDebug),"reuseWorkers"in e&&(this.reuseWorkers=e.reuseWorkers)}},{key:"destroy",value:function(){this.workerPools.forEach((function(e){return e.destroy()}))}},{key:"process",value:(t=V(F.a.mark((function e(t,r,n){var i;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this._getWorkerPool(t,r),e.abrupt("return",i.process(n));case 2:case"end":return e.stop()}}),e,this)}))),function(e,r,n){return t.apply(this,arguments)})},{key:"_getWorkerPool",value:function(e,t){var r=this.workerPools.get(t);return r||(r=new zt({source:e,name:t,onMessage:Gt.bind(null,this.onMessage),maxConcurrency:this.maxConcurrency,onDebug:this.onDebug,reuseWorkers:this.reuseWorkers}),this.workerPools.set(t,r)),r}}]),e}();function Gt(e,t){var r=t.worker,n=t.data,i=t.resolve,o=t.reject;if(e)e({worker:r,data:n,resolve:i,reject:o});else switch(n.type){case"done":i(n.result);break;case"error":o(n.message)}}function Wt(e,t,r,n){if(!qt.isSupported())return!1;var i=r&&r[e.id];return!!("local"===r.worker&&i&&i.localWorkerUrl||r.worker&&i&&i.workerUrl)&&(!e.useWorker||e.useWorker(r))}function Ht(e,t,r,n){var i=(r||{}).worker,o=r&&r[e.id]||{},a="local"===i?o.localWorkerUrl:o.workerUrl,s="url(".concat(a,")"),u=e.name,c=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={};e.maxConcurrency&&(t.maxConcurrency=e.maxConcurrency);e.onDebug&&(t.onDebug=e.onDebug);"reuseWorkers"in e&&(t.reuseWorkers=e.reuseWorkers);Zt||(Zt=new qt({onMessage:Qt}));return Zt.setProps(t),Zt}(r);r=JSON.parse(JSON.stringify(r));var l="2.3.13"!==e.version?"(core version ".concat("2.3.13",")"):"";return c.process(s,"".concat(u,"-worker@").concat(e.version).concat(l),{arraybuffer:nt(t),options:r,source:"loaders.gl@".concat("2.3.13"),type:"parse"})}var Zt=null;function Qt(e){return Kt.apply(this,arguments)}function Kt(){return(Kt=V(F.a.mark((function e(t){var r,n,i,o,a;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t.worker,n=t.data,i=t.resolve,o=t.reject,e.t0=n.type,e.next="done"===e.t0?4:"parse"===e.t0?6:"error"===e.t0?17:19;break;case 4:return i(n.result),e.abrupt("break",19);case 6:return e.prev=6,e.next=9,dr(n.arraybuffer,n.options,n.url);case 9:a=e.sent,r.postMessage({type:"parse-done",id:n.id,result:a},Dt(a)),e.next=16;break;case 13:e.prev=13,e.t1=e.catch(6),r.postMessage({type:"parse-error",id:n.id,message:e.t1.message});case 16:return e.abrupt("break",19);case 17:return o(n.message),e.abrupt("break",19);case 19:case"end":return e.stop()}}),e,null,[[6,13]])})))).apply(this,arguments)}var Yt=function(){var e=qe();return e.loaderRegistry=e.loaderRegistry||[],e.loaderRegistry};function Jt(){return Yt()}function $t(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Xt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?$t(Object(r),!0).forEach((function(t){$(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$t(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function er(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return tr(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return tr(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function tr(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var rr=/\.([^.]+)$/;function nr(e){return ir.apply(this,arguments)}function ir(){return(ir=V(F.a.mark((function e(t){var r,n,i,o,a=arguments;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=a.length>1&&void 0!==a[1]?a[1]:[],n=a.length>2&&void 0!==a[2]?a[2]:{},i=a.length>3&&void 0!==a[3]?a[3]:{},!(o=or(t,r,Xt(Xt({},n),{},{nothrow:!0}),i))){e.next=6;break}return e.abrupt("return",o);case 6:if(!Y(t)){e.next=11;break}return e.next=9,gt(t,0,10);case 9:t=e.sent,o=or(t,r,n,i);case 11:if(o||n.nothrow){e.next=13;break}throw new Error(ar(t));case 13:return e.abrupt("return",o);case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function or(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(t&&!Array.isArray(t))return ne(t);sr(t=[].concat(Mt(t||[]),Mt(Jt())));var i=ge(e),o=i.url,a=i.type,s=ur(t,o||n.url);if(!(s=(s=s||cr(t,a))||lr(t,e))&&!r.nothrow)throw new Error(ar(e));return s}function ar(e){var t=ge(e),r=t.url,n=t.type,i="No valid loader found";return e&&(i+=' data: "'.concat(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;if("string"==typeof e)return e.slice(0,t);if(ArrayBuffer.isView(e))return pr(e.buffer,e.byteOffset,t);if(e instanceof ArrayBuffer){var r=0;return pr(e,r,t)}return""}(e),'", contentType: "').concat(n,'"')),r&&(i+=" url: ".concat(r)),i}function sr(e){var t,r=er(e);try{for(r.s();!(t=r.n()).done;){ne(t.value)}}catch(e){r.e(e)}finally{r.f()}}function ur(e,t){var r=t&&t.match(rr),n=r&&r[1];return n&&function(e,t){t=t.toLowerCase();var r,n=er(e);try{for(n.s();!(r=n.n()).done;){var i,o=r.value,a=er(o.extensions);try{for(a.s();!(i=a.n()).done;){if(i.value.toLowerCase()===t)return o}}catch(e){a.e(e)}finally{a.f()}}}catch(e){n.e(e)}finally{n.f()}return null}(e,n)}function cr(e,t){var r,n=er(e);try{for(n.s();!(r=n.n()).done;){var i=r.value;if(i.mimeTypes&&i.mimeTypes.includes(t))return i;if(t==="application/x.".concat(i.id))return i}}catch(e){n.e(e)}finally{n.f()}return null}function lr(e,t){if(!t)return null;var r,n=er(e);try{for(n.s();!(r=n.n()).done;){var i=r.value;if("string"==typeof t){if(fr(t,i))return i}else if(ArrayBuffer.isView(t)){if(hr(t.buffer,t.byteOffset,i))return i}else if(t instanceof ArrayBuffer){if(hr(t,0,i))return i}}}catch(e){n.e(e)}finally{n.f()}return null}function fr(e,t){return t.testText&&t.testText(e)}function hr(e,t,r){return(Array.isArray(r.tests)?r.tests:[r.tests]).some((function(n){return function(e,t,r,n){if(n instanceof ArrayBuffer)return function(e,t,r){if(r=r||e.byteLength,e.byteLength<r||t.byteLength<r)return!1;for(var n=new Uint8Array(e),i=new Uint8Array(t),o=0;o<n.length;++o)if(n[o]!==i[o])return!1;return!0}(n,e,n.byteLength);switch(z(n)){case"function":return n(e,r);case"string":var i=pr(e,t,n.length);return n===i;default:return!1}}(e,t,r,n)}))}function pr(e,t,r){if(e.byteLength<t+r)return"";for(var n=new DataView(e),i="",o=0;o<r;o++)i+=String.fromCharCode(n.getUint8(t+o));return i}function dr(e,t,r,n){return yr.apply(this,arguments)}function yr(){return(yr=V(F.a.mark((function e(t,r,n,i){var o,a,s,u;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return X(!i||"string"!=typeof i,"parse no longer accepts final url"),!r||Array.isArray(r)||re(r)||(i=n,n=r,r=null),e.next=4,t;case 4:return t=e.sent,n=n||{},o=ge(t),a=o.url,s=Rt(r,i),e.next=10,nr(t,s,n);case 10:if(u=e.sent){e.next=13;break}return e.abrupt("return",null);case 13:return n=We(n,u,s,a),i=Lt({url:a,parse:dr,loaders:s},n,i),e.next=17,vr(u,t,n,i);case 17:return e.abrupt("return",e.sent);case 18:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function vr(e,t,r,n){return gr.apply(this,arguments)}function gr(){return(gr=V(F.a.mark((function e(t,r,n,i){return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Je(t),e.next=3,Pt(r,t);case 3:if(r=e.sent,!t.parseTextSync||"string"!=typeof r){e.next=7;break}return n.dataType="text",e.abrupt("return",t.parseTextSync(r,n,i,t));case 7:if(!Wt(t,0,n)){e.next=11;break}return e.next=10,Ht(t,r,n);case 10:return e.abrupt("return",e.sent);case 11:if(!t.parseText||"string"!=typeof r){e.next=15;break}return e.next=14,t.parseText(r,n,i,t);case 14:return e.abrupt("return",e.sent);case 15:if(!t.parse){e.next=19;break}return e.next=18,t.parse(r,n,i,t);case 18:return e.abrupt("return",e.sent);case 19:return X(!t.parseSync),e.abrupt("return",X(!1));case 21:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function mr(e,t,r){return br.apply(this,arguments)}function br(){return(br=V(F.a.mark((function e(t,r,n){var i,o;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Array.isArray(r)||re(r)||(n=r,r=null),i=He(n||{}),o=t,"string"!=typeof t){e.next=9;break}return e.next=6,i(t);case 6:o=e.sent,e.next=10;break;case 9:t=null;case 10:if(!Y(t)){e.next=15;break}return e.next=13,i(t);case 13:o=e.sent,t=null;case 15:return e.next=17,dr(o,r,n);case 17:return e.abrupt("return",e.sent);case 18:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var wr=r(13),xr=r.n(wr),kr=function(){function e(t){var r=t.x,n=t.y,i=t.z,o=t.onTileLoad,a=t.onTileError;c()(this,e),this.x=r,this.y=n,this.z=i,this.isVisible=!1,this.isSelected=!1,this.parent=null,this.children=[],this.content=null,this._isLoaded=!1,this._isCancelled=!1,this.onTileLoad=o,this.onTileError=a}var t;return w()(e,[{key:"_loadData",value:(t=xr()(F.a.mark((function e(t,r){var n,i,o,a,s,u,c,l;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.x,i=this.y,o=this.z,a=this.bbox,this._abortController=new AbortController,s=this._abortController.signal,e.next=5,r.scheduleRequest(this,(function(e){return e.isSelected?1:-1}));case 5:if(u=e.sent){e.next=9;break}return this._isCancelled=!0,e.abrupt("return");case 9:if(!this._isCancelled){e.next=12;break}return u.done(),e.abrupt("return");case 12:return e.prev=12,e.next=15,t({x:n,y:i,z:o,bbox:a,signal:s});case 15:c=e.sent,e.next=21;break;case 18:e.prev=18,e.t0=e.catch(12),l=e.t0||!0;case 21:return e.prev=21,u.done(),this._isCancelled&&!c?this._isLoaded=!1:(this._isLoaded=!0,this._isCancelled=!1),e.finish(21);case 25:if(this._isLoaded){e.next=27;break}return e.abrupt("return");case 27:l?this.onTileError(l,this):(this.content=c,this.onTileLoad(this));case 28:case"end":return e.stop()}}),e,this,[[12,18,21,25]])}))),function(e,r){return t.apply(this,arguments)})},{key:"loadData",value:function(e,t){var r=this;e&&(this._isCancelled=!1,this._loader=this._loadData(e,t),this._loader.finally((function(){r._loader=void 0})))}},{key:"abort",value:function(){this.isLoaded||(this._isCancelled=!0,this._abortController.abort())}},{key:"data",get:function(){return this._isLoaded?this.content:this._loader}},{key:"isLoaded",get:function(){return this._isLoaded}},{key:"isLoading",get:function(){return Boolean(this._loader)}},{key:"isCancelled",get:function(){return this._isCancelled}},{key:"byteLength",get:function(){var e=this.content?this.content.byteLength:0;return Number.isFinite(e)||v.log.error("byteLength not defined in tile data")(),e}}]),e}(),_r=r(11),Or=r.n(_r),Tr=Object.freeze({OUTSIDE:-1,INTERSECTING:0,INSIDE:1});function Sr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ar(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Pr(e,t,r){return t&&Ar(e.prototype,t),r&&Ar(e,r),e}function Er(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Mr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function jr(e,t,r){return t&&Mr(e.prototype,t),r&&Mr(e,r),e}function Ir(e,t){return(Ir=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Lr(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ir(e,t)}function Rr(e){return(Rr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Cr(e,t){return!t||"object"!==Rr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Nr(e){return(Nr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Dr(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function Ur(e,t,r){return(Ur=Dr()?Reflect.construct:function(e,t,r){var n=[null];n.push.apply(n,t);var i=new(Function.bind.apply(e,n));return r&&Ir(i,r.prototype),i}).apply(null,arguments)}function Fr(e){var t="function"==typeof Map?new Map:void 0;return(Fr=function(e){if(null===e||(r=e,-1===Function.toString.call(r).indexOf("[native code]")))return e;var r;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return Ur(e,arguments,Nr(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),Ir(n,e)})(e)}function Br(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Vr(e,t){if(e){if("string"==typeof e)return Br(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Br(e,t):void 0}}function zr(e,t){if(!e)throw new Error("math.gl assertion ".concat(t))}var qr=1/Math.PI*180,Gr=1/180*Math.PI,Wr={};function Hr(e){return Math.round(e/Wr.EPSILON)*Wr.EPSILON}function Zr(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.precision,n=void 0===r?Wr.precision||4:r;return e=Hr(e),"".concat(parseFloat(e.toPrecision(n)))}function Qr(e){return Array.isArray(e)||ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Kr(e,t,r){if(Qr(e)){r=r||((i=e).clone?i.clone():new Array(i.length));for(var n=0;n<r.length&&n<e.length;++n)r[n]=t(e[n],n,r);return r}var i;return t(e)}function Yr(e){return function(e,t){return Kr(e,(function(e){return e*Gr}),t)}(e)}function Jr(e){return $r(e)}function $r(e,t){return Kr(e,(function(e){return e*qr}),t)}function Xr(e,t,r){return Kr(e,(function(e){return Math.max(t,Math.min(r,e))}))}function en(e,t,r){return Qr(e)?e.map((function(e,n){return en(e,t[n],r)})):r*t+(1-r)*e}function tn(e,t,r){var n=Wr.EPSILON;r&&(Wr.EPSILON=r);try{if(e===t)return!0;if(Qr(e)&&Qr(t)){if(e.length!==t.length)return!1;for(var i=0;i<e.length;++i)if(!tn(e[i],t[i]))return!1;return!0}return e&&e.equals?e.equals(t):t&&t.equals?t.equals(e):!(!Number.isFinite(e)||!Number.isFinite(t))&&Math.abs(e-t)<=Wr.EPSILON*Math.max(1,Math.abs(e),Math.abs(t))}finally{Wr.EPSILON=n}}function rn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Nr(e);if(t){var i=Nr(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Cr(this,r)}}Wr.EPSILON=1e-12,Wr.debug=!1,Wr.precision=4,Wr.printTypes=!1,Wr.printDegrees=!1,Wr.printRowMajor=!0;var nn=function(e){Lr(r,e);var t=rn(r);function r(){return Er(this,r),t.apply(this,arguments)}return jr(r,[{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"from",value:function(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}},{key:"fromArray",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=0;r<this.ELEMENTS;++r)this[r]=e[r+t];return this.check()}},{key:"to",value:function(e){return e===this?this:Qr(e)?this.toArray(e):this.toObject(e)}},{key:"toTarget",value:function(e){return e?this.to(e):this}},{key:"toArray",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=0;r<this.ELEMENTS;++r)e[t+r]=this[r];return e}},{key:"toFloat32Array",value:function(){return new Float32Array(this)}},{key:"toString",value:function(){return this.formatString(Wr)}},{key:"formatString",value:function(e){for(var t="",r=0;r<this.ELEMENTS;++r)t+=(r>0?", ":"")+Zr(this[r],e);return"".concat(e.printTypes?this.constructor.name:"","[").concat(t,"]")}},{key:"equals",value:function(e){if(!e||this.length!==e.length)return!1;for(var t=0;t<this.ELEMENTS;++t)if(!tn(this[t],e[t]))return!1;return!0}},{key:"exactEquals",value:function(e){if(!e||this.length!==e.length)return!1;for(var t=0;t<this.ELEMENTS;++t)if(this[t]!==e[t])return!1;return!0}},{key:"negate",value:function(){for(var e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}},{key:"lerp",value:function(e,t,r){void 0===r&&(r=t,t=e,e=this);for(var n=0;n<this.ELEMENTS;++n){var i=e[n];this[n]=i+r*(t[n]-i)}return this.check()}},{key:"min",value:function(e){for(var t=0;t<this.ELEMENTS;++t)this[t]=Math.min(e[t],this[t]);return this.check()}},{key:"max",value:function(e){for(var t=0;t<this.ELEMENTS;++t)this[t]=Math.max(e[t],this[t]);return this.check()}},{key:"clamp",value:function(e,t){for(var r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e[r]),t[r]);return this.check()}},{key:"add",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];for(var n=0,i=t;n<i.length;n++)for(var o=i[n],a=0;a<this.ELEMENTS;++a)this[a]+=o[a];return this.check()}},{key:"subtract",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];for(var n=0,i=t;n<i.length;n++)for(var o=i[n],a=0;a<this.ELEMENTS;++a)this[a]-=o[a];return this.check()}},{key:"scale",value:function(e){if(Array.isArray(e))return this.multiply(e);for(var t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}},{key:"sub",value:function(e){return this.subtract(e)}},{key:"setScalar",value:function(e){for(var t=0;t<this.ELEMENTS;++t)this[t]=e;return this.check()}},{key:"addScalar",value:function(e){for(var t=0;t<this.ELEMENTS;++t)this[t]+=e;return this.check()}},{key:"subScalar",value:function(e){return this.addScalar(-e)}},{key:"multiplyScalar",value:function(e){for(var t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}},{key:"divideScalar",value:function(e){return this.scale(1/e)}},{key:"clampScalar",value:function(e,t){for(var r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e),t);return this.check()}},{key:"multiplyByScalar",value:function(e){return this.scale(e)}},{key:"check",value:function(){if(Wr.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}},{key:"validate",value:function(){for(var e=this.length===this.ELEMENTS,t=0;t<this.ELEMENTS;++t)e=e&&Number.isFinite(this[t]);return e}},{key:"ELEMENTS",get:function(){return zr(!1),0}},{key:"RANK",get:function(){return zr(!1),0}},{key:"elements",get:function(){return this}}]),r}(Fr(Array));function on(e,t){if(e.length!==t)return!1;for(var r=0;r<e.length;++r)if(!Number.isFinite(e[r]))return!1;return!0}function an(e){if(!Number.isFinite(e))throw new Error("Invalid number ".concat(e));return e}function sn(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(Wr.debug&&!on(e,t))throw new Error("math.gl: ".concat(r," some fields set to invalid numbers'"));return e}var un={};function cn(e,t){un[e]||(un[e]=!0,console.warn("".concat(e," has been removed in version ").concat(t,", see upgrade guide for more information")))}function ln(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Nr(e);if(t){var i=Nr(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Cr(this,r)}}var fn=function(e){Lr(r,e);var t=ln(r);function r(){return Er(this,r),t.apply(this,arguments)}return jr(r,[{key:"copy",value:function(e){return zr(!1),this}},{key:"len",value:function(){return Math.sqrt(this.lengthSquared())}},{key:"magnitude",value:function(){return this.len()}},{key:"lengthSquared",value:function(){for(var e=0,t=0;t<this.ELEMENTS;++t)e+=this[t]*this[t];return e}},{key:"magnitudeSquared",value:function(){return this.lengthSquared()}},{key:"distance",value:function(e){return Math.sqrt(this.distanceSquared(e))}},{key:"distanceSquared",value:function(e){for(var t=0,r=0;r<this.ELEMENTS;++r){var n=this[r]-e[r];t+=n*n}return an(t)}},{key:"dot",value:function(e){for(var t=0,r=0;r<this.ELEMENTS;++r)t+=this[r]*e[r];return an(t)}},{key:"normalize",value:function(){var e=this.magnitude();if(0!==e)for(var t=0;t<this.ELEMENTS;++t)this[t]/=e;return this.check()}},{key:"multiply",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];for(var n=0,i=t;n<i.length;n++)for(var o=i[n],a=0;a<this.ELEMENTS;++a)this[a]*=o[a];return this.check()}},{key:"divide",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];for(var n=0,i=t;n<i.length;n++)for(var o=i[n],a=0;a<this.ELEMENTS;++a)this[a]/=o[a];return this.check()}},{key:"lengthSq",value:function(){return this.lengthSquared()}},{key:"distanceTo",value:function(e){return this.distance(e)}},{key:"distanceToSquared",value:function(e){return this.distanceSquared(e)}},{key:"getComponent",value:function(e){return zr(e>=0&&e<this.ELEMENTS,"index is out of range"),an(this[e])}},{key:"setComponent",value:function(e,t){return zr(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=t,this.check()}},{key:"addVectors",value:function(e,t){return this.copy(e).add(t)}},{key:"subVectors",value:function(e,t){return this.copy(e).subtract(t)}},{key:"multiplyVectors",value:function(e,t){return this.copy(e).multiply(t)}},{key:"addScaledVector",value:function(e,t){return this.add(new this.constructor(e).multiplyScalar(t))}},{key:"x",get:function(){return this[0]},set:function(e){this[0]=an(e)}},{key:"y",get:function(){return this[1]},set:function(e){this[1]=an(e)}}]),r}(nn),hn="undefined"!=typeof Float32Array?Float32Array:Array;Math.random;Math.PI;function pn(){var e=new hn(3);return hn!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function dn(e){var t=e[0],r=e[1],n=e[2];return Math.hypot(t,r,n)}function yn(e,t,r){var n=new hn(3);return n[0]=e,n[1]=t,n[2]=r,n}function vn(e,t){var r=t[0],n=t[1],i=t[2],o=r*r+n*n+i*i;return o>0&&(o=1/Math.sqrt(o)),e[0]=t[0]*o,e[1]=t[1]*o,e[2]=t[2]*o,e}function gn(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function mn(e,t,r){var n=t[0],i=t[1],o=t[2],a=r[0],s=r[1],u=r[2];return e[0]=i*u-o*s,e[1]=o*a-n*u,e[2]=n*s-i*a,e}function bn(e,t,r){var n=t[0],i=t[1],o=t[2],a=r[3]*n+r[7]*i+r[11]*o+r[15];return a=a||1,e[0]=(r[0]*n+r[4]*i+r[8]*o+r[12])/a,e[1]=(r[1]*n+r[5]*i+r[9]*o+r[13])/a,e[2]=(r[2]*n+r[6]*i+r[10]*o+r[14])/a,e}function wn(e,t,r){var n=t[0],i=t[1],o=t[2];return e[0]=n*r[0]+i*r[3]+o*r[6],e[1]=n*r[1]+i*r[4]+o*r[7],e[2]=n*r[2]+i*r[5]+o*r[8],e}Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});var xn,kn=dn;xn=pn();function _n(e,t,r){var n=t[0],i=t[1],o=r[3]*n+r[7]*i||1;return e[0]=(r[0]*n+r[4]*i)/o,e[1]=(r[1]*n+r[5]*i)/o,e}function On(e,t,r){var n=t[0],i=t[1],o=t[2],a=r[3]*n+r[7]*i+r[11]*o||1;return e[0]=(r[0]*n+r[4]*i+r[8]*o)/a,e[1]=(r[1]*n+r[5]*i+r[9]*o)/a,e[2]=(r[2]*n+r[6]*i+r[10]*o)/a,e}function Tn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Nr(e);if(t){var i=Nr(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Cr(this,r)}}var Sn=[0,0,0],An={},Pn=function(e){Lr(r,e);var t=Tn(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Er(this,r),e=t.call(this,-0,-0,-0),1===arguments.length&&Qr(n)?e.copy(n):(Wr.debug&&(an(n),an(i),an(o)),e[0]=n,e[1]=i,e[2]=o),e}return jr(r,null,[{key:"ZERO",get:function(){return An.ZERO=An.ZERO||Object.freeze(new r(0,0,0,0))}}]),jr(r,[{key:"set",value:function(e,t,r){return this[0]=e,this[1]=t,this[2]=r,this.check()}},{key:"copy",value:function(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}},{key:"fromObject",value:function(e){return Wr.debug&&(an(e.x),an(e.y),an(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}},{key:"toObject",value:function(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}},{key:"angle",value:function(e){return function(e,t){var r=yn(e[0],e[1],e[2]),n=yn(t[0],t[1],t[2]);vn(r,r),vn(n,n);var i=gn(r,n);return i>1?0:i<-1?Math.PI:Math.acos(i)}(this,e)}},{key:"cross",value:function(e){return mn(this,this,e),this.check()}},{key:"rotateX",value:function(e){var t,r,n,i,o,a,s=e.radians,u=e.origin;return t=this,n=void 0===u?Sn:u,i=s,a=[],(o=[])[0]=(r=this)[0]-n[0],o[1]=r[1]-n[1],o[2]=r[2]-n[2],a[0]=o[0],a[1]=o[1]*Math.cos(i)-o[2]*Math.sin(i),a[2]=o[1]*Math.sin(i)+o[2]*Math.cos(i),t[0]=a[0]+n[0],t[1]=a[1]+n[1],t[2]=a[2]+n[2],this.check()}},{key:"rotateY",value:function(e){var t,r,n,i,o,a,s=e.radians,u=e.origin;return t=this,n=void 0===u?Sn:u,i=s,a=[],(o=[])[0]=(r=this)[0]-n[0],o[1]=r[1]-n[1],o[2]=r[2]-n[2],a[0]=o[2]*Math.sin(i)+o[0]*Math.cos(i),a[1]=o[1],a[2]=o[2]*Math.cos(i)-o[0]*Math.sin(i),t[0]=a[0]+n[0],t[1]=a[1]+n[1],t[2]=a[2]+n[2],this.check()}},{key:"rotateZ",value:function(e){var t,r,n,i,o,a,s=e.radians,u=e.origin;return t=this,n=void 0===u?Sn:u,i=s,a=[],(o=[])[0]=(r=this)[0]-n[0],o[1]=r[1]-n[1],o[2]=r[2]-n[2],a[0]=o[0]*Math.cos(i)-o[1]*Math.sin(i),a[1]=o[0]*Math.sin(i)+o[1]*Math.cos(i),a[2]=o[2],t[0]=a[0]+n[0],t[1]=a[1]+n[1],t[2]=a[2]+n[2],this.check()}},{key:"transform",value:function(e){return this.transformAsPoint(e)}},{key:"transformAsPoint",value:function(e){return bn(this,this,e),this.check()}},{key:"transformAsVector",value:function(e){return On(this,this,e),this.check()}},{key:"transformByMatrix3",value:function(e){return wn(this,this,e),this.check()}},{key:"transformByMatrix2",value:function(e){var t,r,n,i,o;return t=this,n=e,i=(r=this)[0],o=r[1],t[0]=n[0]*i+n[2]*o,t[1]=n[1]*i+n[3]*o,t[2]=r[2],this.check()}},{key:"transformByQuaternion",value:function(e){var t,r,n,i,o,a,s,u,c,l,f,h,p,d,y,v,g;return t=this,r=this,i=(n=e)[0],o=n[1],a=n[2],s=n[3],u=r[0],c=r[1],l=r[2],d=o*(p=i*c-o*u)-a*(h=a*u-i*l),y=a*(f=o*l-a*c)-i*p,v=i*h-o*f,f*=g=2*s,h*=g,p*=g,d*=2,y*=2,v*=2,t[0]=u+f+d,t[1]=c+h+y,t[2]=l+p+v,this.check()}},{key:"ELEMENTS",get:function(){return 3}},{key:"z",get:function(){return this[2]},set:function(e){this[2]=an(e)}}]),r}(fn),En=new Pn,Mn=new Pn,jn=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0,0],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Sr(this,e),n=n||En.copy(t).add(r).scale(.5),this.center=new Pn(n),this.halfDiagonal=new Pn(r).subtract(this.center),this.minimum=new Pn(t),this.maximum=new Pn(r)}return Pr(e,[{key:"clone",value:function(){return new e(this.minimum,this.maximum,this.center)}},{key:"equals",value:function(e){return this===e||Boolean(e)&&this.minimum.equals(e.minimum)&&this.maximum.equals(e.maximum)}},{key:"intersectPlane",value:function(e){var t=this.halfDiagonal,r=Mn.from(e.normal),n=t.x*Math.abs(r.x)+t.y*Math.abs(r.y)+t.z*Math.abs(r.z),i=this.center.dot(r)+e.distance;return i-n>0?Tr.INSIDE:i+n<0?Tr.OUTSIDE:Tr.INTERSECTING}},{key:"distanceTo",value:function(e){return Math.sqrt(this.distanceSquaredTo(e))}},{key:"distanceSquaredTo",value:function(e){var t,r=En.from(e).subtract(this.center),n=this.halfDiagonal,i=0;return(t=Math.abs(r.x)-n.x)>0&&(i+=t*t),(t=Math.abs(r.y)-n.y)>0&&(i+=t*t),(t=Math.abs(r.z)-n.z)>0&&(i+=t*t),i}}]),e}();function In(e,t,r){var n=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],c=t[6],l=t[7],f=t[8],h=t[9],p=t[10],d=t[11],y=t[12],v=t[13],g=t[14],m=t[15],b=r[0],w=r[1],x=r[2],k=r[3];return e[0]=b*n+w*s+x*f+k*y,e[1]=b*i+w*u+x*h+k*v,e[2]=b*o+w*c+x*p+k*g,e[3]=b*a+w*l+x*d+k*m,b=r[4],w=r[5],x=r[6],k=r[7],e[4]=b*n+w*s+x*f+k*y,e[5]=b*i+w*u+x*h+k*v,e[6]=b*o+w*c+x*p+k*g,e[7]=b*a+w*l+x*d+k*m,b=r[8],w=r[9],x=r[10],k=r[11],e[8]=b*n+w*s+x*f+k*y,e[9]=b*i+w*u+x*h+k*v,e[10]=b*o+w*c+x*p+k*g,e[11]=b*a+w*l+x*d+k*m,b=r[12],w=r[13],x=r[14],k=r[15],e[12]=b*n+w*s+x*f+k*y,e[13]=b*i+w*u+x*h+k*v,e[14]=b*o+w*c+x*p+k*g,e[15]=b*a+w*l+x*d+k*m,e}function Ln(e,t,r){var n=r[0],i=r[1],o=r[2];return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*o,e[9]=t[9]*o,e[10]=t[10]*o,e[11]=t[11]*o,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Rn(e,t){var r=t[0],n=t[1],i=t[2],o=t[4],a=t[5],s=t[6],u=t[8],c=t[9],l=t[10];return e[0]=Math.hypot(r,n,i),e[1]=Math.hypot(o,a,s),e[2]=Math.hypot(u,c,l),e}function Cn(e,t,r,n,i){var o,a=1/Math.tan(t/2);return e[0]=a/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=i&&i!==1/0?(o=1/(n-i),e[10]=(i+n)*o,e[14]=2*i*n*o):(e[10]=-1,e[14]=-2*n),e}function Nn(e,t,r,n){var i,o,a,s,u,c,l,f,h,p,d=t[0],y=t[1],v=t[2],g=n[0],m=n[1],b=n[2],w=r[0],x=r[1],k=r[2];return Math.abs(d-w)<1e-6&&Math.abs(y-x)<1e-6&&Math.abs(v-k)<1e-6?function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}(e):(l=d-w,f=y-x,h=v-k,i=m*(h*=p=1/Math.hypot(l,f,h))-b*(f*=p),o=b*(l*=p)-g*h,a=g*f-m*l,(p=Math.hypot(i,o,a))?(i*=p=1/p,o*=p,a*=p):(i=0,o=0,a=0),s=f*a-h*o,u=h*i-l*a,c=l*o-f*i,(p=Math.hypot(s,u,c))?(s*=p=1/p,u*=p,c*=p):(s=0,u=0,c=0),e[0]=i,e[1]=s,e[2]=l,e[3]=0,e[4]=o,e[5]=u,e[6]=f,e[7]=0,e[8]=a,e[9]=c,e[10]=h,e[11]=0,e[12]=-(i*d+o*y+a*v),e[13]=-(s*d+u*y+c*v),e[14]=-(l*d+f*y+h*v),e[15]=1,e)}var Dn=new Pn,Un=new Pn,Fn=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0,0],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;Sr(this,e),this.radius=-0,this.center=new Pn,this.fromCenterRadius(t,r)}return Pr(e,[{key:"fromCenterRadius",value:function(e,t){return this.center.from(e),this.radius=t,this}},{key:"fromCornerPoints",value:function(e,t){return t=Dn.from(t),this.center=(new Pn).from(e).add(t).scale(.5),this.radius=this.center.distance(t),this}},{key:"equals",value:function(e){return this===e||Boolean(e)&&this.center.equals(e.center)&&this.radius===e.radius}},{key:"clone",value:function(){return new e(this.center,this.radius)}},{key:"union",value:function(e){var t=this.center,r=this.radius,n=e.center,i=e.radius,o=Dn.copy(n).subtract(t),a=o.magnitude();if(r>=a+i)return this.clone();if(i>=a+r)return e.clone();var s=.5*(r+a+i);return Un.copy(o).scale((-r+s)/a).add(t),this.center.copy(Un),this.radius=s,this}},{key:"expand",value:function(e){var t=(e=Dn.from(e)).subtract(this.center).magnitude();return t>this.radius&&(this.radius=t),this}},{key:"intersectPlane",value:function(e){var t=this.center,r=this.radius,n=e.normal.dot(t)+e.distance;return n<-r?Tr.OUTSIDE:n<r?Tr.INTERSECTING:Tr.INSIDE}},{key:"transform",value:function(e){this.center.transform(e);var t=Rn(Dn,e);return this.radius=Math.max(t[0],Math.max(t[1],t[2]))*this.radius,this}},{key:"distanceSquaredTo",value:function(e){return(e=Dn.from(e)).subtract(this.center).lengthSquared()-this.radius*this.radius}},{key:"distanceTo",value:function(e){return Math.sqrt(this.distanceSquaredTo(e))}}]),e}();function Bn(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Vn(e){return function(e){if(Array.isArray(e))return Bn(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return Bn(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Bn(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function zn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Nr(e);if(t){var i=Nr(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Cr(this,r)}}var qn=function(e){Lr(r,e);var t=zn(r);function r(){return Er(this,r),t.apply(this,arguments)}return jr(r,[{key:"toString",value:function(){var e="[";if(Wr.printRowMajor){e+="row-major:";for(var t=0;t<this.RANK;++t)for(var r=0;r<this.RANK;++r)e+=" ".concat(this[r*this.RANK+t])}else{e+="column-major:";for(var n=0;n<this.ELEMENTS;++n)e+=" ".concat(this[n])}return e+="]"}},{key:"getElementIndex",value:function(e,t){return t*this.RANK+e}},{key:"getElement",value:function(e,t){return this[t*this.RANK+e]}},{key:"setElement",value:function(e,t,r){return this[t*this.RANK+e]=an(r),this}},{key:"getColumn",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Array(this.RANK).fill(-0),r=e*this.RANK,n=0;n<this.RANK;++n)t[n]=this[r+n];return t}},{key:"setColumn",value:function(e,t){for(var r=e*this.RANK,n=0;n<this.RANK;++n)this[r+n]=t[n];return this}}]),r}(nn);function Gn(e,t,r){var n=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],c=t[6],l=t[7],f=t[8],h=r[0],p=r[1],d=r[2],y=r[3],v=r[4],g=r[5],m=r[6],b=r[7],w=r[8];return e[0]=h*n+p*a+d*c,e[1]=h*i+p*s+d*l,e[2]=h*o+p*u+d*f,e[3]=y*n+v*a+g*c,e[4]=y*i+v*s+g*l,e[5]=y*o+v*u+g*f,e[6]=m*n+b*a+w*c,e[7]=m*i+b*s+w*l,e[8]=m*o+b*u+w*f,e}function Wn(e,t,r){var n=r[0],i=r[1];return e[0]=n*t[0],e[1]=n*t[1],e[2]=n*t[2],e[3]=i*t[3],e[4]=i*t[4],e[5]=i*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function Hn(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[3]*i+r[6],e[1]=r[1]*n+r[4]*i+r[7],e}function Zn(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[4]*i+r[12],e[1]=r[1]*n+r[5]*i+r[13],e}!function(){var e,t=(e=new hn(2),hn!=Float32Array&&(e[0]=0,e[1]=0),e)}();function Qn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Nr(e);if(t){var i=Nr(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Cr(this,r)}}var Kn=Object.freeze([1,0,0,0,1,0,0,0,1]),Yn=Object.freeze([0,0,0,0,0,0,0,0,0]),Jn=Object.freeze({COL0ROW0:0,COL0ROW1:1,COL0ROW2:2,COL1ROW0:3,COL1ROW1:4,COL1ROW2:5,COL2ROW0:6,COL2ROW1:7,COL2ROW2:8}),$n={},Xn=function(e){Lr(r,e);var t=Qn(r);function r(e){var n;return Er(this,r),n=t.call(this,-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(e)?n.copy(e):n.identity(),n}return jr(r,[{key:"ELEMENTS",get:function(){return 9}},{key:"RANK",get:function(){return 3}},{key:"INDICES",get:function(){return Jn}}],[{key:"IDENTITY",get:function(){return $n.IDENTITY=$n.IDENTITY||Object.freeze(new r(Kn)),$n.IDENTITY}},{key:"ZERO",get:function(){return $n.ZERO=$n.ZERO||Object.freeze(new r(Yn)),$n.ZERO}}]),jr(r,[{key:"copy",value:function(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this.check()}},{key:"set",value:function(e,t,r,n,i,o,a,s,u){return this[0]=e,this[1]=t,this[2]=r,this[3]=n,this[4]=i,this[5]=o,this[6]=a,this[7]=s,this[8]=u,this.check()}},{key:"setRowMajor",value:function(e,t,r,n,i,o,a,s,u){return this[0]=e,this[1]=n,this[2]=a,this[3]=t,this[4]=i,this[5]=s,this[6]=r,this[7]=o,this[8]=u,this.check()}},{key:"determinant",value:function(){return t=(e=this)[0],r=e[1],n=e[2],i=e[3],o=e[4],a=e[5],s=e[6],u=e[7],c=e[8],t*(c*o-a*u)+r*(-c*i+a*s)+n*(u*i-o*s);var e,t,r,n,i,o,a,s,u,c}},{key:"identity",value:function(){return this.copy(Kn)}},{key:"fromQuaternion",value:function(e){return function(e,t){var r=t[0],n=t[1],i=t[2],o=t[3],a=r+r,s=n+n,u=i+i,c=r*a,l=n*a,f=n*s,h=i*a,p=i*s,d=i*u,y=o*a,v=o*s,g=o*u;e[0]=1-f-d,e[3]=l-g,e[6]=h+v,e[1]=l+g,e[4]=1-c-d,e[7]=p-y,e[2]=h-v,e[5]=p+y,e[8]=1-c-f}(this,e),this.check()}},{key:"transpose",value:function(){return function(e,t){if(e===t){var r=t[1],n=t[2],i=t[5];e[1]=t[3],e[2]=t[6],e[3]=r,e[5]=t[7],e[6]=n,e[7]=i}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8]}(this,this),this.check()}},{key:"invert",value:function(){var e,t,r,n,i,o,a,s,u,c,l,f,h,p,d;return e=this,r=(t=this)[0],n=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],c=t[7],l=t[8],(d=r*(f=l*a-s*c)+n*(h=-l*o+s*u)+i*(p=c*o-a*u))&&(d=1/d,e[0]=f*d,e[1]=(-l*n+i*c)*d,e[2]=(s*n-i*a)*d,e[3]=h*d,e[4]=(l*r-i*u)*d,e[5]=(-s*r+i*o)*d,e[6]=p*d,e[7]=(-c*r+n*u)*d,e[8]=(a*r-n*o)*d),this.check()}},{key:"multiplyLeft",value:function(e){return Gn(this,e,this),this.check()}},{key:"multiplyRight",value:function(e){return Gn(this,this,e),this.check()}},{key:"rotate",value:function(e){var t,r,n,i,o,a,s,u,c,l,f,h,p,d;return t=this,n=e,i=(r=this)[0],o=r[1],a=r[2],s=r[3],u=r[4],c=r[5],l=r[6],f=r[7],h=r[8],p=Math.sin(n),d=Math.cos(n),t[0]=d*i+p*s,t[1]=d*o+p*u,t[2]=d*a+p*c,t[3]=d*s-p*i,t[4]=d*u-p*o,t[5]=d*c-p*a,t[6]=l,t[7]=f,t[8]=h,this.check()}},{key:"scale",value:function(e){return Array.isArray(e)?Wn(this,this,e):Wn(this,this,[e,e,e]),this.check()}},{key:"translate",value:function(e){var t,r,n,i,o,a,s,u,c,l,f,h,p,d;return t=this,n=e,i=(r=this)[0],o=r[1],a=r[2],s=r[3],u=r[4],c=r[5],l=r[6],f=r[7],h=r[8],p=n[0],d=n[1],t[0]=i,t[1]=o,t[2]=a,t[3]=s,t[4]=u,t[5]=c,t[6]=p*i+d*s+l,t[7]=p*o+d*u+f,t[8]=p*a+d*c+h,this.check()}},{key:"transform",value:function(e,t){switch(e.length){case 2:t=Hn(t||[-0,-0],e,this);break;case 3:t=wn(t||[-0,-0,-0],e,this);break;case 4:r=t||[-0,-0,-0,-0],i=this,o=(n=e)[0],a=n[1],s=n[2],r[0]=i[0]*o+i[3]*a+i[6]*s,r[1]=i[1]*o+i[4]*a+i[7]*s,r[2]=i[2]*o+i[5]*a+i[8]*s,r[3]=n[3],t=r;break;default:throw new Error("Illegal vector")}var r,n,i,o,a,s;return sn(t,e.length),t}},{key:"transformVector",value:function(e,t){return cn("Matrix3.transformVector"),this.transform(e,t)}},{key:"transformVector2",value:function(e,t){return cn("Matrix3.transformVector"),this.transform(e,t)}},{key:"transformVector3",value:function(e,t){return cn("Matrix3.transformVector"),this.transform(e,t)}}]),r}(qn);function ei(e){var t=e[0],r=e[1],n=e[2],i=e[3];return Math.hypot(t,r,n,i)}function ti(e){var t=e[0],r=e[1],n=e[2],i=e[3];return t*t+r*r+n*n+i*i}function ri(e,t,r){var n=t[0],i=t[1],o=t[2],a=r[0],s=r[1],u=r[2],c=r[3],l=c*n+s*o-u*i,f=c*i+u*n-a*o,h=c*o+a*i-s*n,p=-a*n-s*i-u*o;return e[0]=l*c+p*-a+f*-u-h*-s,e[1]=f*c+p*-s+h*-a-l*-u,e[2]=h*c+p*-u+l*-s-f*-a,e[3]=t[3],e}!function(){var e,t=(e=new hn(4),hn!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e)}();function ni(){var e=new hn(4);return hn!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function ii(e,t,r){r*=.5;var n=Math.sin(r);return e[0]=n*t[0],e[1]=n*t[1],e[2]=n*t[2],e[3]=Math.cos(r),e}function oi(e,t,r){var n=t[0],i=t[1],o=t[2],a=t[3],s=r[0],u=r[1],c=r[2],l=r[3];return e[0]=n*l+a*s+i*c-o*u,e[1]=i*l+a*u+o*s-n*c,e[2]=o*l+a*c+n*u-i*s,e[3]=a*l-n*s-i*u-o*c,e}function ai(e,t,r,n){var i,o,a,s,u,c=t[0],l=t[1],f=t[2],h=t[3],p=r[0],d=r[1],y=r[2],v=r[3];return(o=c*p+l*d+f*y+h*v)<0&&(o=-o,p=-p,d=-d,y=-y,v=-v),1-o>1e-6?(i=Math.acos(o),a=Math.sin(i),s=Math.sin((1-n)*i)/a,u=Math.sin(n*i)/a):(s=1-n,u=n),e[0]=s*c+u*p,e[1]=s*l+u*d,e[2]=s*f+u*y,e[3]=s*h+u*v,e}function si(e,t){var r,n=t[0]+t[4]+t[8];if(n>0)r=Math.sqrt(n+1),e[3]=.5*r,r=.5/r,e[0]=(t[5]-t[7])*r,e[1]=(t[6]-t[2])*r,e[2]=(t[1]-t[3])*r;else{var i=0;t[4]>t[0]&&(i=1),t[8]>t[3*i+i]&&(i=2);var o=(i+1)%3,a=(i+2)%3;r=Math.sqrt(t[3*i+i]-t[3*o+o]-t[3*a+a]+1),e[i]=.5*r,r=.5/r,e[3]=(t[3*o+a]-t[3*a+o])*r,e[o]=(t[3*o+i]+t[3*i+o])*r,e[a]=(t[3*a+i]+t[3*i+a])*r}return e}var ui,ci,li,fi,hi,pi,di,yi=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e},vi=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e},gi=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},mi=function(e,t,r,n){var i=t[0],o=t[1],a=t[2],s=t[3];return e[0]=i+n*(r[0]-i),e[1]=o+n*(r[1]-o),e[2]=a+n*(r[2]-a),e[3]=s+n*(r[3]-s),e},bi=ei,wi=ti,xi=function(e,t){var r=t[0],n=t[1],i=t[2],o=t[3],a=r*r+n*n+i*i+o*o;return a>0&&(a=1/Math.sqrt(a)),e[0]=r*a,e[1]=n*a,e[2]=i*a,e[3]=o*a,e},ki=(ui=pn(),ci=yn(1,0,0),li=yn(0,1,0),function(e,t,r){var n=gn(t,r);return n<-.999999?(mn(ui,ci,t),kn(ui)<1e-6&&mn(ui,li,t),vn(ui,ui),ii(e,ui,Math.PI),e):n>.999999?(e[0]=0,e[1]=0,e[2]=0,e[3]=1,e):(mn(ui,t,r),e[0]=ui[0],e[1]=ui[1],e[2]=ui[2],e[3]=1+n,xi(e,e))});fi=ni(),hi=ni(),pi=new hn(9),hn!=Float32Array&&(pi[1]=0,pi[2]=0,pi[3]=0,pi[5]=0,pi[6]=0,pi[7]=0),pi[0]=1,pi[4]=1,pi[8]=1,di=pi;function _i(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Nr(e);if(t){var i=Nr(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Cr(this,r)}}var Oi=[0,0,0,1],Ti=function(e){Lr(r,e);var t=_i(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return Er(this,r),e=t.call(this,-0,-0,-0,-0),Array.isArray(n)&&1===arguments.length?e.copy(n):e.set(n,i,o,a),e}return jr(r,[{key:"copy",value:function(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}},{key:"set",value:function(e,t,r,n){return this[0]=e,this[1]=t,this[2]=r,this[3]=n,this.check()}},{key:"fromMatrix3",value:function(e){return si(this,e),this.check()}},{key:"identity",value:function(){return function(e){e[0]=0,e[1]=0,e[2]=0,e[3]=1}(this),this.check()}},{key:"fromAxisRotation",value:function(e,t){return ii(this,e,t),this.check()}},{key:"setAxisAngle",value:function(e,t){return this.fromAxisRotation(e,t)}},{key:"len",value:function(){return bi(this)}},{key:"lengthSquared",value:function(){return wi(this)}},{key:"dot",value:function(e,t){if(void 0!==t)throw new Error("Quaternion.dot only takes one argument");return gi(this,e)}},{key:"rotationTo",value:function(e,t){return ki(this,e,t),this.check()}},{key:"add",value:function(e,t){if(void 0!==t)throw new Error("Quaternion.add only takes one argument");return yi(this,this,e),this.check()}},{key:"calculateW",value:function(){return function(e,t){var r=t[0],n=t[1],i=t[2];e[0]=r,e[1]=n,e[2]=i,e[3]=Math.sqrt(Math.abs(1-r*r-n*n-i*i))}(this,this),this.check()}},{key:"conjugate",value:function(){return function(e,t){e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3]}(this,this),this.check()}},{key:"invert",value:function(){return function(e,t){var r=t[0],n=t[1],i=t[2],o=t[3],a=r*r+n*n+i*i+o*o,s=a?1/a:0;e[0]=-r*s,e[1]=-n*s,e[2]=-i*s,e[3]=o*s}(this,this),this.check()}},{key:"lerp",value:function(e,t,r){return mi(this,e,t,r),this.check()}},{key:"multiplyRight",value:function(e,t){return zr(!t),oi(this,this,e),this.check()}},{key:"multiplyLeft",value:function(e,t){return zr(!t),oi(this,e,this),this.check()}},{key:"normalize",value:function(){var e=this.len(),t=e>0?1/e:0;return this[0]=this[0]*t,this[1]=this[1]*t,this[2]=this[2]*t,this[3]=this[3]*t,0===e&&(this[3]=1),this.check()}},{key:"rotateX",value:function(e){return function(e,t,r){r*=.5;var n=t[0],i=t[1],o=t[2],a=t[3],s=Math.sin(r),u=Math.cos(r);e[0]=n*u+a*s,e[1]=i*u+o*s,e[2]=o*u-i*s,e[3]=a*u-n*s}(this,this,e),this.check()}},{key:"rotateY",value:function(e){return function(e,t,r){r*=.5;var n=t[0],i=t[1],o=t[2],a=t[3],s=Math.sin(r),u=Math.cos(r);e[0]=n*u-o*s,e[1]=i*u+a*s,e[2]=o*u+n*s,e[3]=a*u-i*s}(this,this,e),this.check()}},{key:"rotateZ",value:function(e){return function(e,t,r){r*=.5;var n=t[0],i=t[1],o=t[2],a=t[3],s=Math.sin(r),u=Math.cos(r);e[0]=n*u+i*s,e[1]=i*u-n*s,e[2]=o*u+a*s,e[3]=a*u-o*s}(this,this,e),this.check()}},{key:"scale",value:function(e){return vi(this,this,e),this.check()}},{key:"slerp",value:function(e,t,r){switch(arguments.length){case 1:var n=arguments[0],i=n.start;e=void 0===i?Oi:i,t=n.target,r=n.ratio;break;case 2:var o=Array.prototype.slice.call(arguments);t=o[0],r=o[1],e=this}return ai(this,e,t,r),this.check()}},{key:"transformVector4",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;return ri(t,e,this),sn(t,4)}},{key:"lengthSq",value:function(){return this.lengthSquared()}},{key:"setFromAxisAngle",value:function(e,t){return this.setAxisAngle(e,t)}},{key:"premultiply",value:function(e,t){return this.multiplyLeft(e,t)}},{key:"multiply",value:function(e,t){return this.multiplyRight(e,t)}},{key:"ELEMENTS",get:function(){return 4}},{key:"x",get:function(){return this[0]},set:function(e){this[0]=an(e)}},{key:"y",get:function(){return this[1]},set:function(e){this[1]=an(e)}},{key:"z",get:function(){return this[2]},set:function(e){this[2]=an(e)}},{key:"w",get:function(){return this[3]},set:function(e){this[3]=an(e)}}]),r}(nn),Si=new Pn,Ai=new Pn,Pi=new Pn,Ei=new Pn,Mi=new Pn,ji=new Pn,Ii=new Pn,Li=new Pn,Ri=new Pn,Ci=new Pn,Ni=0,Di=1,Ui=2,Fi=3,Bi=4,Vi=5,zi=6,qi=7,Gi=8,Wi=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0,0],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0,0,0,0,0,0,0];Sr(this,e),this.center=(new Pn).from(t),this.halfAxes=new Xn(r)}return Pr(e,[{key:"fromCenterHalfSizeQuaternion",value:function(e,t,r){var n=new Ti(r),i=(new Xn).fromQuaternion(n);return i[0]=i[0]*t[0],i[1]=i[1]*t[0],i[2]=i[2]*t[0],i[3]=i[3]*t[1],i[4]=i[4]*t[1],i[5]=i[5]*t[1],i[6]=i[6]*t[2],i[7]=i[7]*t[2],i[8]=i[8]*t[2],this.center=(new Pn).from(e),this.halfAxes=i,this}},{key:"clone",value:function(){return new e(this.center,this.halfAxes)}},{key:"equals",value:function(e){return this===e||Boolean(e)&&this.center.equals(e.center)&&this.halfAxes.equals(e.halfAxes)}},{key:"getBoundingSphere",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Fn,t=this.halfAxes,r=t.getColumn(0,Li),n=t.getColumn(1,Ri),i=t.getColumn(2,Ci),o=Si.copy(r).add(n).add(i);return e.center.copy(this.center),e.radius=o.magnitude(),e}},{key:"intersectPlane",value:function(e){var t=this.center,r=e.normal,n=this.halfAxes,i=r.x,o=r.y,a=r.z,s=Math.abs(i*n[Ni]+o*n[Di]+a*n[Ui])+Math.abs(i*n[Fi]+o*n[Bi]+a*n[Vi])+Math.abs(i*n[zi]+o*n[qi]+a*n[Gi]),u=r.dot(t)+e.distance;return u<=-s?Tr.OUTSIDE:u>=s?Tr.INSIDE:Tr.INTERSECTING}},{key:"distanceTo",value:function(e){return Math.sqrt(this.distanceSquaredTo(e))}},{key:"distanceSquaredTo",value:function(e){var t=Ai.from(e).subtract(this.center),r=this.halfAxes,n=r.getColumn(0,Pi),i=r.getColumn(1,Ei),o=r.getColumn(2,Mi),a=n.magnitude(),s=i.magnitude(),u=o.magnitude();n.normalize(),i.normalize(),o.normalize();var c,l=0;return(c=Math.abs(t.dot(n))-a)>0&&(l+=c*c),(c=Math.abs(t.dot(i))-s)>0&&(l+=c*c),(c=Math.abs(t.dot(o))-u)>0&&(l+=c*c),l}},{key:"computePlaneDistances",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[-0,-0],n=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY,o=this.center,a=this.halfAxes,s=a.getColumn(0,Pi),u=a.getColumn(1,Ei),c=a.getColumn(2,Mi),l=ji.copy(s).add(u).add(c).add(o),f=Ii.copy(l).subtract(e),h=t.dot(f);return n=Math.min(h,n),i=Math.max(h,i),l.copy(o).add(s).add(u).subtract(c),f.copy(l).subtract(e),h=t.dot(f),n=Math.min(h,n),i=Math.max(h,i),l.copy(o).add(s).subtract(u).add(c),f.copy(l).subtract(e),h=t.dot(f),n=Math.min(h,n),i=Math.max(h,i),l.copy(o).add(s).subtract(u).subtract(c),f.copy(l).subtract(e),h=t.dot(f),n=Math.min(h,n),i=Math.max(h,i),o.copy(l).subtract(s).add(u).add(c),f.copy(l).subtract(e),h=t.dot(f),n=Math.min(h,n),i=Math.max(h,i),o.copy(l).subtract(s).add(u).subtract(c),f.copy(l).subtract(e),h=t.dot(f),n=Math.min(h,n),i=Math.max(h,i),o.copy(l).subtract(s).subtract(u).add(c),f.copy(l).subtract(e),h=t.dot(f),n=Math.min(h,n),i=Math.max(h,i),o.copy(l).subtract(s).subtract(u).subtract(c),f.copy(l).subtract(e),h=t.dot(f),n=Math.min(h,n),i=Math.max(h,i),r[0]=n,r[1]=i,r}},{key:"getTransform",value:function(){}},{key:"halfSize",get:function(){var e=this.halfAxes.getColumn(0),t=this.halfAxes.getColumn(1),r=this.halfAxes.getColumn(2);return[new Pn(e).len(),new Pn(t).len(),new Pn(r).len()]}},{key:"quaternion",get:function(){var e=this.halfAxes.getColumn(0),t=this.halfAxes.getColumn(1),r=this.halfAxes.getColumn(2),n=new Pn(e).normalize(),i=new Pn(t).normalize(),o=new Pn(r).normalize();return(new Ti).fromMatrix3(new Xn([].concat(Vn(n),Vn(i),Vn(o))))}}]),e}(),Hi=new Pn,Zi=new Pn,Qi=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0,1],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;Sr(this,e),this.normal=new Pn,this.distance=-0,this.fromNormalDistance(t,r)}return Pr(e,[{key:"fromNormalDistance",value:function(e,t){return zr(Number.isFinite(t)),this.normal.from(e).normalize(),this.distance=t,this}},{key:"fromPointNormal",value:function(e,t){e=Hi.from(e),this.normal.from(t).normalize();var r=-this.normal.dot(e);return this.distance=r,this}},{key:"fromCoefficients",value:function(e,t,r,n){return this.normal.set(e,t,r),zr(tn(this.normal.len(),1)),this.distance=n,this}},{key:"clone",value:function(t){return new e(this.normal,this.distance)}},{key:"equals",value:function(e){return tn(this.distance,e.distance)&&tn(this.normal,e.normal)}},{key:"getPointDistance",value:function(e){return this.normal.dot(e)+this.distance}},{key:"transform",value:function(e){var t=Zi.copy(this.normal).transformAsVector(e).normalize(),r=this.normal.scale(-this.distance).transform(e);return this.fromPointNormal(r,t)}},{key:"projectPointOntoPlane",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];e=Hi.from(e);var r=this.getPointDistance(e),n=Zi.copy(this.normal).scale(r);return e.subtract(n).to(t)}}]),e}();function Ki(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return Yi(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Yi(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function Yi(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Ji=[new Pn([1,0,0]),new Pn([0,1,0]),new Pn([0,0,1])],$i=new Pn,Xi=new Pn,eo=(new Qi(new Pn(1,0,0),0),function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];Sr(this,e),this.planes=t,zr(this.planes.every((function(e){return e instanceof Qi})))}return Pr(e,null,[{key:"MASK_OUTSIDE",get:function(){return 4294967295}},{key:"MASK_INSIDE",get:function(){return 0}},{key:"MASK_INDETERMINATE",get:function(){return 2147483647}}]),Pr(e,[{key:"fromBoundingSphere",value:function(e){this.planes.length=2*Ji.length;var t,r=e.center,n=e.radius,i=0,o=Ki(Ji);try{for(o.s();!(t=o.n()).done;){var a=t.value,s=this.planes[i],u=this.planes[i+1];s||(s=this.planes[i]=new Qi),u||(u=this.planes[i+1]=new Qi);var c=$i.copy(a).scale(-n).add(r);a.dot(c);s.fromPointNormal(c,a);var l=$i.copy(a).scale(n).add(r),f=Xi.copy(a).negate();f.dot(l);u.fromPointNormal(l,f),i+=2}}catch(e){o.e(e)}finally{o.f()}return this}},{key:"computeVisibility",value:function(e){zr(e);var t,r=Tr.INSIDE,n=Ki(this.planes);try{for(n.s();!(t=n.n()).done;){var i=t.value;switch(e.intersectPlane(i)){case Tr.OUTSIDE:return Tr.OUTSIDE;case Tr.INTERSECTING:r=Tr.INTERSECTING}}}catch(e){n.e(e)}finally{n.f()}return r}},{key:"computeVisibilityWithPlaneMask",value:function(t,r){if(zr(t,"boundingVolume is required."),zr(Number.isFinite(r),"parentPlaneMask is required."),r===e.MASK_OUTSIDE||r===e.MASK_INSIDE)return r;for(var n=e.MASK_INSIDE,i=this.planes,o=0;o<this.planes.length;++o){var a=o<31?1<<o:0;if(!(o<31&&0==(r&a))){var s=i[o],u=t.intersectPlane(s);if(u===Tr.OUTSIDE)return e.MASK_OUTSIDE;u===Tr.INTERSECTING&&(n|=a)}}return n}}]),e}());function to(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ro(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){i=!0,o=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw o}}return r}}(e,t)||Vr(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function no(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Nr(e);if(t){var i=Nr(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Cr(this,r)}}var io=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),oo=Object.freeze([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),ao=Object.freeze({COL0ROW0:0,COL0ROW1:1,COL0ROW2:2,COL0ROW3:3,COL1ROW0:4,COL1ROW1:5,COL1ROW2:6,COL1ROW3:7,COL2ROW0:8,COL2ROW1:9,COL2ROW2:10,COL2ROW3:11,COL3ROW0:12,COL3ROW1:13,COL3ROW2:14,COL3ROW3:15}),so={},uo=function(e){Lr(r,e);var t=no(r);function r(e){var n;return Er(this,r),n=t.call(this,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(e)?n.copy(e):n.identity(),n}return jr(r,[{key:"INDICES",get:function(){return ao}},{key:"ELEMENTS",get:function(){return 16}},{key:"RANK",get:function(){return 4}}],[{key:"IDENTITY",get:function(){return so.IDENTITY=so.IDENTITY||Object.freeze(new r(io)),so.IDENTITY}},{key:"ZERO",get:function(){return so.ZERO=so.ZERO||Object.freeze(new r(oo)),so.ZERO}}]),jr(r,[{key:"copy",value:function(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}},{key:"set",value:function(e,t,r,n,i,o,a,s,u,c,l,f,h,p,d,y){return this[0]=e,this[1]=t,this[2]=r,this[3]=n,this[4]=i,this[5]=o,this[6]=a,this[7]=s,this[8]=u,this[9]=c,this[10]=l,this[11]=f,this[12]=h,this[13]=p,this[14]=d,this[15]=y,this.check()}},{key:"setRowMajor",value:function(e,t,r,n,i,o,a,s,u,c,l,f,h,p,d,y){return this[0]=e,this[1]=i,this[2]=u,this[3]=h,this[4]=t,this[5]=o,this[6]=c,this[7]=p,this[8]=r,this[9]=a,this[10]=l,this[11]=d,this[12]=n,this[13]=s,this[14]=f,this[15]=y,this.check()}},{key:"toRowMajor",value:function(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}},{key:"identity",value:function(){return this.copy(io)}},{key:"fromQuaternion",value:function(e){return function(e,t){var r=t[0],n=t[1],i=t[2],o=t[3],a=r+r,s=n+n,u=i+i,c=r*a,l=n*a,f=n*s,h=i*a,p=i*s,d=i*u,y=o*a,v=o*s,g=o*u;e[0]=1-f-d,e[1]=l+g,e[2]=h-v,e[3]=0,e[4]=l-g,e[5]=1-c-d,e[6]=p+y,e[7]=0,e[8]=h+v,e[9]=p-y,e[10]=1-c-f,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1}(this,e),this.check()}},{key:"frustum",value:function(e){var t=e.left,n=e.right,i=e.bottom,o=e.top,a=e.near,s=e.far;return s===1/0?r._computeInfinitePerspectiveOffCenter(this,t,n,i,o,a):function(e,t,r,n,i,o,a){var s=1/(r-t),u=1/(i-n),c=1/(o-a);e[0]=2*o*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*o*u,e[6]=0,e[7]=0,e[8]=(r+t)*s,e[9]=(i+n)*u,e[10]=(a+o)*c,e[11]=-1,e[12]=0,e[13]=0,e[14]=a*o*2*c,e[15]=0}(this,t,n,i,o,a,s),this.check()}},{key:"lookAt",value:function(e,t,r){if(1===arguments.length){var n=e;e=n.eye,t=n.center,r=n.up}return Nn(this,e,t=t||[0,0,0],r=r||[0,1,0]),this.check()}},{key:"ortho",value:function(e){var t=e.left,r=e.right,n=e.bottom,i=e.top,o=e.near,a=void 0===o?.1:o,s=e.far;return function(e,t,r,n,i,o,a){var s=1/(t-r),u=1/(n-i),c=1/(o-a);e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*u,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*c,e[11]=0,e[12]=(t+r)*s,e[13]=(i+n)*u,e[14]=(a+o)*c,e[15]=1}(this,t,r,n,i,a,void 0===s?500:s),this.check()}},{key:"orthographic",value:function(e){var t=e.fovy,n=void 0===t?45*Math.PI/180:t,i=e.aspect,o=void 0===i?1:i,a=e.focalDistance,s=void 0===a?1:a,u=e.near,c=void 0===u?.1:u,l=e.far,f=void 0===l?500:l;if(n>2*Math.PI)throw Error("radians");var h=n/2,p=s*Math.tan(h),d=p*o;return(new r).ortho({left:-d,right:d,bottom:-p,top:p,near:c,far:f})}},{key:"perspective",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.fovy,r=void 0===t?void 0:t,n=e.fov,i=void 0===n?45*Math.PI/180:n,o=e.aspect,a=void 0===o?1:o,s=e.near,u=void 0===s?.1:s,c=e.far,l=void 0===c?500:c;if((r=r||i)>2*Math.PI)throw Error("radians");return Cn(this,r,a,u,l),this.check()}},{key:"determinant",value:function(){return t=(e=this)[0],r=e[1],n=e[2],i=e[3],o=e[4],a=e[5],s=e[6],u=e[7],c=e[8],l=e[9],f=e[10],h=e[11],p=e[12],d=e[13],y=e[14],v=e[15],(t*a-r*o)*(f*v-h*y)-(t*s-n*o)*(l*v-h*d)+(t*u-i*o)*(l*y-f*d)+(r*s-n*a)*(c*v-h*p)-(r*u-i*a)*(c*y-f*p)+(n*u-i*s)*(c*d-l*p);var e,t,r,n,i,o,a,s,u,c,l,f,h,p,d,y,v}},{key:"getScale",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[-0,-0,-0];return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}},{key:"getTranslation",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[-0,-0,-0];return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}},{key:"getRotation",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=this.getScale(t||[-0,-0,-0]),n=1/r[0],i=1/r[1],o=1/r[2];return e[0]=this[0]*n,e[1]=this[1]*i,e[2]=this[2]*o,e[3]=0,e[4]=this[4]*n,e[5]=this[5]*i,e[6]=this[6]*o,e[7]=0,e[8]=this[8]*n,e[9]=this[9]*i,e[10]=this[10]*o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}},{key:"getRotationMatrix3",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[-0,-0,-0,-0,-0,-0,-0,-0,-0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=this.getScale(t||[-0,-0,-0]),n=1/r[0],i=1/r[1],o=1/r[2];return e[0]=this[0]*n,e[1]=this[1]*i,e[2]=this[2]*o,e[3]=this[4]*n,e[4]=this[5]*i,e[5]=this[6]*o,e[6]=this[8]*n,e[7]=this[9]*i,e[8]=this[10]*o,e}},{key:"transpose",value:function(){return function(e,t){if(e===t){var r=t[1],n=t[2],i=t[3],o=t[6],a=t[7],s=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=r,e[6]=t[9],e[7]=t[13],e[8]=n,e[9]=o,e[11]=t[14],e[12]=i,e[13]=a,e[14]=s}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15]}(this,this),this.check()}},{key:"invert",value:function(){return function(e,t){var r=t[0],n=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],c=t[7],l=t[8],f=t[9],h=t[10],p=t[11],d=t[12],y=t[13],v=t[14],g=t[15],m=r*s-n*a,b=r*u-i*a,w=r*c-o*a,x=n*u-i*s,k=n*c-o*s,_=i*c-o*u,O=l*y-f*d,T=l*v-h*d,S=l*g-p*d,A=f*v-h*y,P=f*g-p*y,E=h*g-p*v,M=m*E-b*P+w*A+x*S-k*T+_*O;M&&(M=1/M,e[0]=(s*E-u*P+c*A)*M,e[1]=(i*P-n*E-o*A)*M,e[2]=(y*_-v*k+g*x)*M,e[3]=(h*k-f*_-p*x)*M,e[4]=(u*S-a*E-c*T)*M,e[5]=(r*E-i*S+o*T)*M,e[6]=(v*w-d*_-g*b)*M,e[7]=(l*_-h*w+p*b)*M,e[8]=(a*P-s*S+c*O)*M,e[9]=(n*S-r*P-o*O)*M,e[10]=(d*k-y*w+g*m)*M,e[11]=(f*w-l*k-p*m)*M,e[12]=(s*T-a*A-u*O)*M,e[13]=(r*A-n*T+i*O)*M,e[14]=(y*b-d*x-v*m)*M,e[15]=(l*x-f*b+h*m)*M)}(this,this),this.check()}},{key:"multiplyLeft",value:function(e){return In(this,e,this),this.check()}},{key:"multiplyRight",value:function(e){return In(this,this,e),this.check()}},{key:"rotateX",value:function(e){return function(e,t,r){var n=Math.sin(r),i=Math.cos(r),o=t[4],a=t[5],s=t[6],u=t[7],c=t[8],l=t[9],f=t[10],h=t[11];t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=o*i+c*n,e[5]=a*i+l*n,e[6]=s*i+f*n,e[7]=u*i+h*n,e[8]=c*i-o*n,e[9]=l*i-a*n,e[10]=f*i-s*n,e[11]=h*i-u*n}(this,this,e),this.check()}},{key:"rotateY",value:function(e){return function(e,t,r){var n=Math.sin(r),i=Math.cos(r),o=t[0],a=t[1],s=t[2],u=t[3],c=t[8],l=t[9],f=t[10],h=t[11];t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*i-c*n,e[1]=a*i-l*n,e[2]=s*i-f*n,e[3]=u*i-h*n,e[8]=o*n+c*i,e[9]=a*n+l*i,e[10]=s*n+f*i,e[11]=u*n+h*i}(this,this,e),this.check()}},{key:"rotateZ",value:function(e){return function(e,t,r){var n=Math.sin(r),i=Math.cos(r),o=t[0],a=t[1],s=t[2],u=t[3],c=t[4],l=t[5],f=t[6],h=t[7];t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*i+c*n,e[1]=a*i+l*n,e[2]=s*i+f*n,e[3]=u*i+h*n,e[4]=c*i-o*n,e[5]=l*i-a*n,e[6]=f*i-s*n,e[7]=h*i-u*n}(this,this,e),this.check()}},{key:"rotateXYZ",value:function(e){var t=ro(e,3),r=t[0],n=t[1],i=t[2];return this.rotateX(r).rotateY(n).rotateZ(i)}},{key:"rotateAxis",value:function(e,t){return function(e,t,r,n){var i,o,a,s,u,c,l,f,h,p,d,y,v,g,m,b,w,x,k,_,O,T,S,A,P=n[0],E=n[1],M=n[2],j=Math.hypot(P,E,M);j<1e-6||(P*=j=1/j,E*=j,M*=j,i=Math.sin(r),a=1-(o=Math.cos(r)),s=t[0],u=t[1],c=t[2],l=t[3],f=t[4],h=t[5],p=t[6],d=t[7],y=t[8],v=t[9],g=t[10],m=t[11],b=P*P*a+o,w=E*P*a+M*i,x=M*P*a-E*i,k=P*E*a-M*i,_=E*E*a+o,O=M*E*a+P*i,T=P*M*a+E*i,S=E*M*a-P*i,A=M*M*a+o,e[0]=s*b+f*w+y*x,e[1]=u*b+h*w+v*x,e[2]=c*b+p*w+g*x,e[3]=l*b+d*w+m*x,e[4]=s*k+f*_+y*O,e[5]=u*k+h*_+v*O,e[6]=c*k+p*_+g*O,e[7]=l*k+d*_+m*O,e[8]=s*T+f*S+y*A,e[9]=u*T+h*S+v*A,e[10]=c*T+p*S+g*A,e[11]=l*T+d*S+m*A,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]))}(this,this,e,t),this.check()}},{key:"scale",value:function(e){return Array.isArray(e)?Ln(this,this,e):Ln(this,this,[e,e,e]),this.check()}},{key:"translate",value:function(e){return function(e,t,r){var n,i,o,a,s,u,c,l,f,h,p,d,y=r[0],v=r[1],g=r[2];t===e?(e[12]=t[0]*y+t[4]*v+t[8]*g+t[12],e[13]=t[1]*y+t[5]*v+t[9]*g+t[13],e[14]=t[2]*y+t[6]*v+t[10]*g+t[14],e[15]=t[3]*y+t[7]*v+t[11]*g+t[15]):(n=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],c=t[6],l=t[7],f=t[8],h=t[9],p=t[10],d=t[11],e[0]=n,e[1]=i,e[2]=o,e[3]=a,e[4]=s,e[5]=u,e[6]=c,e[7]=l,e[8]=f,e[9]=h,e[10]=p,e[11]=d,e[12]=n*y+s*v+f*g+t[12],e[13]=i*y+u*v+h*g+t[13],e[14]=o*y+c*v+p*g+t[14],e[15]=a*y+l*v+d*g+t[15])}(this,this,e),this.check()}},{key:"transform",value:function(e,t){return 4===e.length?(sn(t=function(e,t,r){var n=t[0],i=t[1],o=t[2],a=t[3];return e[0]=r[0]*n+r[4]*i+r[8]*o+r[12]*a,e[1]=r[1]*n+r[5]*i+r[9]*o+r[13]*a,e[2]=r[2]*n+r[6]*i+r[10]*o+r[14]*a,e[3]=r[3]*n+r[7]*i+r[11]*o+r[15]*a,e}(t||[-0,-0,-0,-0],e,this),4),t):this.transformAsPoint(e,t)}},{key:"transformAsPoint",value:function(e,t){switch(e.length){case 2:t=Zn(t||[-0,-0],e,this);break;case 3:t=bn(t||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return sn(t,e.length),t}},{key:"transformAsVector",value:function(e,t){switch(e.length){case 2:t=_n(t||[-0,-0],e,this);break;case 3:t=On(t||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return sn(t,e.length),t}},{key:"makeRotationX",value:function(e){return this.identity().rotateX(e)}},{key:"makeTranslation",value:function(e,t,r){return this.identity().translate([e,t,r])}},{key:"transformPoint",value:function(e,t){return cn("Matrix4.transformPoint","3.0"),this.transformAsPoint(e,t)}},{key:"transformVector",value:function(e,t){return cn("Matrix4.transformVector","3.0"),this.transformAsPoint(e,t)}},{key:"transformDirection",value:function(e,t){return cn("Matrix4.transformDirection","3.0"),this.transformAsVector(e,t)}}],[{key:"_computeInfinitePerspectiveOffCenter",value:function(e,t,r,n,i,o){var a=2*o/(r-t),s=2*o/(i-n),u=(r+t)/(r-t),c=(i+n)/(i-n),l=-2*o;return e[0]=a,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s,e[6]=0,e[7]=0,e[8]=u,e[9]=c,e[10]=-1,e[11]=-1,e[12]=0,e[13]=0,e[14]=l,e[15]=0,e}}]),r}(qn);function co(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function lo(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?co(Object(r),!0).forEach((function(t){to(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):co(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var fo=new Pn,ho=new Pn,po=new Pn,yo=new Pn,vo=new Pn,go=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Sr(this,e),t=lo({near:1,far:5e8},t),this.left=t.left,this._left=void 0,this.right=t.right,this._right=void 0,this.top=t.top,this._top=void 0,this.bottom=t.bottom,this._bottom=void 0,this.near=t.near,this._near=this.near,this.far=t.far,this._far=this.far,this._cullingVolume=new eo([new Qi,new Qi,new Qi,new Qi,new Qi,new Qi]),this._perspectiveMatrix=new uo,this._infinitePerspective=new uo}return Pr(e,[{key:"clone",value:function(){return new e({right:this.right,left:this.left,top:this.top,bottom:this.bottom,near:this.near,far:this.far})}},{key:"equals",value:function(t){return t&&t instanceof e&&this.right===t.right&&this.left===t.left&&this.top===t.top&&this.bottom===t.bottom&&this.near===t.near&&this.far===t.far}},{key:"computeCullingVolume",value:function(e,t,r){zr(e,"position is required."),zr(t,"direction is required."),zr(r,"up is required.");var n=this._cullingVolume.planes;r=fo.copy(r).normalize();var i=ho.copy(t).cross(r).normalize(),o=po.copy(t).multiplyByScalar(this.near).add(e),a=yo.copy(t).multiplyByScalar(this.far).add(e),s=vo;return s.copy(i).multiplyByScalar(this.left).add(o).subtract(e).cross(r),n[0].fromPointNormal(e,s),s.copy(i).multiplyByScalar(this.right).add(o).subtract(e).cross(r).negate(),n[1].fromPointNormal(e,s),s.copy(r).multiplyByScalar(this.bottom).add(o).subtract(e).cross(i).negate(),n[2].fromPointNormal(e,s),s.copy(r).multiplyByScalar(this.top).add(o).subtract(e).cross(i),n[3].fromPointNormal(e,s),s=(new Pn).copy(t),n[4].fromPointNormal(o,s),s.negate(),n[5].fromPointNormal(a,s),this._cullingVolume}},{key:"getPixelDimensions",value:function(e,t,r,n){mo(this),zr(Number.isFinite(e)&&Number.isFinite(t)),zr(e>0),zr(t>0),zr(r>0),zr(n);var i=1/this.near,o=this.top*i,a=2*r*o/t,s=2*r*(o=this.right*i)/e;return n.x=s,n.y=a,n}},{key:"projectionMatrix",get:function(){return mo(this),this._perspectiveMatrix}},{key:"infiniteProjectionMatrix",get:function(){return mo(this),this._infinitePerspective}}]),e}();function mo(e){zr(Number.isFinite(e.right)&&Number.isFinite(e.left)&&Number.isFinite(e.top)&&Number.isFinite(e.bottom)&&Number.isFinite(e.near)&&Number.isFinite(e.far));var t=e.top,r=e.bottom,n=e.right,i=e.left,o=e.near,a=e.far;t===e._top&&r===e._bottom&&i===e._left&&n===e._right&&o===e._near&&a===e._far||(zr(e.near>0&&e.near<e.far,"near must be greater than zero and less than far."),e._left=i,e._right=n,e._top=t,e._bottom=r,e._near=o,e._far=a,e._perspectiveMatrix=(new uo).frustum({left:i,right:n,bottom:r,top:t,near:o,far:a}),e._infinitePerspective=(new uo).frustum({left:i,right:n,bottom:r,top:t,near:o,far:1/0}))}function bo(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function wo(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?bo(Object(r),!0).forEach((function(t){to(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):bo(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}!function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Sr(this,e),t=wo({near:1,far:5e8,xOffset:0,yOffset:0},t),this._offCenterFrustum=new go,this.fov=t.fov,this._fov=void 0,this._fovy=void 0,this._sseDenominator=void 0,this.aspectRatio=t.aspectRatio,this._aspectRatio=void 0,this.near=t.near,this._near=this.near,this.far=t.far,this._far=this.far,this.xOffset=t.xOffset,this._xOffset=this.xOffset,this.yOffset=t.yOffset,this._yOffset=this.yOffset}Pr(e,[{key:"clone",value:function(){return new e({aspectRatio:this.aspectRatio,fov:this.fov,near:this.near,far:this.far})}},{key:"equals",value:function(t){return null!=t&&t instanceof e&&(xo(this),xo(t),this.fov===t.fov&&this.aspectRatio===t.aspectRatio&&this.near===t.near&&this.far===t.far&&this._offCenterFrustum.equals(t._offCenterFrustum))}},{key:"computeCullingVolume",value:function(e,t,r){return xo(this),this._offCenterFrustum.computeCullingVolume(e,t,r)}},{key:"getPixelDimensions",value:function(e,t,r,n){return xo(this),this._offCenterFrustum.getPixelDimensions(e,t,r,n)}},{key:"projectionMatrix",get:function(){return xo(this),this._offCenterFrustum.projectionMatrix}},{key:"infiniteProjectionMatrix",get:function(){return xo(this),this._offCenterFrustum.infiniteProjectionMatrix}},{key:"fovy",get:function(){return xo(this),this._fovy}},{key:"sseDenominator",get:function(){return xo(this),this._sseDenominator}}])}();function xo(e){zr(Number.isFinite(e.fov)&&Number.isFinite(e.aspectRatio)&&Number.isFinite(e.near)&&Number.isFinite(e.far));var t=e._offCenterFrustum;e.fov===e._fov&&e.aspectRatio===e._aspectRatio&&e.near===e._near&&e.far===e._far&&e.xOffset===e._xOffset&&e.yOffset===e._yOffset||(zr(e.fov>=0&&e.fov<Math.PI),zr(e.aspectRatio>0),zr(e.near>=0&&e.near<e.far),e._aspectRatio=e.aspectRatio,e._fov=e.fov,e._fovy=e.aspectRatio<=1?e.fov:2*Math.atan(Math.tan(.5*e.fov)/e.aspectRatio),e._near=e.near,e._far=e.far,e._sseDenominator=2*Math.tan(.5*e._fovy),e._xOffset=e.xOffset,e._yOffset=e.yOffset,t.top=e.near*Math.tan(.5*e._fovy),t.bottom=-t.top,t.right=e.aspectRatio*t.top,t.left=-t.right,t.near=e.near,t.far=e.far,t.right+=e.xOffset,t.left+=e.xOffset,t.top+=e.yOffset,t.bottom+=e.yOffset)}new Pn,new Pn,new Pn,new Pn,new Pn,new Pn,new Pn,new Pn,new Pn,new Pn,new Pn,new Pn,Math.PI;var ko=.1,_o=1e-12,Oo=1e-15;Math.PI,Math.PI,Math.PI,Math.PI,new Xn,new Xn,new Xn,new Xn,new Xn;new Pn,new Pn,new Pn,new Pn,new Pn,new Xn,new Xn,new Xn;var To={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:"undefined"!=typeof global&&global};function So(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return Ao(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ao(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function Ao(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}(To.global||To.self||To.window).mathgl={config:Wr};var Po=function(){function e(t,r,n){c()(this,e),this.x=t,this.y=r,this.z=n}return w()(e,[{key:"update",value:function(e){var t=e.viewport,r=e.cullingVolume,n=e.elevationBounds,i=e.minZ,o=e.maxZ,a=e.offset,s=e.project,u=this.getBoundingVolume(n,a,s);if(r.computeVisibility(u)<0)return!1;if(!this.childVisible){var c=this.z;if(c<o&&c>=i){var l=u.distanceTo(t.cameraPosition)*t.scale/t.height;c+=Math.floor(Math.log2(l))}if(c>=o)return this.selected=!0,!0}this.selected=!1,this.childVisible=!0;var f,h=So(this.children);try{for(h.s();!(f=h.n()).done;){f.value.update(e)}}catch(e){h.e(e)}finally{h.f()}return!0}},{key:"getSelected",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(this.selected&&e.push(this),this._children){var t,r=So(this._children);try{for(r.s();!(t=r.n()).done;){var n=t.value;n.getSelected(e)}}catch(e){r.e(e)}finally{r.f()}}return e}},{key:"getBoundingVolume",value:function(e,t,r){if(r){var n=Ro(this.x,this.y,this.z),i=Ro(this.x+1,this.y+1,this.z),o=Ro(this.x+.5,this.y+.5,this.z);n.z=e[1],i.z=e[1],o.z=e[0];var a=r(n),s=r(i),u=new Pn(r(o)),c=Math.max(u.distance(a),u.distance(s));return new Fn(u,c)}var l=512/Math.pow(2,this.z),f=this.x*l+512*t,h=512-(this.y+1)*l;return new jn([f,h,e[0]],[f+l,h+l,e[1]])}},{key:"children",get:function(){if(!this._children){var t=2*this.x,r=2*this.y,n=this.z+1;this._children=[new e(t,r,n),new e(t,r+1,n),new e(t+1,r,n),new e(t+1,r+1,n)]}return this._children}}]),e}();var Eo=[-1/0,-1/0,1/0,1/0],Mo={type:"url",value:"",validate:function(e){return"string"==typeof e||Array.isArray(e)&&e.every((function(e){return"string"==typeof e}))},equals:function(e,t){if(e===t)return!0;if(!Array.isArray(e)||!Array.isArray(t))return!1;var r=e.length;if(r!==t.length)return!1;for(var n=0;n<r;n++)if(e[n]!==t[n])return!1;return!0}};function jo(e,t){var r=[t.transformPoint([e[0],e[1]]),t.transformPoint([e[2],e[1]]),t.transformPoint([e[0],e[3]]),t.transformPoint([e[2],e[3]])];return[Math.min.apply(Math,Or()(r.map((function(e){return e[0]})))),Math.min.apply(Math,Or()(r.map((function(e){return e[1]})))),Math.max.apply(Math,Or()(r.map((function(e){return e[0]})))),Math.max.apply(Math,Or()(r.map((function(e){return e[1]}))))]}function Io(e,t){if(!e||!e.length)return null;Array.isArray(e)&&(e=e[Math.abs(t.x+t.y)%e.length]);var r=t.x,n=t.y,i=t.z;return e.replace("{x}",r).replace("{y}",n).replace("{z}",i).replace("{-y}",Math.pow(2,i)-n-1)}function Lo(e){return Math.pow(2,e)}function Ro(e,t,r){var n=Lo(r),i=e/n*360-180,o=Math.PI-2*Math.PI*t/n;return[i,180/Math.PI*Math.atan(.5*(Math.exp(o)-Math.exp(-o)))]}function Co(e,t,r){var n=Lo(r);return[e/n*512,t/n*512]}function No(e,t,r,n){if(e.isGeospatial){var i=Ro(t,r,n),o=k()(i,2),a=o[0],s=o[1],u=Ro(t+1,r+1,n),c=k()(u,2);return{west:a,north:s,east:c[0],south:c[1]}}var l=Co(t,r,n),f=k()(l,2),h=f[0],p=f[1],d=Co(t+1,r+1,n),y=k()(d,2);return{left:h,top:p,right:y[0],bottom:y[1]}}function Do(e,t,r,n){for(var i=function(e,t,r){return r?jo(e,r).map((function(e){return e*t/512})):e.map((function(e){return e*t/512}))}(function(e,t,r){var n;if(t&&2===t.length){var i=k()(t,2),o=i[0],a=i[1],s=e.getBounds({z:o}),u=e.getBounds({z:a});n=[Math.min(s[0],u[0]),Math.min(s[1],u[1]),Math.max(s[2],u[2]),Math.max(s[3],u[3])]}else n=e.getBounds();return e.isGeospatial?[Math.max(n[0],r[0]),Math.max(n[1],r[1]),Math.min(n[2],r[2]),Math.min(n[3],r[3])]:[Math.max(Math.min(n[0],r[2]),r[0]),Math.max(Math.min(n[1],r[3]),r[1]),Math.min(Math.max(n[2],r[0]),r[2]),Math.min(Math.max(n[3],r[1]),r[3])]}(e,null,r),Lo(t),n),o=k()(i,4),a=o[0],s=o[1],u=o[2],c=o[3],l=[],f=Math.floor(a);f<u;f++)for(var h=Math.floor(s);h<c;h++)l.push({x:f,y:h,z:t});return l}function Uo(e){var t=e.viewport,r=e.maxZoom,n=e.minZoom,i=e.zRange,o=e.extent,a=e.tileSize,s=void 0===a?512:a,u=e.modelMatrix,c=e.modelMatrixInverse,l=Math.round(t.zoom+Math.log2(512/s));if(Number.isFinite(n)&&l<n){if(!o)return[];l=n}Number.isFinite(r)&&l>r&&(l=r);var f=o;return u&&c&&o&&!t.isGeospatial&&(f=jo(o,u)),t.isGeospatial?function(e,t,r){var n=e.resolution?e.projectPosition:null,i=Object.values(e.getFrustumPlanes()).map((function(e){var t=e.normal,r=e.distance;return new Qi(t.clone().negate(),r)})),o=new eo(i),a=e.distanceScales.unitsPerMeter[2],s=r&&r[0]*a||0,u=r&&r[1]*a||0,c=e.pitch<=60?t:0,l=new Po(0,0,0),f={viewport:e,project:n,cullingVolume:o,elevationBounds:[s,u],minZ:c,maxZ:t,offset:0};if(l.update(f),e.subViewports&&e.subViewports.length>1){for(f.offset=-1;l.update(f)&&!(--f.offset<-3););for(f.offset=1;l.update(f)&&!(++f.offset>3););}return l.getSelected()}(t,l,i):Do(t,l,f||Eo,c)}function Fo(){var e;if("undefined"!=typeof window&&window.performance)e=window.performance.now();else if("undefined"!=typeof process&&process.hrtime){var t=process.hrtime();e=1e3*t[0]+t[1]/1e6}else e=Date.now();return e}var Bo=function(){function e(t,r){Le(this,e),this.name=t,this.type=r,this.sampleSize=1,this.reset()}return Ce(e,[{key:"setSampleSize",value:function(e){return this.sampleSize=e,this}},{key:"incrementCount",value:function(){return this.addCount(1),this}},{key:"decrementCount",value:function(){return this.subtractCount(1),this}},{key:"addCount",value:function(e){return this._count+=e,this._samples++,this._checkSampling(),this}},{key:"subtractCount",value:function(e){return this._count-=e,this._samples++,this._checkSampling(),this}},{key:"addTime",value:function(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}},{key:"timeStart",value:function(){return this._startTime=Fo(),this._timerPending=!0,this}},{key:"timeEnd",value:function(){return this._timerPending?(this.addTime(Fo()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}},{key:"getSampleAverageCount",value:function(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}},{key:"getSampleAverageTime",value:function(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}},{key:"getSampleHz",value:function(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}},{key:"getAverageCount",value:function(){return this.samples>0?this.count/this.samples:0}},{key:"getAverageTime",value:function(){return this.samples>0?this.time/this.samples:0}},{key:"getHz",value:function(){return this.time>0?this.samples/(this.time/1e3):0}},{key:"reset",value:function(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}},{key:"_checkSampling",value:function(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}]),e}(),Vo=function(){function e(t){var r=t.id,n=t.stats;Le(this,e),this.id=r,this.stats={},this._initializeStats(n),Object.seal(this)}return Ce(e,[{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"count";return this._getOrCreate({name:e,type:t})}},{key:"reset",value:function(){for(var e in this.stats)this.stats[e].reset();return this}},{key:"forEach",value:function(e){for(var t in this.stats)e(this.stats[t])}},{key:"getTable",value:function(){var e={};return this.forEach((function(t){e[t.name]={time:t.time||0,count:t.count||0,average:t.getAverageTime()||0,hz:t.getHz()||0}})),e}},{key:"_initializeStats",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t.forEach((function(t){return e._getOrCreate(t)}))}},{key:"_getOrCreate",value:function(e){if(!e||!e.name)return null;var t=e.name,r=e.type;return this.stats[t]||(this.stats[t]=e instanceof Bo?e:new Bo(t,r)),this.stats[t]}},{key:"size",get:function(){return Object.keys(this.stats).length}}]),e}();function zo(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function qo(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?zo(Object(r),!0).forEach((function(t){$(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):zo(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Go={id:"request-scheduler",throttleRequests:!0,maxRequests:6},Wo=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Le(this,e),this.props=qo(qo({},Go),t),this.requestQueue=[],this.activeRequestCount=0,this.requestMap=new Map,this.stats=new Vo({id:t.id}),this.stats.get("Queued Requests"),this.stats.get("Active Requests"),this.stats.get("Cancelled Requests"),this.stats.get("Queued Requests Ever"),this.stats.get("Active Requests Ever"),this._deferredUpdate=null}return Ce(e,[{key:"scheduleRequest",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return 0};if(!this.props.throttleRequests)return Promise.resolve({done:function(){}});if(this.requestMap.has(e))return this.requestMap.get(e);var r={handle:e,getPriority:t},n=new Promise((function(e){return r.resolve=e,r}));return this.requestQueue.push(r),this.requestMap.set(e,n),this._issueNewRequests(),n}},{key:"_issueRequest",value:function(e){var t=this,r=e.handle,n=e.resolve,i=!1,o=function(){i||(i=!0,t.requestMap.delete(r),t.activeRequestCount--,t._issueNewRequests())};return this.activeRequestCount++,n?n({done:o}):Promise.resolve({done:o})}},{key:"_issueNewRequests",value:function(){var e=this;this._deferredUpdate||(this._deferredUpdate=setTimeout((function(){return e._issueNewRequestsAsync()}),0))}},{key:"_issueNewRequestsAsync",value:function(){this._deferredUpdate=null;var e=Math.max(this.props.maxRequests-this.activeRequestCount,0);if(0!==e){this._updateAllRequests();for(var t=0;t<e;++t)if(this.requestQueue.length>0){var r=this.requestQueue.shift();this._issueRequest(r)}}}},{key:"_updateAllRequests",value:function(){for(var e=this.requestQueue,t=0;t<e.length;++t){var r=e[t];this._updateRequest(r)||(e.splice(t,1),this.requestMap.delete(r.handle),t--)}e.sort((function(e,t){return e.priority-t.priority}))}},{key:"_updateRequest",value:function(e){return e.priority=e.getPriority(e.handle),!(e.priority<0)||(e.resolve(null),!1)}}]),e}();function Ho(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return Zo(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Zo(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function Zo(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Qo=function(){function e(t){var r=this;c()(this,e),this.opts=t,this._getTileData=t.getTileData,this.onTileError=t.onTileError,this.onTileLoad=function(e){t.onTileLoad(e),r.opts.maxCacheByteSize&&(r._cacheByteSize+=e.byteLength,r._resizeCache())},this.onTileUnload=t.onTileUnload,this._requestScheduler=new Wo({maxRequests:t.maxRequests,throttleRequests:t.maxRequests>0}),this._cache=new Map,this._tiles=[],this._dirty=!1,this._cacheByteSize=0,this._viewport=null,this._selectedTiles=null,this._frameNumber=0,this.setOptions(t)}return w()(e,[{key:"setOptions",value:function(e){Object.assign(this.opts,e),Number.isFinite(e.maxZoom)&&(this._maxZoom=Math.floor(e.maxZoom)),Number.isFinite(e.minZoom)&&(this._minZoom=Math.ceil(e.minZoom))}},{key:"finalize",value:function(){var e,t=Ho(this._cache.values());try{for(t.s();!(e=t.n()).done;){var r=e.value;r.isLoading&&r.abort()}}catch(e){t.e(e)}finally{t.f()}}},{key:"update",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.zRange,i=r.modelMatrix,o=new uo(i),a=!o.equals(this._modelMatrix);if(!e.equals(this._viewport)||a){a&&(this._modelMatrixInverse=i&&o.clone().invert(),this._modelMatrix=i&&o),this._viewport=e;var s=this.getTileIndices({viewport:e,maxZoom:this._maxZoom,minZoom:this._minZoom,zRange:n,modelMatrix:this._modelMatrix,modelMatrixInverse:this._modelMatrixInverse});this._selectedTiles=s.map((function(e){return t._getTile(e,!0)})),this._dirty&&this._rebuildTree()}var u=this.updateTileStates();return this._dirty&&this._resizeCache(),u&&this._frameNumber++,this._frameNumber}},{key:"getTileIndices",value:function(e){var t=e.viewport,r=e.maxZoom,n=e.minZoom,i=e.zRange,o=e.modelMatrix,a=e.modelMatrixInverse,s=this.opts;return Uo({viewport:t,maxZoom:r,minZoom:n,zRange:i,tileSize:s.tileSize,extent:s.extent,modelMatrix:o,modelMatrixInverse:a})}},{key:"getTileMetadata",value:function(e){var t=e.x,r=e.y,n=e.z;return{bbox:No(this._viewport,t,r,n)}}},{key:"getParentIndex",value:function(e){return e.x=Math.floor(e.x/2),e.y=Math.floor(e.y/2),e.z-=1,e}},{key:"updateTileStates",value:function(){this._updateTileStates(this.selectedTiles);var e,t=this.opts.maxRequests,r=[],n=0,i=!1,o=Ho(this._cache.values());try{for(o.s();!(e=o.n()).done;){var a=e.value,s=Boolean(1&a.state);a.isVisible!==s&&(i=!0,a.isVisible=s),a.isSelected=5===a.state,a.isLoading&&(n++,a.isSelected||r.push(a))}}catch(e){o.e(e)}finally{o.f()}if(t>0)for(;n>t&&r.length>0;){r.shift().abort(),n--}return i}},{key:"_rebuildTree",value:function(){var e,t=this._cache,r=Ho(t.values());try{for(r.s();!(e=r.n()).done;){var n=e.value;n.parent=null,n.children.length=0}}catch(e){r.e(e)}finally{r.f()}var i,o=Ho(t.values());try{for(o.s();!(i=o.n()).done;){var a=i.value,s=this._getNearestAncestor(a.x,a.y,a.z);a.parent=s,s&&s.children.push(a)}}catch(e){o.e(e)}finally{o.f()}}},{key:"_updateTileStates",value:function(e){var t,r=this._cache,n=this.opts.refinementStrategy||"best-available",i=Ho(r.values());try{for(i.s();!(t=i.n()).done;){t.value.state=0}}catch(e){i.e(e)}finally{i.f()}var o,a=Ho(e);try{for(a.s();!(o=a.n()).done;){o.value.state=5}}catch(e){a.e(e)}finally{a.f()}if("never"!==n){var s,u=Ho(e);try{for(u.s();!(s=u.n()).done;){Yo(s.value,n)}}catch(e){u.e(e)}finally{u.f()}var c,l=Ho(e);try{for(l.s();!(c=l.n()).done;){var f=c.value;Ko(f)&&Jo(f)}}catch(e){l.e(e)}finally{l.f()}}}},{key:"_resizeCache",value:function(){var e=this._cache,t=this.opts,r=t.maxCacheSize||(t.maxCacheByteSize?1/0:5*this.selectedTiles.length),n=t.maxCacheByteSize||1/0;if(e.size>r||this._cacheByteSize>n){var i,o=Ho(e);try{for(o.s();!(i=o.n()).done;){var a=k()(i.value,2),s=a[0],u=a[1];if(u.isVisible||(this._cacheByteSize-=t.maxCacheByteSize?u.byteLength:0,e.delete(s),this.onTileUnload(u)),e.size<=r&&this._cacheByteSize<=n)break}}catch(e){o.e(e)}finally{o.f()}this._rebuildTree(),this._dirty=!0}this._dirty&&(this._tiles=Array.from(this._cache.values()).sort((function(e,t){return e.z-t.z})),this._dirty=!1)}},{key:"_getTile",value:function(e,t){var r=e.x,n=e.y,i=e.z,o="".concat(r,",").concat(n,",").concat(i),a=this._cache.get(o);return!a&&t?(a=new kr({x:r,y:n,z:i,onTileLoad:this.onTileLoad,onTileError:this.onTileError}),Object.assign(a,this.getTileMetadata(a)),a.loadData(this._getTileData,this._requestScheduler),this._cache.set(o,a),this._dirty=!0):a&&a.isCancelled&&!a.isLoading&&a.loadData(this._getTileData,this._requestScheduler),a}},{key:"_getNearestAncestor",value:function(e,t,r){for(var n=this._minZoom,i=void 0===n?0:n,o={x:e,y:t,z:r};o.z>i;){o=this.getParentIndex(o);var a=this._getTile(o);if(a)return a}return null}},{key:"tiles",get:function(){return this._tiles}},{key:"selectedTiles",get:function(){return this._selectedTiles}},{key:"isLoaded",get:function(){return this._selectedTiles.every((function(e){return e.isLoaded}))}}]),e}();function Ko(e){for(var t=e;t;){if(!1&t.state)return!0;if(t.isLoaded)return!1;t=t.parent}return!0}function Yo(e,t){for(var r,n=3;r=e.parent;){if(e.isLoaded&&(n=4,"best-available"===t))return;r.state=Math.max(r.state,n),e=r}}function Jo(e){var t,r=Ho(e.children);try{for(r.s();!(t=r.n()).done;){var n=t.value;n.state=Math.max(n.state,3),n.isLoaded||Jo(n)}}catch(e){r.e(e)}finally{r.f()}}function $o(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return p()(this,r)}}function Xo(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ea(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Xo(Object(r),!0).forEach((function(t){D()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Xo(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var ta={data:[],dataComparator:Mo.equals,renderSubLayers:{type:"function",value:function(e){return new v.GeoJsonLayer(e)},compare:!1},getTileData:{type:"function",optional:!0,value:null,compare:!1},onViewportLoad:{type:"function",optional:!0,value:null,compare:!1},onTileLoad:{type:"function",value:function(e){},compare:!1},onTileUnload:{type:"function",value:function(e){},compare:!1},onTileError:{type:"function",value:function(e){return console.error(e)},compare:!1},extent:{type:"array",optional:!0,value:null,compare:!0},tileSize:512,maxZoom:null,minZoom:0,maxCacheSize:null,maxCacheByteSize:null,refinementStrategy:"best-available",zRange:null,fetch:{type:"function",value:function(e,t){var r=t.layer,n=t.signal,i=ea({},r.getLoadOptions());return i.fetch=ea(ea({},i.fetch),{},{signal:n}),mr(e,i)},compare:!1},maxRequests:6},ra=function(e){f()(r,e);var t=$o(r);function r(){return c()(this,r),t.apply(this,arguments)}return w()(r,[{key:"initializeState",value:function(){this.state={tileset:null,isLoaded:!1}}},{key:"finalizeState",value:function(){var e=this.state.tileset;e&&e.finalize()}},{key:"shouldUpdateState",value:function(e){return e.changeFlags.somethingChanged}},{key:"updateState",value:function(e){var t=e.props,r=(e.oldProps,e.context,e.changeFlags),n=this.state.tileset;if(!n||r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getTileData)){n&&n.finalize();var i=Number.isFinite(this.state.maxZoom)?this.state.maxZoom:t.maxZoom,o=Number.isFinite(this.state.minZoom)?this.state.minZoom:t.minZoom,a=t.tileSize,s=t.maxCacheSize,u=t.maxCacheByteSize,c=t.refinementStrategy,l=t.extent,f=t.maxRequests;n=new Qo({getTileData:this.getTileData.bind(this),maxCacheSize:s,maxCacheByteSize:u,maxZoom:i,minZoom:o,tileSize:a,refinementStrategy:c,extent:l,onTileLoad:this._onTileLoad.bind(this),onTileError:this._onTileError.bind(this),onTileUnload:this._onTileUnload.bind(this),maxRequests:f}),this.setState({tileset:n})}else(r.propsChanged||r.updateTriggersChanged)&&(n.setOptions(t),this.state.tileset.tiles.forEach((function(e){e.layers=null})));this._updateTileset()}},{key:"_updateTileset",value:function(){var e=this.state.tileset,t=this.props,r=t.zRange,n=t.modelMatrix,i=e.update(this.context.viewport,{zRange:r,modelMatrix:n}),o=e.isLoaded,a=this.state.isLoaded!==o,s=this.state.frameNumber!==i;o&&(a||s)&&this._onViewportLoad(),s&&this.setState({frameNumber:i}),this.state.isLoaded=o}},{key:"_onViewportLoad",value:function(){var e=this.state.tileset,t=this.props.onViewportLoad;t&&t(e.selectedTiles)}},{key:"_onTileLoad",value:function(e){this.getCurrentLayer().props.onTileLoad(e),e.isVisible&&this.setNeedsUpdate()}},{key:"_onTileError",value:function(e,t){var r=this.getCurrentLayer();r.props.onTileError(e),r._updateTileset(),t.isVisible&&this.setNeedsUpdate()}},{key:"_onTileUnload",value:function(e){this.getCurrentLayer().props.onTileUnload(e)}},{key:"getTileData",value:function(e){var t=this.props.data,r=this.getCurrentLayer().props,n=r.getTileData,i=r.fetch,o=e.signal;return e.url=Io(t,e),n?n(e):e.url?i(e.url,{layer:this,signal:o}):null}},{key:"renderSubLayers",value:function(e){return this.props.renderSubLayers(e)}},{key:"getHighlightedObjectIndex",value:function(){return-1}},{key:"getPickingInfo",value:function(e){var t=e.info,r=e.sourceLayer;return t.sourceLayer=r,t.tile=r.props.tile,t}},{key:"renderLayers",value:function(){var e=this,t=this.props.visible;return this.state.tileset.tiles.map((function(r){var n=t&&r.isVisible,i=e.getHighlightedObjectIndex(r);if(r.isLoaded)if(r.layers)!r.layers[0]||r.layers[0].props.visible===n&&r.layers[0].props.highlightedObjectIndex===i||(r.layers=r.layers.map((function(e){return e.clone({visible:n,highlightedObjectIndex:i})})));else{var o=e.renderSubLayers(Object.assign({},e.props,{id:"".concat(e.id,"-").concat(r.x,"-").concat(r.y,"-").concat(r.z),data:r.data,visible:n,_offset:0,tile:r,highlightedObjectIndex:i}));r.layers=Object(v._flatten)(o,Boolean)}else;return r.layers}))}},{key:"isLoaded",get:function(){return this.state.tileset.selectedTiles.every((function(e){return e.layers&&e.layers.every((function(e){return e.isLoaded}))}))}}]),r}(v.CompositeLayer);ra.layerName="TileLayer",ra.defaultProps=ta;var na=r(9),ia=r.n(na);function oa(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return p()(this,r)}}var aa=function(e){f()(r,e);var t=oa(r);function r(){return c()(this,r),t.apply(this,arguments)}return w()(r,[{key:"getShaders",value:function(){var e=ia()(y()(r.prototype),"getShaders",this).call(this);return e.inject={"vs:#decl":"uniform float trailLength;\nattribute float instanceTimestamps;\nattribute float instanceNextTimestamps;\nvarying float vTime;\n","vs:#main-end":"vTime = instanceTimestamps + (instanceNextTimestamps - instanceTimestamps) * vPathPosition.y / vPathLength;\n","fs:#decl":"uniform float trailLength;\nuniform float currentTime;\nvarying float vTime;\n","fs:#main-start":"if(vTime > currentTime || vTime < currentTime - trailLength) {\n  discard;\n}\n","fs:DECKGL_FILTER_COLOR":"color.a *= 1.0 - (currentTime - vTime) / trailLength;"},e}},{key:"initializeState",value:function(e){ia()(y()(r.prototype),"initializeState",this).call(this,e),this.getAttributeManager().addInstanced({timestamps:{size:1,accessor:"getTimestamps",shaderAttributes:{instanceTimestamps:{vertexOffset:0},instanceNextTimestamps:{vertexOffset:1}}}})}},{key:"draw",value:function(e){var t=this.props,n=t.trailLength,i=t.currentTime;e.uniforms=Object.assign({},e.uniforms,{trailLength:n,currentTime:i}),ia()(y()(r.prototype),"draw",this).call(this,e)}}]),r}(v.PathLayer);aa.layerName="TripsLayer",aa.defaultProps={trailLength:{type:"number",value:120,min:0},currentTime:{type:"number",value:0,min:0},getTimestamps:{type:"accessor",value:null}};var sa=r(8);function ua(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return ca(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ca(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function ca(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function la(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return p()(this,r)}}var fa=Object.assign({getHexagons:{type:"accessor",value:function(e){return e.hexagons}}},v.PolygonLayer.defaultProps),ha=function(e){f()(r,e);var t=la(r);function r(){return c()(this,r),t.apply(this,arguments)}return w()(r,[{key:"updateState",value:function(e){var t=e.props,r=(e.oldProps,e.changeFlags);if(r.dataChanged||r.updateTriggers&&r.updateTriggers.getHexagons){var n,i=t.data,o=t.getHexagons,a=[],s=Object(v.createIterable)(i),u=s.iterable,c=s.objectInfo,l=ua(u);try{for(l.s();!(n=l.n()).done;){var f=n.value;c.index++;var h,p=o(f,c),d=ua(Object(sa.h3SetToMultiPolygon)(p,!0));try{for(d.s();!(h=d.n()).done;){var y=h.value;a.push(this.getSubLayerRow({polygon:y},f,c.index))}}catch(e){d.e(e)}finally{d.f()}}}catch(e){l.e(e)}finally{l.f()}this.setState({polygons:a})}}},{key:"renderLayers",value:function(){var e=this.props,t=e.elevationScale,r=e.extruded,n=e.wireframe,i=e.filled,o=e.stroked,a=e.lineWidthScale,s=e.lineWidthMinPixels,u=e.lineWidthMaxPixels,c=e.lineJointRounded,l=e.lineMiterLimit,f=e.lineDashJustified,h=e.material,p=e.getFillColor,d=e.getLineColor,y=e.getLineWidth,g=e.getLineDashArray,m=e.getElevation,b=e.transitions,w=e.updateTriggers;return new(this.getSubLayerClass("cluster-region",v.PolygonLayer))({filled:i,wireframe:n,extruded:r,elevationScale:t,stroked:o,lineWidthScale:a,lineWidthMinPixels:s,lineWidthMaxPixels:u,lineJointRounded:c,lineMiterLimit:l,lineDashJustified:f,material:h,transitions:b,getFillColor:this.getSubLayerAccessor(p),getLineColor:this.getSubLayerAccessor(d),getLineWidth:this.getSubLayerAccessor(y),getLineDashArray:this.getSubLayerAccessor(g),getElevation:this.getSubLayerAccessor(m)},this.getSubLayerProps({id:"cluster-region",updateTriggers:w}),{data:this.state.polygons,getPolygon:function(e){return e.polygon}})}}]),r}(v.CompositeLayer);ha.defaultProps=fa,ha.layerName="H3ClusterLayer";var pa=r(23),da=r.n(pa);function ya(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return p()(this,r)}}function va(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return ga(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ga(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function ga(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ma(e,t){t=void 0===t?e[0][0]:t;var r,n=va(e);try{for(n.s();!(r=n.n()).done;){var i=r.value,o=i[0]-t;o>180?i[0]-=360:o<-180&&(i[0]+=360)}}catch(e){n.e(e)}finally{n.f()}}function ba(e,t,r){var n=Object(sa.h3ToGeo)(e),i=k()(n,2),o=i[0],a=i[1],s=t.length;ma(t,a);for(var u=t[0]===t[s-1]?s-1:s,c=0;c<u;c++)t[c][0]=en(a,t[c][0],r),t[c][1]=en(o,t[c][1],r)}function wa(e,t,r){var n=e(t,r),i=Object(sa.h3ToGeo)(n),o=k()(i,2),a=o[0];return[o[1],a]}function xa(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0,n=Object(sa.h3ToGeoBoundary)(e,!0);if(1!==t?ba(e,n,t):ma(n),r){var i,o=new Float64Array(2*n.length),a=0,s=va(n);try{for(s.s();!(i=s.n()).done;){var u=i.value;o[a++]=u[0],o[a++]=u[1]}}catch(e){s.e(e)}finally{s.f()}return o}return n}var ka=Object.assign({},v.PolygonLayer.defaultProps,{highPrecision:!1,coverage:{type:"number",min:0,max:1,value:1},centerHexagon:null,getHexagon:{type:"accessor",value:function(e){return e.hexagon}},extruded:!0});delete ka.getLineDashArray;var _a=function(e){f()(r,e);var t=ya(r);function r(){return c()(this,r),t.apply(this,arguments)}return w()(r,[{key:"shouldUpdateState",value:function(e){var t=e.changeFlags;return this._shouldUseHighPrecision()?t.propsOrDataChanged:t.somethingChanged}},{key:"updateState",value:function(e){var t=e.props,r=(e.oldProps,e.changeFlags);if(r.dataChanged||r.updateTriggers&&r.updateTriggers.getHexagon){var n,i=-1,o=!1,a=!1,s=Object(v.createIterable)(t.data),u=s.iterable,c=s.objectInfo,l=va(u);try{for(l.s();!(n=l.n()).done;){var f=n.value;c.index++;var h=t.getHexagon(f,c),p=Object(sa.h3GetResolution)(h);if(i<0)i=p;else if(i!==p){a=!0;break}if(Object(sa.h3IsPentagon)(h)){o=!0;break}}}catch(e){l.e(e)}finally{l.f()}this.setState({resolution:i,edgeLengthKM:i>=0?Object(sa.edgeLength)(i,sa.UNITS.km):0,hasMultipleRes:a,hasPentagon:o})}this._updateVertices(this.context.viewport)}},{key:"_shouldUseHighPrecision",value:function(){var e=this.state,t=e.resolution,r=e.hasPentagon,n=e.hasMultipleRes,i=this.context.viewport;return this.props.highPrecision||i.resolution||n||r||t>=0&&t<=5}},{key:"_updateVertices",value:function(e){if(!this._shouldUseHighPrecision()){var t=this.state,r=t.resolution,n=t.edgeLengthKM,i=t.centerHex;if(!(r<0)){var o=this.props.centerHexagon||Object(sa.geoToH3)(e.latitude,e.longitude,r);if(i!==o){if(i){var a=Object(sa.h3Distance)(i,o);if(a>=0&&a*n<10)return}var s=e.distanceScales.unitsPerMeter,u=xa(o),c=Object(sa.h3ToGeo)(o),l=k()(c,2),f=l[0],h=l[1],p=e.projectFlat([h,f]),d=k()(p,2),y=d[0],v=d[1];u=u.map((function(t){var r=e.projectFlat(t);return[(r[0]-y)/s[0],(r[1]-v)/s[1]]})),this.setState({centerHex:o,vertices:u})}}}}},{key:"renderLayers",value:function(){return this._shouldUseHighPrecision()?this._renderPolygonLayer():this._renderColumnLayer()}},{key:"_getForwardProps",value:function(){var e=this.props,t=e.elevationScale,r=e.material,n=e.coverage,i=e.extruded,o=e.wireframe,a=e.stroked,s=e.filled,u=e.lineWidthUnits,c=e.lineWidthScale,l=e.lineWidthMinPixels,f=e.lineWidthMaxPixels,h=e.getFillColor,p=e.getElevation,d=e.getLineColor,y=e.getLineWidth,v=e.transitions,g=e.updateTriggers;return{elevationScale:t,extruded:i,coverage:n,wireframe:o,stroked:a,filled:s,lineWidthUnits:u,lineWidthScale:c,lineWidthMinPixels:l,lineWidthMaxPixels:f,material:r,getElevation:p,getFillColor:h,getLineColor:d,getLineWidth:y,transitions:v,updateTriggers:{getFillColor:g.getFillColor,getElevation:g.getElevation,getLineColor:g.getLineColor,getLineWidth:g.getLineWidth}}}},{key:"_renderPolygonLayer",value:function(){var e=this.props,t=e.data,r=e.getHexagon,n=e.updateTriggers,i=e.coverage,o=this.getSubLayerClass("hexagon-cell-hifi",v.PolygonLayer),a=this._getForwardProps();return a.updateTriggers.getPolygon=function(e,t){return null==e?t:"object"===da()(e)?Object.assign({},e,{coverage:t}):{getHexagon:e,coverage:t}}(n.getHexagon,i),new o(a,this.getSubLayerProps({id:"hexagon-cell-hifi",updateTriggers:a.updateTriggers}),{data:t,_normalize:!1,_windingOrder:"CCW",positionFormat:"XY",getPolygon:function(e,t){return xa(r(e,t),i,!0)}})}},{key:"_renderColumnLayer",value:function(){var e=this.props,t=e.data,r=e.getHexagon,n=e.updateTriggers,i=this.getSubLayerClass("hexagon-cell",v.ColumnLayer),o=this._getForwardProps();return o.updateTriggers.getPosition=n.getHexagon,new i(o,this.getSubLayerProps({id:"hexagon-cell",updateTriggers:o.updateTriggers}),{data:t,diskResolution:6,radius:1,vertices:this.state.vertices,getPosition:wa.bind(null,r)})}}]),r}(v.CompositeLayer);_a.defaultProps=ka,_a.layerName="H3HexagonLayer";var Oa=r(27);function Ta(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Sa(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){i=!0,o=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw o}}return r}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Ta(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ta(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Aa(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Pa(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ea(e,t,r){return t&&Pa(e.prototype,t),r&&Pa(e,r),e}Math.max(6378137,6378137,6356752.314245179);var Ma=function(e){return e},ja=new Pn;function Ia(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ma;return Qr(e)?(t[0]=r(e[0]),t[1]=r(e[1]),t[2]=e[2]):"longitude"in e?(t[0]=r(e.longitude),t[1]=r(e.latitude),t[2]=e.height):(t[0]=r(e.x),t[1]=r(e.y),t[2]=e.z),t}function La(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ja;return Ia(e,t,Wr._cartographicRadians?Ma:Yr)}function Ra(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ma;return Qr(t)?(t[0]=r(e[0]),t[1]=r(e[1]),t[2]=e[2]):"longitude"in t?(t.longitude=r(e[0]),t.latitude=r(e[1]),t.height=e[2]):(t.x=r(e[0]),t.y=r(e[1]),t.z=e[2]),t}function Ca(e,t){return Ra(e,t,Wr._cartographicRadians?Ma:Jr)}var Na=new Pn,Da=new Pn,Ua=new Pn;var Fa=new Pn,Ba={up:{south:"east",north:"west",west:"south",east:"north"},down:{south:"west",north:"east",west:"north",east:"south"},south:{up:"west",down:"east",west:"down",east:"up"},north:{up:"east",down:"west",west:"up",east:"down"},west:{up:"north",down:"south",north:"down",south:"up"},east:{up:"south",down:"north",north:"up",south:"down"}},Va={north:[-1,0,0],east:[0,1,0],up:[0,0,1],south:[1,0,0],west:[0,-1,0],down:[0,0,-1]},za={east:new Pn,north:new Pn,up:new Pn,west:new Pn,south:new Pn,down:new Pn},qa=new Pn,Ga=new Pn,Wa=new Pn;function Ha(e,t,r,n,i,o){var a,s,u,c=Ba[t]&&Ba[t][r];zr(c&&(!n||n===c));var l=Fa.copy(i);if(tn(l.x,0,1e-14)&&tn(l.y,0,1e-14)){var f=Math.sign(l.z);a=qa.fromArray(Va[t]),"east"!==t&&"west"!==t&&a.scale(f),s=Ga.fromArray(Va[r]),"east"!==r&&"west"!==r&&s.scale(f),u=Wa.fromArray(Va[n]),"east"!==n&&"west"!==n&&u.scale(f)}else{var h=za.up,p=za.east,d=za.north;p.set(-l.y,l.x,0).normalize(),e.geodeticSurfaceNormal(l,h),d.copy(h).cross(p);var y=za.west,v=za.south;za.down.copy(h).scale(-1),y.copy(p).scale(-1),v.copy(d).scale(-1),a=za[t],s=za[r],u=za[n]}return o[0]=a.x,o[1]=a.y,o[2]=a.z,o[3]=0,o[4]=s.x,o[5]=s.y,o[6]=s.z,o[7]=0,o[8]=u.x,o[9]=u.y,o[10]=u.z,o[11]=0,o[12]=l.x,o[13]=l.y,o[14]=l.z,o[15]=1,o}var Za,Qa=new Pn,Ka=new Pn,Ya=new Pn,Ja=new Pn,$a=new Pn,Xa=new Pn,es=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;Aa(this,e),zr(t>=0),zr(r>=0),zr(n>=0),this.radii=new Pn(t,r,n),this.radiiSquared=new Pn(t*t,r*r,n*n),this.radiiToTheFourth=new Pn(t*t*t*t,r*r*r*r,n*n*n*n),this.oneOverRadii=new Pn(0===t?0:1/t,0===r?0:1/r,0===n?0:1/n),this.oneOverRadiiSquared=new Pn(0===t?0:1/(t*t),0===r?0:1/(r*r),0===n?0:1/(n*n)),this.minimumRadius=Math.min(t,r,n),this.maximumRadius=Math.max(t,r,n),this.centerToleranceSquared=ko,0!==this.radiiSquared.z&&(this.squaredXOverSquaredZ=this.radiiSquared.x/this.radiiSquared.z),Object.freeze(this)}return Ea(e,null,[{key:"WGS84",get:function(){return Za=Za||new e(6378137,6378137,6356752.314245179)}}]),Ea(e,[{key:"equals",value:function(e){return this===e||Boolean(e&&this.radii.equals(e.radii))}},{key:"toString",value:function(){return this.radii.toString()}},{key:"cartographicToCartesian",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0],r=Ka,n=Ya,i=Sa(e,3),o=i[2];this.geodeticSurfaceNormalCartographic(e,r),n.copy(this.radiiSquared).scale(r);var a=Math.sqrt(r.dot(n));return n.scale(1/a),r.scale(o),n.add(r),n.to(t)}},{key:"cartesianToCartographic",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];Xa.from(e);var r=this.scaleToGeodeticSurface(Xa,Ja);if(r){var n=this.geodeticSurfaceNormal(r,Ka),i=$a;i.copy(Xa).subtract(r);var o=Math.atan2(n.y,n.x),a=Math.asin(n.z),s=Math.sign(gn(i,Xa))*dn(i);return Ca([o,a,s],t)}}},{key:"eastNorthUpToFixedFrame",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new uo;return Ha(this,"east","north","up",e,t)}},{key:"localFrameToFixedFrame",value:function(e,t,r,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new uo;return Ha(this,e,t,r,n,i)}},{key:"geocentricSurfaceNormal",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return Qa.from(e).normalize().to(t)}},{key:"geodeticSurfaceNormalCartographic",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0],r=La(e),n=r[0],i=r[1],o=Math.cos(i);return Qa.set(o*Math.cos(n),o*Math.sin(n),Math.sin(i)).normalize(),Qa.to(t)}},{key:"geodeticSurfaceNormal",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return Qa.from(e).scale(this.oneOverRadiiSquared).normalize().to(t)}},{key:"scaleToGeodeticSurface",value:function(e,t){return function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Pn,n=t.oneOverRadii,i=t.oneOverRadiiSquared,o=t.centerToleranceSquared;Na.from(e);var a=e.x,s=e.y,u=e.z,c=n.x,l=n.y,f=n.z,h=a*a*c*c,p=s*s*l*l,d=u*u*f*f,y=h+p+d,v=Math.sqrt(1/y);if(Number.isFinite(v)){var g=Da;if(g.copy(e).scale(v),y<o)return g.to(r);var m=i.x,b=i.y,w=i.z,x=Ua;x.set(g.x*m*2,g.y*b*2,g.z*w*2);var k,_,O,T,S=(1-v)*e.len()/(.5*x.len()),A=0;do{var P=(k=1/(1+(S-=A)*m))*k,E=(_=1/(1+S*b))*_,M=(O=1/(1+S*w))*O,j=P*k,I=E*_,L=M*O,R=h*j*m+p*I*b+d*L*w,C=-2*R;A=(T=h*P+p*E+d*M-1)/C}while(Math.abs(T)>_o);return Na.scale([k,_,O]).to(r)}}(e,this,t)}},{key:"scaleToGeocentricSurface",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];Ja.from(e);var r=Ja.x,n=Ja.y,i=Ja.z,o=this.oneOverRadiiSquared,a=1/Math.sqrt(r*r*o.x+n*n*o.y+i*i*o.z);return Ja.multiplyScalar(a).to(t)}},{key:"transformPositionToScaledSpace",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return Ja.from(e).scale(this.oneOverRadii).to(t)}},{key:"transformPositionFromScaledSpace",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return Ja.from(e).scale(this.radii).to(t)}},{key:"getSurfaceNormalIntersectionWithZAxis",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0,0];zr(tn(this.radii.x,this.radii.y,Oo)),zr(this.radii.z>0),Ja.from(e);var n=Ja.z*(1-this.squaredXOverSquaredZ);if(!(Math.abs(n)>=this.radii.z-t))return Ja.set(0,0,n).to(r)}}]),e}();function ts(e){var t=e&&e.lastIndexOf("/");return t>=0?e.substr(0,t):""}var rs=function e(t,r,n){Le(this,e),this.item=t,this.previous=r,this.next=n},ns=function(){function e(){Le(this,e),this.head=null,this.tail=null,this._length=0}return Ce(e,[{key:"add",value:function(e){var t=new rs(e,this.tail,null);return this.tail?(this.tail.next=t,this.tail=t):(this.head=t,this.tail=t),++this._length,t}},{key:"remove",value:function(e){e&&(e.previous&&e.next?(e.previous.next=e.next,e.next.previous=e.previous):e.previous?(e.previous.next=null,this.tail=e.previous):e.next?(e.next.previous=null,this.head=e.next):(this.head=null,this.tail=null),e.next=null,e.previous=null,--this._length)}},{key:"splice",value:function(e,t){e!==t&&(this.remove(t),this._insert(e,t))}},{key:"_insert",value:function(e,t){var r=e.next;e.next=t,this.tail===e?this.tail=t:r.previous=t,t.next=r,t.previous=e,++this._length}},{key:"length",get:function(){return this._length}}]),e}();function is(e){return null!=e}var os=function(){function e(){Le(this,e),this._list=new ns,this._sentinel=this._list.add("sentinel"),this._trimTiles=!1}return Ce(e,[{key:"reset",value:function(){this._list.splice(this._list.tail,this._sentinel)}},{key:"touch",value:function(e){var t=e._cacheNode;is(t)&&this._list.splice(this._sentinel,t)}},{key:"add",value:function(e,t,r){is(t._cacheNode)||(t._cacheNode=this._list.add(t),r&&r(e,t))}},{key:"unloadTile",value:function(e,t,r){var n=t._cacheNode;is(n)&&(this._list.remove(n),t._cacheNode=void 0,r&&r(e,t))}},{key:"unloadTiles",value:function(e,t){var r=this._trimTiles;this._trimTiles=!1;for(var n=this._list,i=1024*e.maximumMemoryUsage*1024,o=this._sentinel,a=n.head;a!==o&&(e.gpuMemoryUsageInBytes>i||r);){var s=a.item;a=a.next,this.unloadTile(e,s,t)}}},{key:"trim",value:function(){this._trimTiles=!0}}]),e}();var as=new Pn,ss=new Pn,us=new eo([new Qi,new Qi,new Qi,new Qi,new Qi,new Qi]);function cs(e,t){var r=e.cameraDirection,n=e.cameraUp,i=e.height,o=e.distanceScales.metersPerUnit,a=[e.longitude,e.latitude,0],s=es.WGS84.cartographicToCartesian(a,new Pn),u=es.WGS84.eastNorthUpToFixedFrame(s),c=e.unprojectPosition(e.cameraPosition),l=es.WGS84.cartographicToCartesian(c,new Pn),f=new Pn(u.transformAsVector(new Pn(r).scale(o))).normalize(),h=new Pn(u.transformAsVector(new Pn(n).scale(o))).normalize();return function(e,t){var r=e.getFrustumPlanes(),n=0;for(var i in r){var o=r[i],a=o.normal.dot(e.center);ss.copy(o.normal).scale(o.distance-a).add(e.center);var s=e.unprojectPosition(ss),u=es.WGS84.cartographicToCartesian(s,new Pn);us.planes[n++].fromPointNormal(u,as.copy(t).subtract(u))}}(e,s),{camera:{position:l,direction:f,up:h},viewport:e,height:i,cullingVolume:us,frameNumber:t,sseDenominator:1.15}}var ls=new Pn;var fs=0,hs=1,ps=3,ds=4,ys=5,vs=1,gs=2,ms="empty",bs="scenegraph",ws="pointcloud",xs="mesh",ks="I3S",_s="TILES3D",Os="geometricError",Ts=1;function Ss(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var r=[],n=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){i=!0,o=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw o}}return r}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function As(e){return null!=e}var Ps=new Pn,Es=new Pn,Ms=new Pn;new uo;function js(e,t,r){if(X(e,"3D Tile: boundingVolume must be defined"),e.box)return function(e,t,r){var n=new Pn(e[0],e[1],e[2]);t.transform(n,n);var i=t.transformAsVector(e.slice(3,6)),o=t.transformAsVector(e.slice(6,9)),a=t.transformAsVector(e.slice(9,12)),s=new Xn([i[0],i[1],i[2],o[0],o[1],o[2],a[0],a[1],a[2]]);if(As(r))return r.center=n,r.halfAxes=s,r;return new Wi(n,s)}(e.box,t,r);if(e.region){var n=Ss(e.region,6),i=n[0],o=n[1],a=n[2],s=n[3],u=n[4],c=n[5],l=es.WGS84.cartographicToCartesian([$r(i),$r(s),u],Es),f=es.WGS84.cartographicToCartesian([$r(a),$r(o),c],Ms),h=(new Pn).addVectors(l,f).multiplyScalar(.5),p=(new Pn).subVectors(l,f).len()/2;return Is([h[0],h[1],h[2],p],new uo)}if(e.sphere)return Is(e.sphere,t,r);throw new Error("3D Tile: boundingVolume must contain a sphere, region, or box")}function Is(e,t,r){var n=new Pn(e[0],e[1],e[2]);t.transform(n,n);var i=t.getScale(Ps),o=Math.max(Math.max(i[0],i[1]),i[2]),a=e[3]*o;return As(r)?(r.center=n,r.radius=a,r):new Fn(n,a)}new Pn,new Pn,new uo,new Pn,new Pn,new Pn;function Ls(e,t){if(e.dynamicScreenSpaceError&&e._dynamicScreenSpaceErrorComputedDensity){var r=e._dynamicScreenSpaceErrorComputedDensity,n=e.dynamicScreenSpaceErrorFactor;return function(e,t){var r=e*t;return 1-Math.exp(-r*r)}(t,r)*n}return 0}var Rs=Math.PI/2;function Cs(e){var t=Ss(e,3),r=t[0],n=t[1],i=t[2],o=Yr(r),a=Yr(n),s=1+i/6378137,u=s*Math.cos(a);return[r=u*Math.cos(o),n=u*Math.sin(o),i=s*Math.sin(a)]}function Ns(e,t){var r=Ss(e,3),n=r[0],i=r[1],o=r[2],a=void 0===o?0:o,s=Ss(t,3),u=s[0],c=s[1],l=s[2],f=Cs([u,c,void 0===l?0:l]),h=Cs([n,i,a]),p=h[0]-f[0],d=h[1]-f[1],y=h[2]-f[2];return p*p+d*d+y*y}function Ds(e,t){var r=t.viewport,n=e.header.mbs[1],i=[e.header.mbs[0],n,e.header.mbs[2]],o=e.header.mbs[3]/6378137,a=Ns(r.unprojectPosition(r.cameraPosition),i)-o*o;if(a<=0)return 170141175e30;var s=function(e,t){var r=t.viewport,n=r.width,i=r.height,o=r.pixelProjectionMatrix,a=Math.tan(Math.atan(Math.sqrt(1/(o[0]*o[0])+1/(o[5]*o[5]))));return Math.sqrt(i*i+n*n)/a}(0,t);return s*=o/Math.sqrt(a)/r.scale}function Us(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Fs(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Us(Object(r),!0).forEach((function(t){$(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Us(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Bs=new Pn;var Vs=function(){function e(t,r,n){Le(this,e),X("object"===z(r)),this.header=r,this.tileset=t,this.id=r.id,this.url=r.url,this.parent=n,this.refine=this._getRefine(r.refine),this.type=r.type,this.contentUrl=r.contentUrl,this.lodMetricType=null,this.lodMetricValue=null,this.boundingVolume=null,this.content=null,this.contentState=fs,this.gpuMemoryUsageInBytes=0,this.children=[],this.depth=0,this._cacheNode=null,this._frameNumber=null,this._cacheNode=null,this._initializeLodMetric(r),this._initializeTransforms(r),this._initializeBoundingVolumes(r),this._initializeContent(r),this._initializeRenderingState(r),this._lodJudge=null,this._expireDate=null,this._expiredContent=null,this._getPriority=this._getPriority.bind(this),Object.seal(this)}var t;return Ce(e,[{key:"destroy",value:function(){this.header=null}},{key:"isDestroyed",value:function(){return null===this.header}},{key:"getScreenSpaceError",value:function(e,t){switch(this.tileset.type){case ks:return Ds(this,e);case _s:return function(e,t,r){var n=e.tileset,i=e.parent&&e.parent.lodMetricValue||e.lodMetricValue,o=r?i:e.lodMetricValue;if(0===o)return 0;var a=Math.max(e._distanceToCamera,1e-7),s=o*t.height/(a*t.sseDenominator);return s-=Ls(n,a)}(this,e,t);default:return console.error("Unsupported tileset type"),null}}},{key:"_getPriority",value:function(){return this.isVisible?this.contentState===fs?-1:Math.max(1e7-this._priority,0)||0:-1}},{key:"loadContent",value:(t=V(F.a.mark((function e(){var t,r,i,o,a;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.hasEmptyContent){e.next=2;break}return e.abrupt("return",!1);case 2:if(!this.content){e.next=4;break}return e.abrupt("return",!0);case 4:return this.contentExpired&&(this._expireDate=null),this.contentState=hs,e.next=9,this.tileset._requestScheduler.scheduleRequest(this.id,this._getPriority);case 9:if(t=e.sent){e.next=13;break}return this.contentState=fs,e.abrupt("return",!1);case 13:return e.prev=13,r=this.tileset.getTileUrl(this.contentUrl),i=this.tileset.fetchOptions,o=this.tileset.loader,a=Fs(Fs({},i),{},$({},o.id,{tile:this.header,tileset:this.tileset.tileset,isTileset:"auto",isTileHeader:!1,assetGltfUpAxis:this.tileset.asset.gltfUpAxis})),e.next=20,mr(r,o,a);case 20:return this.content=e.sent,this._isTileset()&&this.tileset._initializeTileHeaders(this.content,this,n.dirname(this.contentUrl)),this.contentState=ps,this._onContentLoaded(),e.abrupt("return",!0);case 27:throw e.prev=27,e.t0=e.catch(13),this.contentState=ys,e.t0;case 31:return e.prev=31,t.done(),e.finish(31);case 34:case"end":return e.stop()}}),e,this,[[13,27,31,34]])}))),function(){return t.apply(this,arguments)})},{key:"unloadContent",value:function(){return this.content&&this.content.destroy&&this.content.destroy(),this.content=null,this.contentState=fs,!0}},{key:"updateVisibility",value:function(e){if(this._frameNumber!==e.frameNumber){var t=this.parent,r=t?t.computedTransform:this.tileset.modelMatrix,n=t?t._visibilityPlaneMask:eo.MASK_INDETERMINATE;this._updateTransform(r),this._distanceToCamera=this.distanceToTile(e),this._screenSpaceError=this.getScreenSpaceError(e,!1),this._visibilityPlaneMask=this.visibility(e,n),this._visible=this._visibilityPlaneMask!==eo.MASK_OUTSIDE,this._inRequestVolume=this.insideViewerRequestVolume(e),this._priority=this.lodMetricValue,this._frameNumber=e.frameNumber}}},{key:"visibility",value:function(e,t){var r=e.cullingVolume,n=this.boundingVolume;return r.computeVisibilityWithPlaneMask(n,t)}},{key:"contentVisibility",value:function(e){return!0}},{key:"distanceToTile",value:function(e){var t=this.boundingVolume;return Math.sqrt(Math.max(t.distanceSquaredTo(e.camera.position),0))}},{key:"cameraSpaceZDepth",value:function(e){var t=e.camera,r=this.boundingVolume;return Bs.subVectors(r.center,t.position),t.direction.dot(Bs)}},{key:"insideViewerRequestVolume",value:function(e){var t=this._viewerRequestVolume;return!t||0===t.distanceToCamera(e.camera.position)}},{key:"_initializeLodMetric",value:function(e){"lodMetricType"in e?this.lodMetricType=e.lodMetricType:(this.lodMetricType=this.parent&&this.parent.lodMetricType||this.tileset.lodMetricType,console.warn("3D Tile: Required prop lodMetricType is undefined. Using parent lodMetricType")),"lodMetricValue"in e?this.lodMetricValue=e.lodMetricValue:(this.lodMetricValue=this.parent&&this.parent.lodMetricValue||this.tileset.lodMetricValue,console.warn("3D Tile: Required prop lodMetricValue is undefined. Using parent lodMetricValue"))}},{key:"_initializeTransforms",value:function(e){this.transform=e.transform?new uo(e.transform):new uo;var t=this.parent,r=this.tileset,n=t&&t.computedTransform?t.computedTransform.clone():r.modelMatrix.clone();this.computedTransform=new uo(n).multiplyRight(this.transform);var i=t&&t._initialTransform?t._initialTransform.clone():new uo;this._initialTransform=new uo(i).multiplyRight(this.transform)}},{key:"_initializeBoundingVolumes",value:function(e){this._contentBoundingVolume=null,this._viewerRequestVolume=null,this._updateBoundingVolume(e)}},{key:"_initializeContent",value:function(e){this.content={_tileset:this.tileset,_tile:this},this.hasEmptyContent=!0,this.contentState=fs,this.hasTilesetContent=!1,e.contentUrl&&(this.content=null,this.hasEmptyContent=!1)}},{key:"_initializeRenderingState",value:function(e){this.depth=e.level,this._shouldRefine=!1,this._distanceToCamera=0,this._centerZDepth=0,this._screenSpaceError=0,this._visibilityPlaneMask=eo.MASK_INDETERMINATE,this._visible=!1,this._inRequestVolume=!1,this._stackLength=0,this._selectionDepth=0,this._frameNumber=0,this._touchedFrame=0,this._visitedFrame=0,this._selectedFrame=0,this._requestedFrame=0,this._priority=0}},{key:"_getRefine",value:function(e){return e||this.parent&&this.parent.refine||gs}},{key:"_isTileset",value:function(){return-1!==this.contentUrl.indexOf(".json")}},{key:"_onContentLoaded",value:function(){switch(this.content&&this.content.type){case"vctr":case"geom":this.tileset.traverser.disableSkipLevelOfDetail=!0}this._isTileset()&&(this.hasTilesetContent=!0)}},{key:"_updateBoundingVolume",value:function(e){this.boundingVolume=js(e.boundingVolume,this.computedTransform,this.boundingVolume);var t=e.content;t&&(t.boundingVolume&&(this._contentBoundingVolume=js(t.boundingVolume,this.computedTransform,this._contentBoundingVolume)),e.viewerRequestVolume&&(this._viewerRequestVolume=js(e.viewerRequestVolume,this.computedTransform,this._viewerRequestVolume)))}},{key:"_updateTransform",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new uo,t=e.clone().multiplyRight(this.transform),r=!t.equals(this.computedTransform);r&&(this.computedTransform=t,this._updateBoundingVolume(this.header))}},{key:"updateExpiration",value:function(){if(null!=this._expireDate&&this.contentReady&&!this.hasEmptyContent){var e=Date.now();Date.lessThan(this._expireDate,e)&&(this.contentState=ds,this._expiredContent=this.content)}}},{key:"selected",get:function(){return this._selectedFrame===this.tileset._frameNumber}},{key:"isVisible",get:function(){return this._visible}},{key:"isVisibleAndInRequestVolume",get:function(){return this._visible&&this._inRequestVolume}},{key:"hasRenderContent",get:function(){return!this.hasEmptyContent&&!this.hasTilesetContent}},{key:"hasChildren",get:function(){return this.children.length>0||this.header.children&&this.header.children.length>0}},{key:"contentReady",get:function(){return this.contentState===ps||this.hasEmptyContent}},{key:"contentAvailable",get:function(){return Boolean(this.contentReady&&this.hasRenderContent||this._expiredContent&&!this.contentFailed)}},{key:"hasUnloadedContent",get:function(){return this.hasRenderContent&&this.contentUnloaded}},{key:"contentUnloaded",get:function(){return this.contentState===fs}},{key:"contentExpired",get:function(){return this.contentState===ds}},{key:"contentFailed",get:function(){return this.contentState===ys}},{key:"extras",get:function(){return this.header.extras}}]),e}();function zs(e,t){return(zs=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function qs(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&zs(e,t)}function Gs(e,t){return!t||"object"!==z(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ws(e){return(Ws=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Hs=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;Le(this,e),this._array=new Array(t),this._map=new Map,this._length=t}return Ce(e,[{key:"get",value:function(e){return X(e<this._array.length),this._array[e]}},{key:"set",value:function(e,t){X(e>=0),e>=this.length&&(this.length=e+1),this._map.has(this._array[e])&&this._map.delete(this._array[e]),this._array[e]=t,this._map.set(t,e)}},{key:"delete",value:function(e){var t=this._map.get(e);t>=0&&(this._array.splice(t,1),this._map.delete(e),this.length--)}},{key:"peek",value:function(){return this._array[this._length-1]}},{key:"push",value:function(e){if(!this._map.has(e)){var t=this.length++;this._array[t]=e,this._map.set(e,t)}}},{key:"pop",value:function(){var e=this._array[--this.length];return this._map.delete(e),e}},{key:"reserve",value:function(e){X(e>=0),e>this._array.length&&(this._array.length=e)}},{key:"resize",value:function(e){X(e>=0),this.length=e}},{key:"trim",value:function(e){null==e&&(e=this.length),this._array.length=e}},{key:"reset",value:function(){this._array=[],this._map=new Map,this._length=0}},{key:"find",value:function(e){return this._map.has(e)}},{key:"length",get:function(){return this._length},set:function(e){this._length=e,e>this._array.length&&(this._array.length=e)}},{key:"values",get:function(){return this._array}}]),e}();function Zs(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return Qs(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Qs(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function Qs(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Ks(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ys(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ks(Object(r),!0).forEach((function(t){$(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ks(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Js={loadSiblings:!1,skipLevelOfDetail:!1,maximumScreenSpaceError:2},$s=function(){function e(t){Le(this,e),this.options=Ys(Ys({},Js),t),this._traversalStack=new Hs,this._emptyTraversalStack=new Hs,this._frameNumber=null,this.root=null,this.selectedTiles={},this.requestedTiles={},this.emptyTiles={}}return Ce(e,[{key:"traverse",value:function(e,t,r){this.root=e,this.options=Ys(Ys({},this.options),r),this.reset(),this.updateTile(e,t),this._frameNumber=t.frameNumber,this.executeTraversal(e,t)}},{key:"reset",value:function(){this.requestedTiles={},this.selectedTiles={},this.emptyTiles={},this._traversalStack.reset(),this._emptyTraversalStack.reset()}},{key:"executeTraversal",value:function(e,t){var r=this._traversalStack;for(r.push(e);r.length>0;){var n=r.pop(),i=!1;this.canTraverse(n,t)&&(this.updateChildTiles(n,t),i=this.updateAndPushChildren(n,t,r));var o=n.parent,a=Boolean(!o||o._shouldRefine),s=!i;n.hasRenderContent?n.refine===vs?(this.loadTile(n,t),this.selectTile(n,t)):n.refine===gs&&(this.loadTile(n,t),s&&this.selectTile(n,t)):(this.emptyTiles[n.id]=n,this.loadTile(n,t),s&&this.selectTile(n,t)),this.touchTile(n,t),n._shouldRefine=i&&a}this.options.onTraversalEnd&&this.options.onTraversalEnd(t)}},{key:"updateChildTiles",value:function(e,t){var r,n=Zs(e.children);try{for(n.s();!(r=n.n()).done;){var i=r.value;this.updateTile(i,t)}}catch(e){n.e(e)}finally{n.f()}return!0}},{key:"updateAndPushChildren",value:function(e,t,r){var n=this.options,i=n.loadSiblings,o=n.skipLevelOfDetail,a=e.children;a.sort(this.compareDistanceToCamera);var s,u=!o&&e.refine===gs&&e.hasRenderContent,c=!1,l=Zs(a);try{for(l.s();!(s=l.n()).done;){var f=s.value;if(f.isVisibleAndInRequestVolume?(r.find(f)&&r.delete(f),r.push(f),c=!0):(u||i)&&(this.loadTile(f,t),this.touchTile(f,t)),u){var h=void 0;if(!(h=!!f._inRequestVolume&&(f.hasRenderContent?f.contentAvailable:this.executeEmptyTraversal(f,t))))return h}}}catch(e){l.e(e)}finally{l.f()}return c}},{key:"updateTile",value:function(e,t){this.updateTileVisibility(e,t)}},{key:"selectTile",value:function(e,t){this.shouldSelectTile(e,t)&&(e._selectedFrame=t.frameNumber,this.selectedTiles[e.id]=e)}},{key:"loadTile",value:function(e,t){this.shouldLoadTile(e,t)&&(e._requestedFrame=t.frameNumber,e._priority=this.getPriority(e),this.requestedTiles[e.id]=e)}},{key:"touchTile",value:function(e,t){e.tileset._cache.touch(e),e._touchedFrame=t.frameNumber}},{key:"canTraverse",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return!(!n&&!e.isVisibleAndInRequestVolume)&&(!!e.hasChildren&&(e.hasTilesetContent?!e.contentExpired:this.shouldRefine(e,t,r)))}},{key:"shouldLoadTile",value:function(e,t){return e.hasUnloadedContent||e.contentExpired}},{key:"shouldSelectTile",value:function(e,t){return e.contentAvailable&&!this.options.skipLevelOfDetail}},{key:"shouldRefine",value:function(e,t,r){var n=e._screenSpaceError;return r&&(n=e.getScreenSpaceError(t,!0)),n>this.options.maximumScreenSpaceError}},{key:"updateTileVisibility",value:function(e,t){e.updateVisibility(t)}},{key:"compareDistanceToCamera",value:function(e,t){return e._distanceToCamera-t._distanceToCamera}},{key:"getPriority",value:function(e){var t=this.options;switch(e.refine){case vs:return e._distanceToCamera;case gs:var r=e.parent,n=r&&(!t.skipLevelOfDetail||0===e._screenSpaceError||r.hasTilesetContent)?r._screenSpaceError:e._screenSpaceError;return this.root._screenSpaceError-n;default:return X(!1)}}},{key:"anyChildrenVisible",value:function(e,t){var r,n=!1,i=Zs(e.children);try{for(i.s();!(r=i.n()).done;){var o=r.value;o.updateVisibility(t),n=n||o.isVisibleAndInRequestVolume}}catch(e){i.e(e)}finally{i.f()}return n}},{key:"executeEmptyTraversal",value:function(e,t){for(var r=!0,n=this._emptyTraversalStack;n.length>0;){var i=n.pop();this.updateTile(i,t),i.isVisibleAndInRequestVolume||(this.loadTile(i,t),this.touchTile(i,t));var o=!i.hasRenderContent&&this.canTraverse(i,t,!1,!0);if(o||i.contentAvailable||(r=!1),o){var a,s=Zs(i.children.filter((function(e){return e})));try{for(s.s();!(a=s.n()).done;){var u=a.value;n.find(u)&&n.delete(u),n.push(u)}}catch(e){s.e(e)}finally{s.f()}}}return r}}]),e}();function Xs(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Ws(e);if(t){var i=Ws(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Gs(this,r)}}var eu=function(e){qs(r,e);var t=Xs(r);function r(){return Le(this,r),t.apply(this,arguments)}return Ce(r,[{key:"compareDistanceToCamera",value:function(e,t){return 0===t._distanceToCamera&&0===e._distanceToCamera?t._centerZDepth-e._centerZDepth:t._distanceToCamera-e._distanceToCamera}},{key:"updateTileVisibility",value:function(e,t){if(e.updateVisibility(t),e.isVisibleAndInRequestVolume){var r=e.children.length>0;if(e.hasTilesetContent&&r){var n=e.children[0];return this.updateTileVisibility(n,t),void(e._visible=n._visible)}if(this.meetsScreenSpaceErrorEarly(e,t))e._visible=!1;else{var i=e.refine===gs,o=e._optimChildrenWithinParent===Ts;i&&o&&r&&!this.anyChildrenVisible(e,t)&&(e._visible=!1)}}}},{key:"meetsScreenSpaceErrorEarly",value:function(e,t){var r=e.parent;return!(!r||r.hasTilesetContent||r.refine!==vs)&&!this.shouldRefine(e,t,!0)}}]),r}($s),tu="REQUESTED",ru="COMPLETED",nu="ERROR",iu=function(){function e(){Le(this,e),this._statusMap={}}return Ce(e,[{key:"add",value:function(e,t,r,n){var i=this;this._statusMap[t]||(this._statusMap[t]={request:e,callback:r,key:t,frameState:n,status:tu},e().then((function(e){i._statusMap[t].status=ru,i._statusMap[t].callback(e,n)})).catch((function(e){i._statusMap[t].status=nu,r(e)})))}},{key:"update",value:function(e,t){this._statusMap[e]&&(this._statusMap[e].frameState=t)}},{key:"find",value:function(e){return this._statusMap[e]}}]),e}();function ou(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function au(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ou(Object(r),!0).forEach((function(t){$(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ou(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function su(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return uu(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return uu(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function uu(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function cu(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Ws(e);if(t){var i=Ws(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Gs(this,r)}}var lu=function(e){qs(n,e);var t,r=cu(n);function n(e){var t;return Le(this,n),(t=r.call(this,e))._tileManager=new iu,t}return Ce(n,[{key:"shouldRefine",value:function(e,t){return e._lodJudge=function(e,t){var r=t.viewport,n=r.metersPerPixel,i=e.header.mbs[1],o=e.header.mbs[0],a=e.header.mbs[2],s=e.header.mbs[3],u=r.height,c=r.width,l=r.latitude,f=r.longitude,h=[f,l],p=[o,i,a],d=[f,i],y=[o,l],v=Math.sqrt(u*u+c*c)*n[0],g=.5*u+s/6378137,m=.5*c+s/6378137;if(Ns(h,p)>v+s/6378137)return"OUT";if(Ns(h,d)>g)return"OUT";if(Ns(h,y)>m)return"OUT";if(0===e.lodMetricValue)return"DIG";var b=Ds(e,t);return(b*=Rs)<.5?"OUT":!e.header.children||b<=e.lodMetricValue?"DRAW":e.header.children?"DIG":"OUT"}(e,t),"DIG"===e._lodJudge}},{key:"updateChildTiles",value:function(e,t){var r,n=this,i=e.header.children||[],o=e.children,a=e.tileset,s=su(i);try{var u=function(){var i=r.value,s=o&&o.find((function(e){return e.id===i.id}));if(s)s&&n.updateTile(s,t);else{var u=function(){return n._loadTile(i.id,a)};n._tileManager.find(i.id)?n._tileManager.update(i.id,t):(a.tileset.nodePages&&(u=function(){return a.tileset.nodePagesTile.formTileFromNodePages(i.id)}),n._tileManager.add(u,i.id,(function(t){return n._onTileLoad(t,e)}),t))}};for(s.s();!(r=s.n()).done;)u()}catch(e){s.e(e)}finally{s.f()}}},{key:"_loadTile",value:(t=V(F.a.mark((function e(t,r){var n,i,o;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.loader,i=r.getTileUrl("".concat(r.url,"/nodes/").concat(t)),o={i3s:au(au({},r.fetchOptions),{},{isTileHeader:!0,loadContent:!1})},e.next=5,mr(i,n,o);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)}))),function(e,r){return t.apply(this,arguments)})},{key:"_onTileLoad",value:function(e,t){var r=this.options.basePath,n=new Vs(t.tileset,e,t,r);t.children.push(n);var i=this._tileManager.find(n.id).frameState;this.updateTile(n,i),this._frameNumber===i.frameNumber&&this.executeTraversal(n,i)}}]),n}($s);function fu(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return hu(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return hu(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function hu(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function pu(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function du(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?pu(Object(r),!0).forEach((function(t){$(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pu(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var yu={ellipsoid:es.WGS84,modelMatrix:new uo,throttleRequests:!1,maximumMemoryUsage:32,onTileLoad:function(){},onTileUnload:function(){},onTileError:function(e,t,r){},maximumScreenSpaceError:8},vu=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Le(this,e),X(t),this.options=du(du({},yu),r),this.tileset=t,this.loader=t.loader,this.type=t.type,this.url=t.url,this.basePath=t.basePath||n.dirname(this.url),this.modelMatrix=this.options.modelMatrix,this.ellipsoid=this.options.ellipsoid,this.lodMetricType=t.lodMetricType,this.lodMetricValue=t.lodMetricValue,this.refine=t.root.refine,this.fetchOptions=this.options.fetchOptions||{},this.options.headers&&(this.fetchOptions.headers=this.options.headers),this.options.token&&(this.fetchOptions.token=this.options.token),this.root=null,this.cartographicCenter=null,this.cartesianCenter=null,this.zoom=1,this.boundingVolume=null,this._traverser=this._initializeTraverser(),this._cache=new os,this._requestScheduler=new Wo({throttleRequests:this.options.throttleRequests}),this._frameNumber=0,this._updateFrameNumber=0,this._pendingCount=0,this._tiles={},this.selectedTiles=[],this._emptyTiles=[],this._requestedTiles=[],this._selectedTilesToStyle=[],this._queryParams={},this._queryParamsString=null,this.maximumMemoryUsage=this.options.maximumMemoryUsage,this.gpuMemoryUsageInBytes=0,this.stats=new Vo({id:this.url}),this._initializeStats(),this._hasMixedContent=!1,this._maximumScreenSpaceError=this.options.maximumScreenSpaceError,this._properties=void 0,this._extensionsUsed=void 0,this._gltfUpAxis=void 0,this._dynamicScreenSpaceErrorComputedDensity=0,this.extras=null,this.asset={},this.credits={},this.description=this.options.description,this._defaultGeometrySchema=[],this._initializeTileSet(t,this.options)}var t;return Ce(e,[{key:"isLoaded",value:function(){return 0===this._pendingCount}},{key:"destroy",value:function(){this._destroy()}},{key:"getTileUrl",value:function(e){return e.startsWith("data:")?e:"".concat(e).concat(this.queryParams)}},{key:"update",value:function(e){this._cache.reset(),this._frameNumber++,this._frameState=cs(e,this._frameNumber),this._traverser.traverse(this.root,this._frameState,this.options)}},{key:"_onTraversalEnd",value:function(){var e=Object.values(this._traverser.selectedTiles);this._tilesChanged(this.selectedTiles,e)&&this._updateFrameNumber++,this.selectedTiles=e;var t,r=fu(this.selectedTiles);try{for(r.s();!(t=r.n()).done;){var n=t.value;this._tiles[n.id]=n}}catch(e){r.e(e)}finally{r.f()}return this._requestedTiles=Object.values(this._traverser.requestedTiles),this._emptyTiles=Object.values(this._traverser.emptyTiles),this._loadTiles(this._frameState),this._unloadTiles(),this._updateStats(),this._updateFrameNumber}},{key:"_tilesChanged",value:function(e,t){if(e.length!==t.length)return!0;var r=new Set(e.map((function(e){return e.id}))),n=new Set(t.map((function(e){return e.id}))),i=e.filter((function(e){return!n.has(e.id)})).length>0;return i=i||t.filter((function(e){return!r.has(e.id)})).length>0}},{key:"_loadTiles",value:function(e){var t,r=fu(this._requestedTiles);try{for(r.s();!(t=r.n()).done;){var n=t.value;n.contentUnloaded&&this._loadTile(n,e)}}catch(e){r.e(e)}finally{r.f()}}},{key:"_unloadTiles",value:function(){this._cache.unloadTiles(this,(function(e,t){return e._unloadTile(t)}))}},{key:"_updateStats",value:function(){var e,t=0,r=0,n=fu(this.selectedTiles);try{for(n.s();!(e=n.n()).done;){var i=e.value;i.contentAvailable&&(t++,i.content.pointCount&&(r+=i.content.pointCount))}}catch(e){n.e(e)}finally{n.f()}this.stats.get("Tiles In View").count=this.selectedTiles.length,this.stats.get("Tiles To Render").count=t,this.stats.get("Points").count=r}},{key:"_initializeTileSet",value:function(e){this.root=this._initializeTileHeaders(e,null,this.basePath),this.type===_s&&this._initializeCesiumTileset(e),this.type===ks&&this._initializeI3STileset(e),this._calculateViewProps()}},{key:"_calculateViewProps",value:function(){var e=this.root,t=e.boundingVolume.center;if(!t)return console.warn("center was not pre-calculated for the root tile"),this.cartographicCenter=new Pn,void(this.zoom=1);this.cartographicCenter=es.WGS84.cartesianToCartographic(t,new Pn),this.cartesianCenter=t,this.zoom=function(e){var t=e.halfAxes,r=e.radius,n=e.width,i=e.height;if(t){t.getColumn(0,ls);var o=ls.len();t.getColumn(1,ls);var a=ls.len();t.getColumn(2,ls);var s=o/2,u=a/2,c=ls.len()/2;return(Math.log2(6378137/s)+Math.log2(6378137/u)+Math.log2(6356752.314245179/c))/3}return r?Math.log2(6356752.314245179/r):i&&n?(Math.log2(6378137/n)+Math.log2(6378137/i))/2:1}(e.boundingVolume)}},{key:"_initializeStats",value:function(){this.stats.get("Tiles In Tileset(s)"),this.stats.get("Tiles Loading"),this.stats.get("Tiles In Memory"),this.stats.get("Tiles In View"),this.stats.get("Tiles To Render"),this.stats.get("Tiles Loaded"),this.stats.get("Tiles Unloaded"),this.stats.get("Failed Tile Loads"),this.stats.get("Points","memory"),this.stats.get("Tile Memory Use","memory")}},{key:"_initializeTileHeaders",value:function(e,t,r){var n=new Vs(this,e.root,t,r);if(t&&(t.children.push(n),n.depth=t.depth+1),this.type===_s){var i=[];for(i.push(n);i.length>0;){var o=i.pop();this.stats.get("Tiles In Tileset(s)").incrementCount();var a,s=fu(o.header.children||[]);try{for(s.s();!(a=s.n()).done;){var u=a.value,c=new Vs(this,u,o,r);o.children.push(c),c.depth=o.depth+1,i.push(c)}}catch(e){s.e(e)}finally{s.f()}}}return n}},{key:"_initializeTraverser",value:function(){var e;switch(this.type){case _s:e=eu;break;case ks:e=lu;break;default:e=$s}return new e({basePath:this.basePath,onTraversalEnd:this._onTraversalEnd.bind(this)})}},{key:"_destroyTileHeaders",value:function(e){this._destroySubtree(e)}},{key:"_loadTile",value:(t=V(F.a.mark((function e(t,r){var n;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this._onStartTileLoading(),e.next=4,t.loadContent(r);case 4:n=e.sent,e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),this._onTileLoadError(t,e.t0);case 10:return e.prev=10,this._onEndTileLoading(),this._onTileLoad(t,n),e.finish(10);case 14:case"end":return e.stop()}}),e,this,[[0,7,10,14]])}))),function(e,r){return t.apply(this,arguments)})},{key:"_onTileLoadError",value:function(e,t){this.stats.get("Failed Tile Loads").incrementCount();var r=t.message||t.toString(),n=e.url;console.error("A 3D tile failed to load: ".concat(e.url," ").concat(r)),this.options.onTileError(e,r,n)}},{key:"_onTileLoad",value:function(e,t){t&&(e&&e.content&&function(e,t){X(e),X(t);var r=t.rtcCenter,n=t.gltfUpAxis,i=e.computedTransform,o=e.boundingVolume.center,a=new uo(i);switch(r&&a.translate(r),n){case"Z":break;case"Y":var s=(new uo).rotateX(Math.PI/2);a=a.multiplyRight(s);break;case"X":var u=(new uo).rotateY(-Math.PI/2);a=a.multiplyRight(u)}t.isQuantized&&a.translate(t.quantizedVolumeOffset).scale(t.quantizedVolumeScale);var c=new Pn(o);t.cartesianModelMatrix=a,t.cartesianOrigin=c;var l=es.WGS84.cartesianToCartographic(c,new Pn),f=es.WGS84.eastNorthUpToFixedFrame(c).invert();t.cartographicModelMatrix=f.multiplyRight(a),t.cartographicOrigin=l,t.modelMatrix=t.cartographicModelMatrix}(e,e.content),this._addTileToCache(e),this.options.onTileLoad(e))}},{key:"_onStartTileLoading",value:function(){this._pendingCount++,this.stats.get("Tiles Loading").incrementCount()}},{key:"_onEndTileLoading",value:function(){this._pendingCount--,this.stats.get("Tiles Loading").decrementCount()}},{key:"_addTileToCache",value:function(e){this._cache.add(this,e,(function(t){return t._updateCacheStats(e)}))}},{key:"_updateCacheStats",value:function(e){this.stats.get("Tiles Loaded").incrementCount(),this.stats.get("Tiles In Memory").incrementCount(),this.gpuMemoryUsageInBytes+=e.content.byteLength||0,this.stats.get("Tile Memory Use").count=this.gpuMemoryUsageInBytes}},{key:"_unloadTile",value:function(e){this.gpuMemoryUsageInBytes-=e.content.byteLength||0,this.stats.get("Tiles In Memory").decrementCount(),this.stats.get("Tiles Unloaded").incrementCount(),this.stats.get("Tile Memory Use").count=this.gpuMemoryUsageInBytes,this.options.onTileUnload(e),e.unloadContent()}},{key:"_destroy",value:function(){var e=[];for(this.root&&e.push(this.root);e.length>0;){var t,r=e.pop(),n=fu(r.children);try{for(n.s();!(t=n.n()).done;){var i=t.value;e.push(i)}}catch(e){n.e(e)}finally{n.f()}this._destroyTile(r)}this.root=null}},{key:"_destroySubtree",value:function(e){var t=e,r=[];for(r.push(t);r.length>0;){var n,i=fu((e=r.pop()).children);try{for(i.s();!(n=i.n()).done;){var o=n.value;r.push(o)}}catch(e){i.e(e)}finally{i.f()}e!==t&&this._destroyTile(e)}t.children=[]}},{key:"_destroyTile",value:function(e){this._cache.unloadTile(this,e),this._unloadTile(e),e.destroy()}},{key:"_initializeCesiumTileset",value:function(e){if(this.asset=e.asset,!this.asset)throw new Error("Tileset must have an asset property.");if("0.0"!==this.asset.version&&"1.0"!==this.asset.version)throw new Error("The tileset must be 3D Tiles version 0.0 or 1.0.");"tilesetVersion"in this.asset&&(this._queryParams.v=this.asset.tilesetVersion),this.credits={attributions:this.options.attributions||[]},this.description=this.options.description,this.properties=e.properties,this.geometricError=e.geometricError,this._extensionsUsed=e.extensionsUsed,this.extras=e.extras}},{key:"_initializeI3STileset",value:function(e){"token"in this.options&&(this._queryParams.token=this.options.token),this._defaultGeometrySchema=e.store.defaultGeometrySchema}},{key:"hasExtension",value:function(e){return Boolean(this._extensionsUsed&&this._extensionsUsed.indexOf(e)>-1)}},{key:"tiles",get:function(){return Object.values(this._tiles)}},{key:"queryParams",get:function(){return this._queryParamsString||(this._queryParamsString=function(e){for(var t=[],r=0,n=Object.keys(e);r<n.length;r++){var i=n[r];t.push("".concat(i,"=").concat(e[i]))}switch(t.length){case 0:return"";case 1:return"?".concat(t[0]);default:return"?".concat(t.join("&"))}}(this._queryParams)),this._queryParamsString}}]),e}(),gu={COMPOSITE:"cmpt",POINT_CLOUD:"pnts",BATCHED_3D_MODEL:"b3dm",INSTANCED_3D_MODEL:"i3dm",GEOMETRY:"geom",VECTOR:"vect"};Object.keys(gu);function mu(e,t,r){X(e instanceof ArrayBuffer);var n=new TextDecoder("utf8"),i=new Uint8Array(e,t,r);return n.decode(i)}function bu(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=new DataView(e);return"".concat(String.fromCharCode(r.getUint8(t+0))).concat(String.fromCharCode(r.getUint8(t+1))).concat(String.fromCharCode(r.getUint8(t+2))).concat(String.fromCharCode(r.getUint8(t+3)))}var wu,xu=r(16),ku={};function _u(e){return Ou.apply(this,arguments)}function Ou(){return(Ou=V(F.a.mark((function e(t){var r,n,i=arguments;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=i.length>1&&void 0!==i[1]?i[1]:null,n=i.length>2&&void 0!==i[2]?i[2]:{},r&&(t=Tu(t,r,n)),ku[t]=ku[t]||Su(t),e.next=6,ku[t];case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Tu(e,t,r){var n=r.modules||{};return n[e]?n[e]:ae?r.CDN?(X(r.CDN.startsWith("http")),"".concat(r.CDN,"/").concat(t,"@").concat("2.3.13","/dist/libs/").concat(e)):se?"../src/libs/".concat(e):"modules/".concat(t,"/src/libs/").concat(e):"modules/".concat(t,"/dist/libs/").concat(e)}function Su(e){return Au.apply(this,arguments)}function Au(){return(Au=V(F.a.mark((function e(t){var r,n,i;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.endsWith("wasm")){e.next=7;break}return e.next=3,fetch(t);case 3:return r=e.sent,e.next=6,r.arrayBuffer();case 6:return e.abrupt("return",e.sent);case 7:if(ae){e.next=9;break}return e.abrupt("return",xu.requireFromFile&&xu.requireFromFile(t));case 9:if(!se){e.next=11;break}return e.abrupt("return",importScripts(t));case 11:return e.next=13,fetch(t);case 13:return n=e.sent,e.next=16,n.text();case 16:return i=e.sent,e.abrupt("return",Pu(i,t));case 18:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Pu(e,t){if(!ae)return xu.requireFromString&&xu.requireFromString(e,t);if(se)return eval.call(oe,e),null;var r=document.createElement("script");r.id=t;try{r.appendChild(document.createTextNode(e))}catch(t){r.text=e}return document.body.appendChild(r),null}function Eu(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Mu(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Eu(Object(r),!0).forEach((function(t){$(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Eu(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ju(e){return Iu.apply(this,arguments)}function Iu(){return(Iu=V(F.a.mark((function e(t){var r;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.modules||{},wu=r.draco3d?wu||new Promise((function(e){var t=r.draco3d.createDecoderModule({onModuleLoaded:function(){e({draco:t})}})})):wu||Lu(t),e.next=4,wu;case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Lu(e){return Ru.apply(this,arguments)}function Ru(){return(Ru=V(F.a.mark((function e(t){var r,n,i,o;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t.draco&&t.draco.decoderType,e.next="js"===e.t0?3:(e.t0,7);break;case 3:return e.next=5,_u("draco_decoder.js","draco",t);case 5:return r=e.sent,e.abrupt("break",21);case 7:return e.t1=Promise,e.next=10,_u("draco_wasm_wrapper.js","draco",t);case 10:return e.t2=e.sent,e.next=13,_u("draco_decoder.wasm","draco",t);case 13:return e.t3=e.sent,e.t4=[e.t2,e.t3],e.next=17,e.t1.all.call(e.t1,e.t4);case 17:i=e.sent,o=Ss(i,2),r=o[0],n=o[1];case 21:return r=r||oe.DracoDecoderModule,e.next=24,Cu(r,n);case 24:return e.abrupt("return",e.sent);case 25:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Cu(e,t){var r={};return t&&(r.wasmBinary=t),new Promise((function(t){e(Mu(Mu({},r),{},{onModuleLoaded:function(e){return t({draco:e})}}))}))}function Nu(e){if(!e||!e.POSITION)return null;var t=1/0,r=1/0,n=1/0,i=-1/0,o=-1/0,a=-1/0,s=e.POSITION.value,u=s&&s.length;if(!u)return null;for(var c=0;c<u;c+=3){var l=s[c],f=s[c+1],h=s[c+2];t=l<t?l:t,r=f<r?f:r,n=h<n?h:n,i=l>i?l:i,o=f>o?f:o,a=h>a?h:a}return[[t,r,n],[i,o,a]]}var Du=0,Uu=1,Fu={POSITION:"POSITION",NORMAL:"NORMAL",COLOR:"COLOR_0",TEX_COORD:"TEXCOORD_0"},Bu={1:Int8Array,2:Uint8Array,3:Int16Array,4:Uint16Array,5:Int32Array,6:Uint32Array,9:Float32Array},Vu=function(){function e(t){Le(this,e),this.draco=t,this.drawMode="TRIANGLE",this.metadataQuerier={}}return Ce(e,[{key:"destroy",value:function(){}},{key:"destroyGeometry",value:function(e){e&&this.draco.destroy(e.dracoGeometry)}},{key:"parseSync",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.metadataQuerier=new this.draco.MetadataQuerier;var r=new this.draco.DecoderBuffer;r.Init(new Int8Array(e),e.byteLength);var n,i,o,a=new this.draco.Decoder,s={};try{var u=a.GetEncodedGeometryType(r);switch(u){case this.draco.TRIANGULAR_MESH:i=new this.draco.Mesh,n=a.DecodeBufferToMesh(r,i),o={type:Du,faceCount:i.num_faces(),attributeCount:i.num_attributes(),vertexCount:i.num_points()};break;case this.draco.POINT_CLOUD:i=new this.draco.PointCloud,n=a.DecodeBufferToPointCloud(r,i),o={type:Uu,attributeCount:i.num_attributes(),vertexCount:i.num_points()};break;default:throw new Error("Unknown DRACO geometry type.")}if(!n.ok()||!i.ptr){var c="DRACO decompression failed: ".concat(n.error_msg());throw i&&this.draco.destroy(i),new Error(c)}s.loaderData={header:o},this._extractDRACOGeometry(a,i,u,s,t);var l=this._getGeometryMetadata(a,i);s.header={vertexCount:o.vertexCount,boundingBox:Nu(s.attributes),metadata:l}}finally{this.draco.destroy(a),this.draco.destroy(r),this.draco.destroy(i),this.draco.destroy(this.metadataQuerier)}return s}},{key:"_extractDRACOGeometry",value:function(e,t,r,n,i){var o=this._getAttributes(e,t,i);if(!o.POSITION)throw new Error("DRACO decompressor: No position attribute found.");return r===this.draco.TRIANGULAR_MESH?(o.indices="TRIANGLE_STRIP"===this.drawMode?this._getMeshStripIndices(e,t):this._getMeshFaceIndices(e,t),n.mode="TRIANGLE_STRIP"===this.drawMode?5:4):n.mode=0,o.indices&&(n.indices={value:o.indices,size:1},delete o.indices),n.attributes=o,n}},{key:"getPositionAttributeMetadata",value:function(e){this.metadata=this.metadata||{},this.metadata.attributes=this.metadata.attributes||{};var t=new this.draco.AttributeQuantizationTransform;if(t.InitFromAttribute(e)){this.metadata.attributes.position.isQuantized=!0,this.metadata.attributes.position.maxRange=t.range(),this.metadata.attributes.position.numQuantizationBits=t.quantization_bits(),this.metadata.attributes.position.minValues=new Float32Array(3);for(var r=0;r<3;++r)this.metadata.attributes.position.minValues[r]=t.min_value(r)}this.draco.destroy(t)}},{key:"_getAttributes",value:function(e,t,r){for(var n={},i=t.num_points(),o=0;o<t.num_attributes();o++){var a=e.GetAttribute(t,o),s=this._getAttributeMetadata(e,t,o),u={uniqueId:a.unique_id(),attributeType:a.attribute_type(),dataType:Bu[a.data_type()],size:a.size(),numComponents:a.num_components(),byteOffset:a.byte_offset(),byteStride:a.byte_stride(),normalized:a.normalized(),metadata:s},c=this._deduceAttributeName(u,r),l=this._getAttributeTypedArray(e,t,a,c).typedArray;n[c]={value:l,size:l.length/i,metadata:s}}return n}},{key:"_getMeshFaceIndices",value:function(e,t){for(var r=t.num_faces(),n=new Uint32Array(3*r),i=new this.draco.DracoInt32Array,o=0;o<r;++o){e.GetFaceFromMesh(t,o,i);var a=3*o;n[a]=i.GetValue(0),n[a+1]=i.GetValue(1),n[a+2]=i.GetValue(2)}return this.draco.destroy(i),n}},{key:"_getMeshStripIndices",value:function(e,t){var r=new this.draco.DracoInt32Array;e.GetTriangleStripsFromMesh(t,r);for(var n=new Uint32Array(r.size()),i=0;i<r.size();++i)n[i]=r.GetValue(i);return this.draco.destroy(r),n}},{key:"_getAttributeTypedArray",value:function(e,t,r,n){if(0===r.ptr){var i="DRACO decode bad attribute ".concat(n);throw new Error(i)}var o,a,s=Bu[r.data_type()],u=r.num_components(),c=t.num_points()*u;switch(s){case Float32Array:o=new this.draco.DracoFloat32Array,e.GetAttributeFloatForAllPoints(t,r,o),a=new Float32Array(c);break;case Int8Array:o=new this.draco.DracoInt8Array,e.GetAttributeInt8ForAllPoints(t,r,o),a=new Int8Array(c);break;case Int16Array:o=new this.draco.DracoInt16Array,e.GetAttributeInt16ForAllPoints(t,r,o),a=new Int16Array(c);break;case Int32Array:o=new this.draco.DracoInt32Array,e.GetAttributeInt32ForAllPoints(t,r,o),a=new Int32Array(c);break;case Uint8Array:o=new this.draco.DracoUInt8Array,e.GetAttributeUInt8ForAllPoints(t,r,o),a=new Uint8Array(c);break;case Uint16Array:o=new this.draco.DracoUInt16Array,e.GetAttributeUInt16ForAllPoints(t,r,o),a=new Uint16Array(c);break;case Uint32Array:o=new this.draco.DracoUInt32Array,e.GetAttributeUInt32ForAllPoints(t,r,o),a=new Uint32Array(c);break;default:throw new Error("DRACO decoder: unexpected attribute type.")}for(var l=0;l<c;l++)a[l]=o.GetValue(l);return this.draco.destroy(o),{typedArray:a,components:u}}},{key:"_deduceAttributeName",value:function(e,t){var r=t.extraAttributes,n=void 0===r?{}:r;if(n&&"object"===z(n))for(var i=0,o=Object.entries(n);i<o.length;i++){var a=Ss(o[i],2),s=a[0];if(a[1]===e.uniqueId)return s}for(var u in Fu){var c=this.draco[u];if(e.attributeType===c)return Fu[u]}if(e.metadata){var l=t.attributeNameEntry||"name";if(e.metadata[l])return e.metadata[l].string}return"CUSTOM_ATTRIBUTE_".concat(e.uniqueId)}},{key:"_getGeometryMetadata",value:function(e,t){var r=e.GetMetadata(t);return this._queryDracoMetadata(r)}},{key:"_getAttributeMetadata",value:function(e,t,r){var n=e.GetAttributeMetadata(t,r);return this._queryDracoMetadata(n)}},{key:"_queryDracoMetadata",value:function(e){if(!e||!e.ptr)return{};for(var t={},r=this.metadataQuerier.NumEntries(e),n=0;n<r;n++){var i=this.metadataQuerier.GetEntryName(e,n);t[i]={int:this.metadataQuerier.GetIntEntry(e,i),string:this.metadataQuerier.GetStringEntry(e,i),double:this.metadataQuerier.GetDoubleEntry(e,i),intArray:this.metadataQuerier.GetIntEntryArray(e,i)}}return t}},{key:"decode",value:function(e,t){return this.parseSync(e,t)}}]),e}();function zu(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function qu(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?zu(Object(r),!0).forEach((function(t){$(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):zu(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Gu=qu(qu({},{id:"draco",name:"Draco",version:"2.3.13",extensions:["drc"],mimeTypes:["application/octet-stream"],binary:!0,tests:["DRACO"],options:{draco:{decoderType:"object"===("undefined"==typeof WebAssembly?"undefined":z(WebAssembly))?"wasm":"js",libraryPath:"libs/",workerUrl:"https://unpkg.com/@loaders.gl/draco@".concat("2.3.13","/dist/draco-loader.worker.js"),localWorkerUrl:"modules/draco/dist/draco-loader.worker.dev.js",extraAttributes:{}}}}),{},{parse:function(e,t,r,n){return Wu.apply(this,arguments)}});function Wu(){return(Wu=V(F.a.mark((function e(t,r,n,i){var o,a,s;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ju(r);case 2:return o=e.sent,a=o.draco,s=new Vu(a),e.prev=5,e.abrupt("return",s.parseSync(t,qu({extraAttributes:r.draco&&r.draco.extraAttributes||null},r.parseOptions||{})));case 7:return e.prev=7,s.destroy(),e.finish(7);case 10:case"end":return e.stop()}}),e,null,[[5,,7,10]])})))).apply(this,arguments)}function Hu(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Zu(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Hu(Object(r),!0).forEach((function(t){$(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Hu(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Qu,Ku={BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DOUBLE:5130},Yu=Zu(Zu({},{POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6}),Ku),Ju=($(Qu={},Ku.DOUBLE,Float64Array),$(Qu,Ku.FLOAT,Float32Array),$(Qu,Ku.UNSIGNED_SHORT,Uint16Array),$(Qu,Ku.UNSIGNED_INT,Uint32Array),$(Qu,Ku.UNSIGNED_BYTE,Uint8Array),$(Qu,Ku.BYTE,Int8Array),$(Qu,Ku.SHORT,Int16Array),$(Qu,Ku.INT,Int32Array),Qu),$u={DOUBLE:Ku.DOUBLE,FLOAT:Ku.FLOAT,UNSIGNED_SHORT:Ku.UNSIGNED_SHORT,UNSIGNED_INT:Ku.UNSIGNED_INT,UNSIGNED_BYTE:Ku.UNSIGNED_BYTE,BYTE:Ku.BYTE,SHORT:Ku.SHORT,INT:Ku.INT},Xu=function(){function e(){Le(this,e)}return Ce(e,null,[{key:"fromTypedArray",value:function(e){for(var t in e=ArrayBuffer.isView(e)?e.constructor:e,Ju){if(Ju[t]===e)return t}throw new Error("Failed to convert GL type")}},{key:"fromName",value:function(e){var t=$u[e];if(!t)throw new Error("Failed to convert GL type");return t}},{key:"getArrayType",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];switch(e){case Ku.UNSIGNED_SHORT_5_6_5:case Ku.UNSIGNED_SHORT_4_4_4_4:case Ku.UNSIGNED_SHORT_5_5_5_1:return Uint16Array;default:var t=Ju[e];if(!t)throw new Error("Failed to convert GL type");return t}}},{key:"getByteSize",value:function(t){return e.getArrayType(t).BYTES_PER_ELEMENT}},{key:"validate",value:function(t){return Boolean(e.getArrayType(t))}},{key:"createTypedArray",value:function(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3?arguments[3]:void 0;void 0===i&&(i=(r.byteLength-n)/e.getByteSize(t));var o=e.getArrayType(t);return new o(r,n,i)}}]),e}(),ec=function(){function e(t,r){Le(this,e),this.json=t,this.buffer=r,this.featuresLength=0,this._cachedTypedArrays={}}return Ce(e,[{key:"getExtension",value:function(e){return this.json.extensions&&this.json.extensions[e]}},{key:"hasProperty",value:function(e){return Boolean(this.json[e])}},{key:"getGlobalProperty",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Yu.UNSIGNED_INT,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=this.json[e];return n&&Number.isFinite(n.byteOffset)?this._getTypedArrayFromBinary(e,t,r,1,n.byteOffset):n}},{key:"getPropertyArray",value:function(e,t,r){var n=this.json[e];return n&&Number.isFinite(n.byteOffset)?("componentType"in n&&(t=Xu.fromName(n.componentType)),this._getTypedArrayFromBinary(e,t,r,this.featuresLength,n.byteOffset)):this._getTypedArrayFromArray(e,t,n)}},{key:"getProperty",value:function(e,t,r,n,i){var o=this.json[e];if(!o)return o;var a=this.getPropertyArray(e,t,r);if(1===r)return a[n];for(var s=0;s<r;++s)i[s]=a[r*n+s];return i}},{key:"_getTypedArrayFromBinary",value:function(e,t,r,n,i){var o=this._cachedTypedArrays,a=o[e];return a||(a=Xu.createTypedArray(t,this.buffer.buffer,this.buffer.byteOffset+i,n*r),o[e]=a),a}},{key:"_getTypedArrayFromArray",value:function(e,t,r){var n=this._cachedTypedArrays,i=n[e];return i||(i=Xu.createTypedArray(t,r),n[e]=i),i}}]),e}(),tc={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},rc={SCALAR:function(e,t){return e[t]},VEC2:function(e,t){return[e[2*t+0],e[2*t+1]]},VEC3:function(e,t){return[e[3*t+0],e[3*t+1],e[3*t+2]]},VEC4:function(e,t){return[e[4*t+0],e[4*t+1],e[4*t+2],e[4*t+3]]},MAT2:function(e,t){return[e[4*t+0],e[4*t+1],e[4*t+2],e[4*t+3]]},MAT3:function(e,t){return[e[9*t+0],e[9*t+1],e[9*t+2],e[9*t+3],e[9*t+4],e[9*t+5],e[9*t+6],e[9*t+7],e[9*t+8]]},MAT4:function(e,t){return[e[16*t+0],e[16*t+1],e[16*t+2],e[16*t+3],e[16*t+4],e[16*t+5],e[16*t+6],e[16*t+7],e[16*t+8],e[16*t+9],e[16*t+10],e[16*t+11],e[16*t+12],e[16*t+13],e[16*t+14],e[16*t+15]]}},nc={SCALAR:function(e,t,r){t[r]=e},VEC2:function(e,t,r){t[2*r+0]=e[0],t[2*r+1]=e[1]},VEC3:function(e,t,r){t[3*r+0]=e[0],t[3*r+1]=e[1],t[3*r+2]=e[2]},VEC4:function(e,t,r){t[4*r+0]=e[0],t[4*r+1]=e[1],t[4*r+2]=e[2],t[4*r+3]=e[3]},MAT2:function(e,t,r){t[4*r+0]=e[0],t[4*r+1]=e[1],t[4*r+2]=e[2],t[4*r+3]=e[3]},MAT3:function(e,t,r){t[9*r+0]=e[0],t[9*r+1]=e[1],t[9*r+2]=e[2],t[9*r+3]=e[3],t[9*r+4]=e[4],t[9*r+5]=e[5],t[9*r+6]=e[6],t[9*r+7]=e[7],t[9*r+8]=e[8],t[9*r+9]=e[9]},MAT4:function(e,t,r){t[16*r+0]=e[0],t[16*r+1]=e[1],t[16*r+2]=e[2],t[16*r+3]=e[3],t[16*r+4]=e[4],t[16*r+5]=e[5],t[16*r+6]=e[6],t[16*r+7]=e[7],t[16*r+8]=e[8],t[16*r+9]=e[9],t[16*r+10]=e[10],t[16*r+11]=e[11],t[16*r+12]=e[12],t[16*r+13]=e[13],t[16*r+14]=e[14],t[16*r+15]=e[15]}};function ic(e){throw new Error('"'+e+'" is read-only')}var oc=function(e){return void 0!==e};function ac(e,t,r){if(!t)return null;var n=e.getExtension("3DTILES_batch_table_hierarchy"),i=t.HIERARCHY;return i&&(console.warn("3D Tile Parser: HIERARCHY is deprecated. Use 3DTILES_batch_table_hierarchy."),t.extensions=t.extensions||{},t.extensions["3DTILES_batch_table_hierarchy"]=i,n=i),n?function(e,t){var r,n,i,o,a=e.instancesLength,s=e.classes,u=e.classIds,c=e.parentCounts,l=e.parentIds,f=a;oc(u.byteOffset)&&(u.componentType=defaultValue(u.componentType,GL.UNSIGNED_SHORT),u.type=AttributeType.SCALAR,i=getBinaryAccessor(u),ic("classIds"),u=i.createArrayBufferView(t.buffer,t.byteOffset+u.byteOffset,a));if(oc(c))for(oc(c.byteOffset)&&(c.componentType=defaultValue(c.componentType,GL.UNSIGNED_SHORT),c.type=AttributeType.SCALAR,i=getBinaryAccessor(c),ic("parentCounts"),c=i.createArrayBufferView(t.buffer,t.byteOffset+c.byteOffset,a)),o=new Uint16Array(a),ic("parentIdsLength"),f=0,r=0;r<a;++r)o[r]=f,f+=(ic("parentIdsLength"),c[r]);oc(l)&&oc(l.byteOffset)&&(l.componentType=defaultValue(l.componentType,GL.UNSIGNED_SHORT),l.type=AttributeType.SCALAR,i=getBinaryAccessor(l),ic("parentIds"),l=i.createArrayBufferView(t.buffer,t.byteOffset+l.byteOffset,f));var h=s.length;for(r=0;r<h;++r){var p=s[r].length,d=s[r].instances,y=getBinaryProperties(p,d,t);s[r].instances=combine(y,d)}var v=new Array(h).fill(0),g=new Uint16Array(a);for(r=0;r<a;++r)n=u[r],g[r]=v[n],++v[n];var m={classes:s,classIds:u,classIndexes:g,parentCounts:c,parentIndexes:o,parentIds:l};return function(e){for(var t=e.classIds.length,r=0;r<t;++r)uc(e,r,stack)}(m),m}(n,r):null}function sc(e,t,r){if(e){var n=e.parentCounts;return e.parentIds?r(e,t):n>0?function(e,t,r){var n=e.classIds,i=e.parentCounts,o=e.parentIds,a=e.parentIndexes,s=n.length,u=scratchVisited;u.length=Math.max(u.length,s);var c=++marker,l=scratchStack;l.length=0,l.push(t);for(;l.length>0;)if(t=l.pop(),u[t]!==c){u[t]=c;var f=r(e,t);if(oc(f))return f;for(var h=i[t],p=a[t],d=0;d<h;++d){var y=o[p+d];y!==t&&l.push(y)}}return null}(e,t,r):function(e,t,r){var n=!0;for(;n;){var i=r(e,t);if(oc(i))return i;var o=e.parentIds[t];n=o!==t,t=o}throw new Error("traverseHierarchySingleParent")}(e,t,r)}}function uc(e,t,r){var n=e.parentCounts,i=e.parentIds,o=e.parentIndexes,a=e.classIds.length;if(oc(i)){assert(t<a,"Parent index ".concat(t," exceeds the total number of instances: ").concat(a)),assert(-1===r.indexOf(t),"Circular dependency detected in the batch table hierarchy."),r.push(t);for(var s=oc(n)?n[t]:1,u=oc(n)?o[t]:t,c=0;c<s;++c){var l=i[u+c];l!==t&&uc(e,l,r)}r.pop(t)}}function cc(e){return null!=e}var lc=function(e,t){return e},fc={HIERARCHY:!0,extensions:!0,extras:!0},hc=function(){function e(t,r,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};for(var o in Le(this,e),X(n>=0),this.json=t||{},this.binary=r,this.featureCount=n,this._extensions=this.json&&this.json.extensions||{},this._properties={},this.json)fc[o]||(this._properties[o]=this.json[o]);this._binaryProperties=this._initializeBinaryProperties(),i["3DTILES_batch_table_hierarchy"]&&(this._hierarchy=ac(this,this.json,this.binary))}return Ce(e,[{key:"getExtension",value:function(e){return this.json&&this.json.extensions&&this.json.extensions[e]}},{key:"memorySizeInBytes",value:function(){return 0}},{key:"isClass",value:function(e,t){return this._checkBatchId(e),X("string"==typeof t,t),!!this._hierarchy&&cc(sc(this._hierarchy,e,(function(e,r){var n=e.classIds[r];return e.classes[n].name===t})))}},{key:"isExactClass",value:function(e,t){return X("string"==typeof t,t),this.getExactClassName(e)===t}},{key:"getExactClassName",value:function(e){if(this._checkBatchId(e),this._hierarchy){var t=this._hierarchy.classIds[e];return this._hierarchy.classes[t].name}}},{key:"hasProperty",value:function(e,t){return this._checkBatchId(e),X("string"==typeof t,t),cc(this._properties[t])||this._hasPropertyInHierarchy(e,t)}},{key:"getPropertyNames",value:function(e,t){var r;this._checkBatchId(e),(t=cc(t)?t:[]).length=0;var n=Object.keys(this._properties);return(r=t).push.apply(r,Mt(n)),this._hierarchy&&this._getPropertyNamesInHierarchy(e,t),t}},{key:"getProperty",value:function(e,t){if(this._checkBatchId(e),X("string"==typeof t,t),this._binaryProperties){var r=this._binaryProperties[t];if(cc(r))return this._getBinaryProperty(r,e)}var n=this._properties[t];if(cc(n))return lc(n[e]);if(this._hierarchy){var i=this._getHierarchyProperty(e,t);if(cc(i))return i}}},{key:"setProperty",value:function(e,t,r){var n=this.featureCount;if(this._checkBatchId(e),X("string"==typeof t,t),this._binaryProperties){var i=this._binaryProperties[t];if(i)return void this._setBinaryProperty(i,e,r)}if(!this._hierarchy||!this._setHierarchyProperty(this,e,t,r)){var o=this._properties[t];cc(o)||(this._properties[t]=new Array(n),o=this._properties[t]),o[e]=lc(r)}}},{key:"_checkBatchId",value:function(e){if(!(e>=0&&e<this.featureCount))throw new Error("batchId not in range [0, featureCount - 1].")}},{key:"_getBinaryProperty",value:function(e,t){return e.unpack(e.typedArray,t)}},{key:"_setBinaryProperty",value:function(e,t,r){e.pack(r,e.typedArray,t)}},{key:"_initializeBinaryProperties",value:function(){var e=null;for(var t in this._properties){var r=this._properties[t],n=this._initializeBinaryProperty(t,r);n&&((e=e||{})[t]=n)}return e}},{key:"_initializeBinaryProperty",value:function(e,t){if("byteOffset"in t){var r=t;X(this.binary,"Property ".concat(e," requires a batch table binary.")),X(r.type,"Property ".concat(e," requires a type."));var n=function(e,t,r,n){var i=e.componentType;X(e.componentType);var o="string"==typeof i?Xu.fromName(i):i,a=tc[e.type],s=rc[e.type],u=nc[e.type];return r+=e.byteOffset,{values:Xu.createTypedArray(o,t,r,a*n),type:o,size:a,unpacker:s,packer:u}}(r,this.binary.buffer,0|this.binary.byteOffset,this.featureCount);return{typedArray:n.values,componentCount:n.size,unpack:n.unpacker,pack:n.packer}}return null}},{key:"_hasPropertyInHierarchy",value:function(e,t){if(!this._hierarchy)return!1;var r=sc(this._hierarchy,e,(function(e,r){var n=e.classIds[r];return cc(e.classes[n].instances[t])}));return cc(r)}},{key:"_getPropertyNamesInHierarchy",value:function(e,t){sc(this._hierarchy,e,(function(e,r){var n=e.classIds[r],i=e.classes[n].instances;for(var o in i)i.hasOwnProperty(o)&&-1===t.indexOf(o)&&t.push(o)}))}},{key:"_getHierarchyProperty",value:function(e,t){var r=this;return sc(this._hierarchy,e,(function(e,n){var i=e.classIds[n],o=e.classes[i],a=e.classIndexes[n],s=o.instances[t];return cc(s)?cc(s.typedArray)?r._getBinaryProperty(s,a):lc(s[a]):null}))}},{key:"_setHierarchyProperty",value:function(e,t,r,n){var i=this,o=sc(this._hierarchy,t,(function(e,o){var a=e.classIds[o],s=e.classes[a],u=e.classIndexes[o],c=s.instances[r];return!!cc(c)&&(X(o===t,'Inherited property "'.concat(r,'" is read-only.')),cc(c.typedArray)?i._setBinaryProperty(c,u,n):c[u]=lc(n),!0)}));return cc(o)}}]),e}();function pc(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=new DataView(t);if(e.magic=n.getUint32(r,!0),r+=4,e.version=n.getUint32(r,!0),r+=4,e.byteLength=n.getUint32(r,!0),r+=4,1!==e.version)throw new Error("3D Tile Version ".concat(e.version," not supported"));return r}function dc(e,t,r){var n=new DataView(t);return e.header=e.header||{},e.header.featureTableJsonByteLength=n.getUint32(r,!0),r+=4,e.header.featureTableBinaryByteLength=n.getUint32(r,!0),r+=4,e.header.batchTableJsonByteLength=n.getUint32(r,!0),r+=4,e.header.batchTableBinaryByteLength=n.getUint32(r,!0),r+=4}function yc(e,t,r,n){return r=function(e,t,r,n){var i=e.header,o=i.featureTableJsonByteLength,a=i.featureTableBinaryByteLength;if(e.featureTableJson={BATCH_LENGTH:0},o>0){var s=mu(t,r,o);e.featureTableJson=JSON.parse(s)}return r+=o,e.featureTableBinary=new Uint8Array(t,r,a),r+=a}(e,t,r),r=function(e,t,r,n){var i=e.header,o=i.batchTableJsonByteLength,a=i.batchTableBinaryByteLength;if(o>0){var s=mu(t,r,o);e.batchTableJson=JSON.parse(s),r+=o,a>0&&(e.batchTableBinary=new Uint8Array(t,r,a),e.batchTableBinary=new Uint8Array(e.batchTableBinary),r+=a)}return r}(e,t,r)}function vc(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0],r=e>>11&31,n=e>>5&63,i=31&e;return t[0]=r<<3,t[1]=n<<2,t[2]=i<<3,t}function gc(e,t,r){if(!(t||e&&e.batchIds&&r))return null;var n=e.batchIds,i=e.isRGB565,o=e.pointCount;if(n&&r){for(var a=new Uint8ClampedArray(3*o),s=0;s<o;s++){var u=n[s],c=r.getProperty(u,"dimensions").map((function(e){return 255*e}));a[3*s]=c[0],a[3*s+1]=c[1],a[3*s+2]=c[2]}return{type:Yu.UNSIGNED_BYTE,value:a,size:3,normalized:!0}}if(i){for(var l=new Uint8ClampedArray(3*o),f=0;f<o;f++){var h=vc(t[f]);l[3*f]=h[0],l[3*f+1]=h[1],l[3*f+2]=h[2]}return{type:Yu.UNSIGNED_BYTE,value:l,size:3,normalized:!0}}return t&&t.length===3*o?{type:Yu.UNSIGNED_BYTE,value:t,size:3,normalized:!0}:{type:Yu.UNSIGNED_BYTE,value:t,size:4,normalized:!0}}function mc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Nr(e);if(t){var i=Nr(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Cr(this,r)}}var bc=function(e){Lr(r,e);var t=mc(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Er(this,r),e=t.call(this,2),Qr(n)&&1===arguments.length?e.copy(n):(Wr.debug&&(an(n),an(i)),e[0]=n,e[1]=i),e}return jr(r,[{key:"set",value:function(e,t){return this[0]=e,this[1]=t,this.check()}},{key:"copy",value:function(e){return this[0]=e[0],this[1]=e[1],this.check()}},{key:"fromObject",value:function(e){return Wr.debug&&(an(e.x),an(e.y)),this[0]=e.x,this[1]=e.y,this.check()}},{key:"toObject",value:function(e){return e.x=this[0],e.y=this[1],e}},{key:"horizontalAngle",value:function(){return Math.atan2(this.y,this.x)}},{key:"verticalAngle",value:function(){return Math.atan2(this.x,this.y)}},{key:"transform",value:function(e){return this.transformAsPoint(e)}},{key:"transformAsPoint",value:function(e){return Zn(this,this,e),this.check()}},{key:"transformAsVector",value:function(e){return _n(this,this,e),this.check()}},{key:"transformByMatrix3",value:function(e){return Hn(this,this,e),this.check()}},{key:"transformByMatrix2x3",value:function(e){return function(e,t,r){var n=t[0],i=t[1];e[0]=r[0]*n+r[2]*i+r[4],e[1]=r[1]*n+r[3]*i+r[5]}(this,this,e),this.check()}},{key:"transformByMatrix2",value:function(e){return function(e,t,r){var n=t[0],i=t[1];e[0]=r[0]*n+r[2]*i,e[1]=r[1]*n+r[3]*i}(this,this,e),this.check()}},{key:"ELEMENTS",get:function(){return 2}}]),r}(fn);function wc(e,t){if(!e)throw new Error("math.gl assertion failed. ".concat(t))}new bc,new Pn,new bc,new bc,new Uint8Array(1);function xc(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:255;return Xr(e,0,t)/t*2-1}function kc(e){return e<0?-1:1}function _c(e,t,r,n){if(wc(n),e<0||e>r||t<0||t>r)throw new Error("x and y must be unsigned normalized integers between 0 and ".concat(r));if(n.x=xc(e,r),n.y=xc(t,r),n.z=1-(Math.abs(n.x)+Math.abs(n.y)),n.z<0){var i=n.x;n.x=(1-Math.abs(n.y))*kc(i),n.y=(1-Math.abs(i))*kc(n.y)}return n.normalize()}function Oc(e,t,r){return _c(e,t,255,r)}var Tc=new Pn;function Sc(e,t,r){return e.isQuantized?r["3d-tiles"]&&r["3d-tiles"].decodeQuantizedPositions?(e.isQuantized=!1,function(e,t){for(var r=new Pn,n=new Float32Array(3*e.pointCount),i=0;i<e.pointCount;i++)r.set(t[3*i],t[3*i+1],t[3*i+2]).scale(1/e.quantizedRange).multiply(e.quantizedVolumeScale).add(e.quantizedVolumeOffset).toArray(n,3*i);return n}(e,t)):{type:Yu.UNSIGNED_SHORT,value:t,size:3,normalized:!0}:t}function Ac(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Pc(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ac(Object(r),!0).forEach((function(t){$(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ac(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Ec(e,t,r,n,i){return Mc.apply(this,arguments)}function Mc(){return(Mc=V(F.a.mark((function e(t,r,n,i,o){var a,s,u;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=pc(t,r,n),n=dc(t,r,n),n=yc(t,r,n),jc(t),a=Ic(t),s=a.featureTable,u=a.batchTable,e.next=7,Nc(t,s,u,i,o);case 7:return Lc(t,s,i),Rc(t,s,u),Cc(t,s),e.abrupt("return",n);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function jc(e){e.attributes={positions:null,colors:null,normals:null,batchIds:null},e.isQuantized=!1,e.isTranslucent=!1,e.isRGB565=!1,e.isOctEncoded16P=!1}function Ic(e){var t=new ec(e.featureTableJson,e.featureTableBinary),r=t.getGlobalProperty("POINTS_LENGTH");if(!Number.isFinite(r))throw new Error("POINTS_LENGTH must be defined");t.featuresLength=r,e.featuresLength=r,e.pointsLength=r,e.pointCount=r,e.rtcCenter=t.getGlobalProperty("RTC_CENTER",Yu.FLOAT,3);var n=function(e,t){var r=null;if(!e.batchIds&&t.hasProperty("BATCH_ID")&&(e.batchIds=t.getPropertyArray("BATCH_ID",Yu.UNSIGNED_SHORT,1),e.batchIds)){var n=t.getGlobalProperty("BATCH_LENGTH");if(!n)throw new Error("Global property: BATCH_LENGTH must be defined when BATCH_ID is defined.");var i=e.batchTableJson,o=e.batchTableBinary;r=new hc(i,o,n)}return r}(e,t);return{featureTable:t,batchTable:n}}function Lc(e,t,r){if(!e.attributes.positions)if(t.hasProperty("POSITION"))e.attributes.positions=t.getPropertyArray("POSITION",Yu.FLOAT,3);else if(t.hasProperty("POSITION_QUANTIZED")){var n=t.getPropertyArray("POSITION_QUANTIZED",Yu.UNSIGNED_SHORT,3);if(e.isQuantized=!0,e.quantizedRange=65535,e.quantizedVolumeScale=t.getGlobalProperty("QUANTIZED_VOLUME_SCALE",Yu.FLOAT,3),!e.quantizedVolumeScale)throw new Error("QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");if(e.quantizedVolumeOffset=t.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",Yu.FLOAT,3),!e.quantizedVolumeOffset)throw new Error("QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");e.attributes.positions=Sc(e,n,r)}if(!e.attributes.positions)throw new Error("Either POSITION or POSITION_QUANTIZED must be defined.")}function Rc(e,t,r){if(!e.attributes.colors){var n=null;t.hasProperty("RGBA")?(n=t.getPropertyArray("RGBA",Yu.UNSIGNED_BYTE,4),e.isTranslucent=!0):t.hasProperty("RGB")?n=t.getPropertyArray("RGB",Yu.UNSIGNED_BYTE,3):t.hasProperty("RGB565")&&(n=t.getPropertyArray("RGB565",Yu.UNSIGNED_SHORT,1),e.isRGB565=!0),e.attributes.colors=gc(e,n,r)}t.hasProperty("CONSTANT_RGBA")&&(e.constantRGBA=t.getGlobalProperty("CONSTANT_RGBA",Yu.UNSIGNED_BYTE,4))}function Cc(e,t){if(!e.attributes.normals){var r=null;t.hasProperty("NORMAL")?r=t.getPropertyArray("NORMAL",Yu.FLOAT,3):t.hasProperty("NORMAL_OCT16P")&&(r=t.getPropertyArray("NORMAL_OCT16P",Yu.UNSIGNED_BYTE,2),e.isOctEncoded16P=!0),e.attributes.normals=function(e,t){if(!t)return null;if(e.isOctEncoded16P){for(var r=new Float32Array(3*e.pointsLength),n=0;n<e.pointsLength;n++)Oc(t[2*n],t[2*n+1],Tc),Tc.toArray(r,3*n);return{type:Yu.FLOAT,size:2,value:r}}return{type:Yu.FLOAT,size:2,value:t}}(e,r)}}function Nc(e,t,r,n,i){return Dc.apply(this,arguments)}function Dc(){return(Dc=V(F.a.mark((function e(t,r,n,i,o){var a,s,u,c,l,f,h,p;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((c=t.batchTableJson&&t.batchTableJson.extensions&&t.batchTableJson.extensions["3DTILES_draco_point_compression"])&&(u=c.properties),!(l=r.getExtension("3DTILES_draco_point_compression"))){e.next=15;break}if(s=l.properties,f=l.byteOffset,h=l.byteLength,s&&Number.isFinite(f)&&h){e.next=9;break}throw new Error("Draco properties, byteOffset, and byteLength must be defined");case 9:a=t.featureTableBinary.slice(f,f+h),t.hasPositions=Number.isFinite(s.POSITION),t.hasColors=Number.isFinite(s.RGB)||Number.isFinite(s.RGBA),t.hasNormals=Number.isFinite(s.NORMAL),t.hasBatchIds=Number.isFinite(s.BATCH_ID),t.isTranslucent=Number.isFinite(s.RGBA);case 15:if(a){e.next=17;break}return e.abrupt("return",!0);case 17:return p={buffer:a,properties:Pc(Pc({},s),u),featureTableProperties:s,batchTableProperties:u,dequantizeInShader:!1},e.next=20,Uc(t,p,i,o);case 20:return e.abrupt("return",e.sent);case 21:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Uc(e,t,r,n){return Fc.apply(this,arguments)}function Fc(){return(Fc=V(F.a.mark((function e(t,r,n,i){var o,a,s,u,c,l,f,h,p,d,y,v,g,m;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=i.parse,e.next=3,o(r.buffer,Gu,{draco:{extraAttributes:r.batchTableProperties||{}}});case 3:if(a=e.sent,s=a.attributes.POSITION&&a.attributes.POSITION.value,u=a.attributes.COLOR_0&&a.attributes.COLOR_0.value,c=a.attributes.NORMAL&&a.attributes.NORMAL.value,l=a.attributes.BATCH_ID&&a.attributes.BATCH_ID.value,f=s&&a.attributes.POSITION.value.quantization,h=c&&a.attributes.NORMAL.value.quantization,f&&(p=a.POSITION.data.quantization,d=p.range,t.quantizedVolumeScale=new Pn(d,d,d),t.quantizedVolumeOffset=new Pn(p.minValues),t.quantizedRange=(1<<p.quantizationBits)-1,t.isQuantizedDraco=!0),h&&(t.octEncodedRange=(1<<a.NORMAL.data.quantization.quantizationBits)-1,t.isOctEncodedDraco=!0),y={},r.batchTableProperties)for(v=0,g=Object.keys(r.batchTableProperties);v<g.length;v++)m=g[v],a.attributes[m]&&a.attributes[m].value&&(y[m.toLowerCase()]=a.attributes[m].value);t.attributes=Pc({positions:s,colors:gc(t,u),normals:c,batchIds:l},y);case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Bc(e,t){if(!e)throw new Error(t)}var Vc={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:"undefined"!=typeof global&&global,document:"undefined"!=typeof document&&document},zc=Vc.global||Vc.self||Vc.window,qc="object"!==("undefined"==typeof process?"undefined":z(process))||"[object process]"!==String(process)||process.browser,Gc="undefined"!=typeof process&&process.version&&process.version.match(/v([0-9]*)/),Wc=(Gc&&parseFloat(Gc[1]),zc._parseImageNode),Hc="undefined"!=typeof Image,Zc="undefined"!=typeof ImageBitmap,Qc=Boolean(Wc),Kc=!!qc||Qc;function Yc(e){var t=$c(e);if(!t)throw new Error("Not an image");return t}function Jc(e){switch(Yc(e)){case"data":return e;case"image":case"imagebitmap":var t=document.createElement("canvas"),r=t.getContext("2d");if(r)return t.width=e.width,t.height=e.height,r.drawImage(e,0,0),r.getImageData(0,0,e.width,e.height);default:return Bc(!1)}}function $c(e){return"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap?"imagebitmap":"undefined"!=typeof Image&&e instanceof Image?"image":e&&"object"===z(e)&&e.data&&e.width&&e.height?"data":null}var Xc=/^data:image\/svg\+xml/,el=/\.svg((\?|#).*)?$/;function tl(e){return e&&(Xc.test(e)||el.test(e))}function rl(e,t){if(tl(t)){var r=(new TextDecoder).decode(e);return"data:image/svg+xml;base64,".concat(btoa(r))}return nl(e,t)}function nl(e,t){if(tl(t))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(e)])}function il(e,t,r){return ol.apply(this,arguments)}function ol(){return(ol=V(F.a.mark((function e(t,r,n){var i,o,a;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=rl(t,n),o=self.URL||self.webkitURL,a="string"!=typeof i&&o.createObjectURL(i),e.prev=3,e.next=6,al(a||i,r);case 6:return e.abrupt("return",e.sent);case 7:return e.prev=7,a&&o.revokeObjectURL(a),e.finish(7);case 10:case"end":return e.stop()}}),e,null,[[3,,7,10]])})))).apply(this,arguments)}function al(e,t){return sl.apply(this,arguments)}function sl(){return(sl=V(F.a.mark((function e(t,r){var n;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((n=new Image).src=t,!(r.image&&r.image.decode&&n.decode)){e.next=6;break}return e.next=5,n.decode();case 5:return e.abrupt("return",n);case 6:return e.next=8,new Promise((function(e,r){try{n.onload=function(){return e(n)},n.onerror=function(e){return r(new Error("Could not load image ".concat(t,": ").concat(e)))}}catch(e){r(e)}}));case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ul={},cl=!0;function ll(e,t,r){return fl.apply(this,arguments)}function fl(){return(fl=V(F.a.mark((function e(t,r,n){var i,o,a;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!tl(n)){e.next=7;break}return e.next=3,il(t,r,n);case 3:o=e.sent,i=o,e.next=8;break;case 7:i=nl(t,n);case 8:return a=r&&r.imagebitmap,e.next=11,hl(i,a);case 11:return e.abrupt("return",e.sent);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function hl(e){return pl.apply(this,arguments)}function pl(){return(pl=V(F.a.mark((function e(t){var r,n=arguments;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!dl(r=n.length>1&&void 0!==n[1]?n[1]:null)&&cl||(r=null),!r){e.next=13;break}return e.prev=3,e.next=6,createImageBitmap(t,r);case 6:return e.abrupt("return",e.sent);case 9:e.prev=9,e.t0=e.catch(3),console.warn(e.t0),cl=!1;case 13:return e.next=15,createImageBitmap(t);case 15:return e.abrupt("return",e.sent);case 16:case"end":return e.stop()}}),e,null,[[3,9]])})))).apply(this,arguments)}function dl(e){for(var t in e||ul)return!1;return!0}function yl(e){var t=vl(e);return function(e){var t=vl(e);if(!(t.byteLength>=24&&2303741511===t.getUint32(0,!1)))return null;return{mimeType:"image/png",width:t.getUint32(16,!1),height:t.getUint32(20,!1)}}(t)||function(e){var t=vl(e);if(!(t.byteLength>=3&&65496===t.getUint16(0,!1)&&255===t.getUint8(2)))return null;var r=function(){for(var e=new Set([65499,65476,65484,65501,65534]),t=65504;t<65520;++t)e.add(t);var r=new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502]);return{tableMarkers:e,sofMarkers:r}}(),n=r.tableMarkers,i=r.sofMarkers,o=2;for(;o+9<t.byteLength;){var a=t.getUint16(o,!1);if(i.has(a))return{mimeType:"image/jpeg",height:t.getUint16(o+5,!1),width:t.getUint16(o+7,!1)};if(!n.has(a))return null;o+=2,o+=t.getUint16(o,!1)}return null}(t)||function(e){var t=vl(e);if(!(t.byteLength>=10&&1195984440===t.getUint32(0,!1)))return null;return{mimeType:"image/gif",width:t.getUint16(6,!0),height:t.getUint16(8,!0)}}(t)||function(e){var t=vl(e);if(!(t.byteLength>=14&&16973===t.getUint16(0,!1)&&t.getUint32(2,!0)===t.byteLength))return null;return{mimeType:"image/bmp",width:t.getUint32(18,!0),height:t.getUint32(22,!0)}}(t)}function vl(e){if(e instanceof DataView)return e;if(ArrayBuffer.isView(e))return new DataView(e.buffer);if(e instanceof ArrayBuffer)return new DataView(e);throw new Error("toDataView")}function gl(e,t){var r=(yl(e)||{}).mimeType,n=zc._parseImageNode;return Bc(n),n(e,r,t)}function ml(){return(ml=V(F.a.mark((function e(t,r,n){var i,o,a,s,u;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=(r=r||{}).image||{},o=i.type||"auto",a=(n||{}).url,s=bl(o),e.t0=s,e.next="imagebitmap"===e.t0?8:"image"===e.t0?12:"data"===e.t0?16:20;break;case 8:return e.next=10,ll(t,r,a);case 10:return u=e.sent,e.abrupt("break",21);case 12:return e.next=14,il(t,r,a);case 14:return u=e.sent,e.abrupt("break",21);case 16:return e.next=18,gl(t,r);case 18:return u=e.sent,e.abrupt("break",21);case 20:Bc(!1);case 21:return"data"===o&&(u=Jc(u)),e.abrupt("return",u);case 23:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function bl(e){switch(e){case"auto":case"data":return function(){if(Zc)return"imagebitmap";if(Hc)return"image";if(Kc)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}();default:return function(e){switch(e){case"auto":return Zc||Hc||Kc;case"imagebitmap":return Zc;case"image":return Hc;case"data":return Kc;case"html":return Hc;case"ndarray":return Kc;default:throw new Error("@loaders.gl/images: image ".concat(e," not supported in this environment"))}}(e),e}}var wl={id:"image",name:"Images",version:"2.3.13",mimeTypes:["image/png","image/jpeg","image/gif","image/webp","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],extensions:["png","jpg","jpeg","gif","webp","bmp","ico","svg"],parse:function(e,t,r){return ml.apply(this,arguments)},tests:[function(e){return Boolean(yl(new DataView(e)))}],options:{image:{type:"auto",decode:!0}}};function xl(e,t,r){if(e.byteLength<=t+r)return"";for(var n=new DataView(e),i="",o=0;o<r;o++)i+=String.fromCharCode(n.getUint8(t+o));return i}function kl(e){try{return JSON.parse(e)}catch(t){throw new Error('Failed to parse JSON from data starting with "'.concat(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;if("string"==typeof e)return e.slice(0,t);if(ArrayBuffer.isView(e))return xl(e.buffer,e.byteOffset,t);if(e instanceof ArrayBuffer){var r=0;return xl(e,r,t)}return""}(e),'"'))}}function _l(e){return e+3&-4}function Ol(e,t,r){return function(e,t,r){var n=void 0!==r?new Uint8Array(e).subarray(t,t+r):new Uint8Array(e).subarray(t);return new Uint8Array(n).buffer}(e,t,r)}function Tl(e,t,r){var n;if(e instanceof ArrayBuffer)n=new Uint8Array(e);else{var i=e.byteOffset,o=e.byteLength;n=new Uint8Array(e.buffer,i,o)}return t.set(n,r),r+_l(n.byteLength)}function Sl(e,t){if(!e)throw new Error(t||"assert failed: gltf")}function Al(e,t){if(e.startsWith("data:")||e.startsWith("http:")||e.startsWith("https:"))return e;var r=t.baseUri||t.uri;if(!r)throw new Error("'baseUri' must be provided to resolve relative url ".concat(e));return r.substr(0,r.lastIndexOf("/")+1)+e}function Pl(e,t,r){var n=e.bufferViews[r];Sl(n);var i=t[n.buffer];Sl(i);var o=(n.byteOffset||0)+i.byteOffset;return new Uint8Array(i.arrayBuffer,o,n.byteLength)}var El=["SCALAR","VEC2","VEC3","VEC4"],Ml=new Map([[Int8Array,5120],[Uint8Array,5121],[Int16Array,5122],[Uint16Array,5123],[Uint32Array,5125],[Float32Array,5126]]),jl={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Il={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},Ll={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function Rl(e){return El[e-1]||El[0]}function Cl(e){var t=Ml.get(e.constructor);if(!t)throw new Error("Illegal typed array");return t}function Nl(e,t){var r=Ll[e.componentType],n=jl[e.type],i=Il[e.componentType],o=e.count*n,a=e.count*n*i;return Sl(a>=0&&a<=t.byteLength),{ArrayType:r,length:o,byteLength:a}}var Dl=function(){function e(t){if(Le(this,e),t instanceof e)return t;t||(t={json:{asset:{version:"2.0",generator:"loaders.gl"},buffers:[]},buffers:[]}),this.byteLength=0,this.gltf=t,Sl(this.gltf.json)}return Ce(e,[{key:"getApplicationData",value:function(e){return this.json[e]}},{key:"getExtraData",value:function(e){return(this.json.extras||{})[e]}},{key:"getExtension",value:function(e){var t=this.getUsedExtensions().find((function(t){return t===e})),r=this.json.extensions||{};return t?r[e]||!0:null}},{key:"getRequiredExtension",value:function(e){return this.getRequiredExtensions().find((function(t){return t===e}))?this.getExtension(e):null}},{key:"getRequiredExtensions",value:function(){return this.json.extensionsRequired||[]}},{key:"getUsedExtensions",value:function(){return this.json.extensionsUsed||[]}},{key:"getObjectExtension",value:function(e,t){return(e.extensions||{})[t]}},{key:"getScene",value:function(e){return this.getObject("scenes",e)}},{key:"getNode",value:function(e){return this.getObject("nodes",e)}},{key:"getSkin",value:function(e){return this.getObject("skins",e)}},{key:"getMesh",value:function(e){return this.getObject("meshes",e)}},{key:"getMaterial",value:function(e){return this.getObject("materials",e)}},{key:"getAccessor",value:function(e){return this.getObject("accessors",e)}},{key:"getCamera",value:function(e){return null}},{key:"getTexture",value:function(e){return this.getObject("textures",e)}},{key:"getSampler",value:function(e){return this.getObject("samplers",e)}},{key:"getImage",value:function(e){return this.getObject("images",e)}},{key:"getBufferView",value:function(e){return this.getObject("bufferViews",e)}},{key:"getBuffer",value:function(e){return this.getObject("buffers",e)}},{key:"getObject",value:function(e,t){if("object"===z(t))return t;var r=this.json[e]&&this.json[e][t];if(!r)throw new Error("glTF file error: Could not find ".concat(e,"[").concat(t,"]"));return r}},{key:"getTypedArrayForBufferView",value:function(e){var t=(e=this.getBufferView(e)).buffer,r=this.gltf.buffers[t];Sl(r);var n=(e.byteOffset||0)+r.byteOffset;return new Uint8Array(r.arrayBuffer,n,e.byteLength)}},{key:"getTypedArrayForAccessor",value:function(e){e=this.getAccessor(e);var t=this.getBufferView(e.bufferView),r=this.getBuffer(t.buffer).data,n=Nl(e,t),i=n.ArrayType,o=n.length;return new i(r,t.byteOffset+e.byteOffset,o)}},{key:"getTypedArrayForImageData",value:function(e){e=this.getAccessor(e);var t=this.getBufferView(e.bufferView),r=this.getBuffer(t.buffer).data,n=t.byteOffset||0;return new Uint8Array(r,n,t.byteLength)}},{key:"addApplicationData",value:function(e,t){return this.json[e]=t,this}},{key:"addExtraData",value:function(e,t){return this.json.extras=this.json.extras||{},this.json.extras[e]=t,this}},{key:"addObjectExtension",value:function(e,t,r){return Sl(r),e.extensions=e.extensions||{},e.extensions[t]=r,this.registerUsedExtension(t),this}},{key:"setObjectExtension",value:function(e,t,r){(e.extensions||{})[t]=r}},{key:"removeObjectExtension",value:function(e,t){var r=e.extensions||{},n=r[t];return delete r[t],n}},{key:"addExtension",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Sl(t),this.json.extensions=this.json.extensions||{},this.json.extensions[e]=t,this.registerUsedExtension(e),t}},{key:"addRequiredExtension",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Sl(t),this.addExtension(e,t),this.registerRequiredExtension(e),t}},{key:"registerUsedExtension",value:function(e){this.json.extensionsUsed=this.json.extensionsUsed||[],this.json.extensionsUsed.find((function(t){return t===e}))||this.json.extensionsUsed.push(e)}},{key:"registerRequiredExtension",value:function(e){this.registerUsedExtension(e),this.json.extensionsRequired=this.json.extensionsRequired||[],this.json.extensionsRequired.find((function(t){return t===e}))||this.json.extensionsRequired.push(e)}},{key:"removeExtension",value:function(e){this.json.extensionsRequired&&this._removeStringFromArray(this.json.extensionsRequired,e),this.json.extensionsUsed&&this._removeStringFromArray(this.json.extensionsUsed,e),this.json.extensions&&delete this.json.extensions[e]}},{key:"addMesh",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,n=this._addAttributes(e),i={primitives:[{attributes:n,indices:t,mode:r}]};return this.json.meshes=this.json.meshes||[],this.json.meshes.push(i),this.json.meshes.length-1}},{key:"addPointCloud",value:function(e){var t={primitives:[{attributes:this._addAttributes(e),mode:0}]};return this.json.meshes=this.json.meshes||[],this.json.meshes.push(t),this.json.meshes.length-1}},{key:"addImage",value:function(e,t){var r;t=t||((r=yl(e))?r.mimeType:null);var n={bufferView:this.addBufferView(e),mimeType:t};return this.json.images=this.json.images||[],this.json.images.push(n),this.json.images.length-1}},{key:"addBufferView",value:function(e){var t=e.byteLength;Sl(Number.isFinite(t)),this.sourceBuffers=this.sourceBuffers||[],this.sourceBuffers.push(e);var r={buffer:0,byteOffset:this.byteLength,byteLength:t};return this.byteLength+=_l(t),this.json.bufferViews=this.json.bufferViews||[],this.json.bufferViews.push(r),this.json.bufferViews.length-1}},{key:"addAccessor",value:function(e,t){var r={bufferView:e,type:Rl(t.size),componentType:t.componentType,count:t.count};return this.json.accessors=this.json.accessors||[],this.json.accessors.push(r),this.json.accessors.length-1}},{key:"addBinaryBuffer",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{size:3},r=this.addBufferView(e),n={size:t.size,componentType:Cl(e),count:Math.round(e.length/t.size)};return this.addAccessor(r,Object.assign(n,t))}},{key:"createBinaryChunk",value:function(){if(!this.arrayBuffer){for(var e=this.byteLength,t=new ArrayBuffer(e),r=new Uint8Array(t),n=0,i=0;i<this.sourceBuffers.length;i++){n=Tl(this.sourceBuffers[i],r,n)}this.json.buffers[0].byteLength=e,this.arrayBuffer=t,this.sourceBuffers=[]}}},{key:"_removeStringFromArray",value:function(e,t){for(var r=!0;r;){var n=e.indexOf(t);n>-1?e.splice(n,1):r=!1}}},{key:"json",get:function(){return this.gltf.json}}]),e}();function Ul(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Fl(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ul(Object(r),!0).forEach((function(t){$(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ul(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Bl(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r={};for(var n in e){var i=e[n];if("indices"!==n){var o=Vl(i,t[n]||{});r[n]=o}}return r}function Vl(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=zl(e),n=r.buffer,i=r.size,o=r.count,a=Fl(Fl({},t),{},{value:n,size:i,bufferView:null,byteOffset:0,count:o,type:Rl(i),componentType:Cl(n)});return a}function zl(e){var t=e,r=1,n=0;return e&&e.value&&(t=e.value,r=e.size||1),t&&(ArrayBuffer.isView(t)||(t=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!e)return null;if(Array.isArray(e))return new t(e);if(r&&!(e instanceof t))return new t(e);return e}(t,Float32Array)),n=t.length/r),{buffer:t,size:r,count:n}}function ql(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Gl(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ql(Object(r),!0).forEach((function(t){$(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ql(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Wl=F.a.mark(tf);function Hl(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return Zl(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Zl(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function Zl(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Ql(e,t,r){return Kl.apply(this,arguments)}function Kl(){return(Kl=V(F.a.mark((function e(t,r,n){var i,o,a,s,u;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.gltf.decompressMeshes){e.next=2;break}return e.abrupt("return");case 2:i=new Dl(t),o=[],a=Hl(tf(i));try{for(a.s();!(s=a.n()).done;)u=s.value,i.getObjectExtension(u,"KHR_draco_mesh_compression")&&o.push(Jl(u,i,r,n))}catch(e){a.e(e)}finally{a.f()}return e.next=8,Promise.all(o);case 8:i.removeExtension("KHR_draco_mesh_compression");case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Yl(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=new Dl(e),i=Hl(n.json.meshes||[]);try{for(i.s();!(t=i.n()).done;){var o=t.value;Xl(o,r),n.addRequiredExtension("KHR_draco_mesh_compression")}}catch(e){i.e(e)}finally{i.f()}}function Jl(e,t,r,n){return $l.apply(this,arguments)}function $l(){return($l=V(F.a.mark((function e(t,r,n,i){var o,a,s,u,c,l,f,h,p,d,y,v;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=r.getObjectExtension(t,"KHR_draco_mesh_compression"),a=r.getTypedArrayForBufferView(o.bufferView),s=Ol(a.buffer,a.byteOffset),u=i.parse,delete(c=Gl({},n))["3d-tiles"],e.next=8,u(s,Gu,c,i);case 8:for(l=e.sent,f={},h=0,p=[].concat(Mt(Object.entries(t.attributes)),[["indices",t.indices]]);h<p.length;h++)d=Ss(p[h],2),y=d[0],v=d[1],f[y]=r.getAccessor(v);t.attributes=Bl(l.attributes,f),l.indices&&(t.indices=Vl(l.indices,f.indices||{})),ef(t);case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Xl(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,n=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0;if(!n.DracoWriter||!n.DracoLoader)throw new Error("DracoWriter/DracoLoader not available");var o=n.DracoWriter.encodeSync({attributes:e}),a=i.parseSync,s=a({attributes:e}),u=n._addFauxAttributes(s.attributes),c=n.addBufferView(o),l={primitives:[{attributes:u,mode:r,extensions:$({},"KHR_draco_mesh_compression",{bufferView:c,attributes:u})}]};return l}function ef(e){if(!e.attributes&&Object.keys(e.attributes).length>0)throw new Error("Empty glTF primitive detected: Draco decompression failure?")}function tf(e){var t,r,n,i,o,a;return F.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:t=Hl(e.json.meshes||[]),s.prev=1,t.s();case 3:if((r=t.n()).done){s.next=24;break}n=r.value,i=Hl(n.primitives),s.prev=6,i.s();case 8:if((o=i.n()).done){s.next=14;break}return a=o.value,s.next=12,a;case 12:s.next=8;break;case 14:s.next=19;break;case 16:s.prev=16,s.t0=s.catch(6),i.e(s.t0);case 19:return s.prev=19,i.f(),s.finish(19);case 22:s.next=3;break;case 24:s.next=29;break;case 26:s.prev=26,s.t1=s.catch(1),t.e(s.t1);case 29:return s.prev=29,t.f(),s.finish(29);case 32:case"end":return s.stop()}}),Wl,null,[[1,26,29,32],[6,16,19,22]])}function rf(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return nf(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return nf(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function nf(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function of(e,t){var r=new Dl(e),n=r.json,i=r.getExtension("KHR_lights_punctual");i&&(r.json.lights=i.lights,r.removeExtension("KHR_lights_punctual"));var o,a=rf(n.nodes||[]);try{for(a.s();!(o=a.n()).done;){var s=o.value,u=r.getObjectExtension(s,"KHR_lights_punctual");u&&(s.light=u.light),r.removeObjectExtension(s,"KHR_lights_punctual")}}catch(e){a.e(e)}finally{a.f()}}function af(e,t){var r=new Dl(e),n=r.json;if(n.lights){var i=r.addExtension("KHR_lights_punctual");Sl(!i.lights),i.lights=n.lights,delete n.lights}if(r.json.lights){var o,a=rf(r.json.lights);try{for(a.s();!(o=a.n()).done;){var s=o.value,u=s.node;r.addObjectExtension(u,"KHR_lights_punctual",s)}}catch(e){a.e(e)}finally{a.f()}delete r.json.lights}}function sf(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return uf(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return uf(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function uf(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function cf(e,t){var r=new Dl(e),n=r.json;r.removeExtension("KHR_materials_unlit");var i,o=sf(n.materials||[]);try{for(o.s();!(i=o.n()).done;){var a=i.value;a.extensions&&a.extensions.KHR_materials_unlit&&(a.unlit=!0),r.removeObjectExtension(a,"KHR_materials_unlit")}}catch(e){o.e(e)}finally{o.f()}}function lf(e,t){var r=new Dl(e),n=r.json;if(r.materials){var i,o=sf(n.materials);try{for(o.s();!(i=o.n()).done;){var a=i.value;a.unlit&&(delete a.unlit,r.addObjectExtension(a,"KHR_materials_unlit",{}),r.addExtension("KHR_materials_unlit"))}}catch(e){o.e(e)}finally{o.f()}}}function ff(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return hf(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return hf(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function hf(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function pf(e,t){var r=new Dl(e),n=r.json,i=r.getExtension("KHR_techniques_webgl");if(i){var o,a=function(e,t){var r=e.programs,n=void 0===r?[]:r,i=e.shaders,o=void 0===i?[]:i,a=e.techniques,s=void 0===a?[]:a,u=new TextDecoder;return o.forEach((function(e){if(!Number.isFinite(e.bufferView))throw new Error("KHR_techniques_webgl: no shader code");e.code=u.decode(t.getTypedArrayForBufferView(e.bufferView))})),n.forEach((function(e){e.fragmentShader=o[e.fragmentShader],e.vertexShader=o[e.vertexShader]})),s.forEach((function(e){e.program=n[e.program]})),s}(i,r),s=ff(n.materials||[]);try{for(s.s();!(o=s.n()).done;){var u=o.value,c=r.getObjectExtension(u,"KHR_techniques_webgl");c&&(u.technique=Object.assign({},c,a[c.technique]),u.technique.values=yf(u.technique,r)),r.removeObjectExtension(u,"KHR_techniques_webgl")}}catch(e){s.e(e)}finally{s.f()}r.removeExtension("KHR_techniques_webgl")}}function df(e,t){}function yf(e,t){var r=Object.assign({},e.values);return Object.keys(e.uniforms||{}).forEach((function(t){!e.uniforms[t].value||t in r||(r[t]=e.uniforms[t].value)})),Object.keys(r).forEach((function(e){"object"===z(r[e])&&void 0!==r[e].index&&(r[e].texture=t.getTexture(r[e].index))})),r}var vf={KHR_draco_mesh_compression:i,KHR_lights_punctual:o,KHR_materials_unlit:a,KHR_techniques_webgl:s};function gf(e){return mf.apply(this,arguments)}function mf(){return(mf=V(F.a.mark((function e(t){var r,n,i,o,a,s=arguments;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=s.length>1&&void 0!==s[1]?s[1]:{},n=s.length>2?s[2]:void 0,r.gltf=r.gltf||{},e.t0=F.a.keys(vf);case 4:if((e.t1=e.t0()).done){e.next=14;break}if(i=e.t1.value,o=r.gltf.excludeExtensions||{},i in o&&!o[i]){e.next=12;break}return a=vf[i],e.next=12,a.decode(t,r,n);case 12:e.next=4;break;case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function bf(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return"".concat(String.fromCharCode(e.getUint8(t+0))).concat(String.fromCharCode(e.getUint8(t+1))).concat(String.fromCharCode(e.getUint8(t+2))).concat(String.fromCharCode(e.getUint8(t+3)))}function wf(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=new DataView(e),i=r.magic,o=void 0===i?1735152710:i,a=n.getUint32(t,!1);return a===o||1735152710===a}function xf(e,t,r,n){X(e.header.byteLength>20);var i=t.getUint32(r+0,!0),o=t.getUint32(r+4,!0);return r+=8,X(0===o),_f(e,t,r,i,n),r+=i,r+=Of(e,t,r,e.header.byteLength,n)}function kf(e,t,r,n){return X(e.header.byteLength>20),function(e,t,r,n){for(;r+8<=e.header.byteLength;){var i=t.getUint32(r+0,!0),o=t.getUint32(r+4,!0);switch(r+=8,o){case 1313821514:_f(e,t,r,i,n);break;case 5130562:Of(e,t,r,i,n);break;case 0:n.glb.strict||_f(e,t,r,i,n);break;case 1:n.glb.strict||Of(e,t,r,i,n)}r+=_l(i)}}(e,t,r,n),r+e.header.byteLength}function _f(e,t,r,n,i){var o=new Uint8Array(t.buffer,r,n),a=new TextDecoder("utf8").decode(o);return e.json=JSON.parse(a),_l(n)}function Of(e,t,r,n,i){return e.header.hasBinChunk=!0,e.binChunks.push({byteOffset:r,byteLength:n,arrayBuffer:t.buffer}),_l(n)}function Tf(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return Sf(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Sf(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function Sf(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Af(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return Pf(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Pf(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function Pf(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Ef,Mf={accessors:"accessor",animations:"animation",buffers:"buffer",bufferViews:"bufferView",images:"image",materials:"material",meshes:"mesh",nodes:"node",samplers:"sampler",scenes:"scene",skins:"skin",textures:"texture"},jf={accessor:"accessors",animations:"animation",buffer:"buffers",bufferView:"bufferViews",image:"images",material:"materials",mesh:"meshes",node:"nodes",sampler:"samplers",scene:"scenes",skin:"skins",texture:"textures"},If=function(){function e(t){Le(this,e),this.idToIndexMap={animations:{},accessors:{},buffers:{},bufferViews:{},images:{},materials:{},meshes:{},nodes:{},samplers:{},scenes:{},skins:{},textures:{}}}return Ce(e,[{key:"normalize",value:function(e,t){this.json=e.json;var r=e.json;switch(r.asset&&r.asset.version){case"2.0":return;case void 0:case"1.0":break;default:return void console.warn("glTF: Unknown version ".concat(r.asset.version))}if(!t.normalize)throw new Error("glTF v1 is not supported.");console.warn("Converting glTF v1 to glTF v2 format. This is experimental and may fail."),this._addAsset(r),this._convertTopLevelObjectsToArrays(r),function(e,t){var r,n=new Dl(e),i=n.json,o=Tf(i.images||[]);try{for(o.s();!(r=o.n()).done;){var a=r.value,s=n.removeObjectExtension(a,"KHR_binary_glTF");s&&Object.assign(a,s)}}catch(e){o.e(e)}finally{o.f()}i.buffers&&i.buffers[0]&&delete i.buffers[0].uri,n.removeExtension("KHR_binary_glTF")}(e),this._convertObjectIdsToArrayIndices(r),this._updateObjects(r)}},{key:"_addAsset",value:function(e){e.asset=e.asset||{},e.asset.version="2.0",e.asset.generator=e.asset.generator||"Normalized to glTF 2.0 by loaders.gl"}},{key:"_convertTopLevelObjectsToArrays",value:function(e){for(var t in Mf)this._convertTopLevelObjectToArray(e,t)}},{key:"_convertTopLevelObjectToArray",value:function(e,t){var r=e[t];if(r&&!Array.isArray(r))for(var n in e[t]=[],r){var i=r[n];i.id=i.id||n;var o=e[t].length;e[t].push(i),this.idToIndexMap[t][n]=o}}},{key:"_convertObjectIdsToArrayIndices",value:function(e){for(var t in Mf)this._convertIdsToIndices(e,t);"scene"in e&&(e.scene=this._convertIdToIndex(e.scene,"scene"));var r,n=Af(e.textures);try{for(n.s();!(r=n.n()).done;){var i=r.value;this._convertTextureIds(i)}}catch(e){n.e(e)}finally{n.f()}var o,a=Af(e.meshes);try{for(a.s();!(o=a.n()).done;){var s=o.value;this._convertMeshIds(s)}}catch(e){a.e(e)}finally{a.f()}var u,c=Af(e.nodes);try{for(c.s();!(u=c.n()).done;){var l=u.value;this._convertNodeIds(l)}}catch(e){c.e(e)}finally{c.f()}var f,h=Af(e.scenes);try{for(h.s();!(f=h.n()).done;){var p=f.value;this._convertSceneIds(p)}}catch(e){h.e(e)}finally{h.f()}}},{key:"_convertTextureIds",value:function(e){e.source&&(e.source=this._convertIdToIndex(e.source,"image"))}},{key:"_convertMeshIds",value:function(e){var t,r=Af(e.primitives);try{for(r.s();!(t=r.n()).done;){var n=t.value,i=n.attributes,o=n.indices,a=n.material;for(var s in i)i[s]=this._convertIdToIndex(i[s],"accessor");o&&(n.indices=this._convertIdToIndex(o,"accessor")),a&&(n.material=this._convertIdToIndex(a,"material"))}}catch(e){r.e(e)}finally{r.f()}}},{key:"_convertNodeIds",value:function(e){var t=this;e.children&&(e.children=e.children.map((function(e){return t._convertIdToIndex(e,"node")})))}},{key:"_convertSceneIds",value:function(e){var t=this;e.nodes&&(e.nodes=e.nodes.map((function(e){return t._convertIdToIndex(e,"node")})))}},{key:"_convertIdsToIndices",value:function(e,t){var r,n=Af(e[t]);try{for(n.s();!(r=n.n()).done;){var i=r.value;for(var o in i){var a=i[o],s=this._convertIdToIndex(a,o);i[o]=s}}}catch(e){n.e(e)}finally{n.f()}}},{key:"_convertIdToIndex",value:function(e,t){var r=jf[t];if(r in this.idToIndexMap){var n=this.idToIndexMap[r][e];if(!Number.isFinite(n))throw new Error("gltf v1: failed to resolve ".concat(t," with id ").concat(e));return n}return e}},{key:"_updateObjects",value:function(e){var t,r=Af(this.json.buffers);try{for(r.s();!(t=r.n()).done;){delete t.value.type}}catch(e){r.e(e)}finally{r.f()}}}]),e}();function Lf(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(new If).normalize(e,t)}function Rf(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Cf(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Rf(Object(r),!0).forEach((function(t){$(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Rf(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Nf={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Df={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},Uf={TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,REPEAT:10497,LINEAR:9729,NEAREST_MIPMAP_LINEAR:9986},Ff={magFilter:Uf.TEXTURE_MAG_FILTER,minFilter:Uf.TEXTURE_MIN_FILTER,wrapS:Uf.TEXTURE_WRAP_S,wrapT:Uf.TEXTURE_WRAP_T},Bf=($(Ef={},Uf.TEXTURE_MAG_FILTER,Uf.LINEAR),$(Ef,Uf.TEXTURE_MIN_FILTER,Uf.NEAREST_MIPMAP_LINEAR),$(Ef,Uf.TEXTURE_WRAP_S,Uf.REPEAT),$(Ef,Uf.TEXTURE_WRAP_,Uf.REPEAT),Ef);var Vf=function(){function e(){Le(this,e)}return Ce(e,[{key:"postProcess",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.json,n=e.buffers,i=void 0===n?[]:n,o=e.images,a=void 0===o?[]:o,s=e.baseUri,u=void 0===s?"":s;return Sl(r),this.baseUri=u,this.json=r,this.buffers=i,this.images=a,this._resolveTree(this.json,t),this.json}},{key:"_resolveTree",value:function(e){var t=this;arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.bufferViews&&(e.bufferViews=e.bufferViews.map((function(e,r){return t._resolveBufferView(e,r)}))),e.images&&(e.images=e.images.map((function(e,r){return t._resolveImage(e,r)}))),e.samplers&&(e.samplers=e.samplers.map((function(e,r){return t._resolveSampler(e,r)}))),e.textures&&(e.textures=e.textures.map((function(e,r){return t._resolveTexture(e,r)}))),e.accessors&&(e.accessors=e.accessors.map((function(e,r){return t._resolveAccessor(e,r)}))),e.materials&&(e.materials=e.materials.map((function(e,r){return t._resolveMaterial(e,r)}))),e.meshes&&(e.meshes=e.meshes.map((function(e,r){return t._resolveMesh(e,r)}))),e.nodes&&(e.nodes=e.nodes.map((function(e,r){return t._resolveNode(e,r)}))),e.skins&&(e.skins=e.skins.map((function(e,r){return t._resolveSkin(e,r)}))),e.scenes&&(e.scenes=e.scenes.map((function(e,r){return t._resolveScene(e,r)}))),void 0!==e.scene&&(e.scene=e.scenes[this.json.scene])}},{key:"getScene",value:function(e){return this._get("scenes",e)}},{key:"getNode",value:function(e){return this._get("nodes",e)}},{key:"getSkin",value:function(e){return this._get("skins",e)}},{key:"getMesh",value:function(e){return this._get("meshes",e)}},{key:"getMaterial",value:function(e){return this._get("materials",e)}},{key:"getAccessor",value:function(e){return this._get("accessors",e)}},{key:"getCamera",value:function(e){return null}},{key:"getTexture",value:function(e){return this._get("textures",e)}},{key:"getSampler",value:function(e){return this._get("samplers",e)}},{key:"getImage",value:function(e){return this._get("images",e)}},{key:"getBufferView",value:function(e){return this._get("bufferViews",e)}},{key:"getBuffer",value:function(e){return this._get("buffers",e)}},{key:"_get",value:function(e,t){if("object"===z(t))return t;var r=this.json[e]&&this.json[e][t];return r||console.warn("glTF file error: Could not find ".concat(e,"[").concat(t,"]")),r}},{key:"_resolveScene",value:function(e,t){var r=this;return e.id=e.id||"scene-".concat(t),e.nodes=(e.nodes||[]).map((function(e){return r.getNode(e)})),e}},{key:"_resolveNode",value:function(e,t){var r=this;return e.id=e.id||"node-".concat(t),e.children&&(e.children=e.children.map((function(e){return r.getNode(e)}))),void 0!==e.mesh&&(e.mesh=this.getMesh(e.mesh)),void 0!==e.camera&&(e.camera=this.getCamera(e.camera)),void 0!==e.skin&&(e.skin=this.getSkin(e.skin)),e}},{key:"_resolveSkin",value:function(e,t){return e.id=e.id||"skin-".concat(t),e.inverseBindMatrices=this.getAccessor(e.inverseBindMatrices),e}},{key:"_resolveMesh",value:function(e,t){var r=this;return e.id=e.id||"mesh-".concat(t),e.primitives&&(e.primitives=e.primitives.map((function(e){var t=(e=Cf({},e)).attributes;for(var n in e.attributes={},t)e.attributes[n]=r.getAccessor(t[n]);return void 0!==e.indices&&(e.indices=r.getAccessor(e.indices)),void 0!==e.material&&(e.material=r.getMaterial(e.material)),e}))),e}},{key:"_resolveMaterial",value:function(e,t){if(e.id=e.id||"material-".concat(t),e.normalTexture&&(e.normalTexture=Cf({},e.normalTexture),e.normalTexture.texture=this.getTexture(e.normalTexture.index)),e.occlusionTexture&&(e.occlustionTexture=Cf({},e.occlustionTexture),e.occlusionTexture.texture=this.getTexture(e.occlusionTexture.index)),e.emissiveTexture&&(e.emmisiveTexture=Cf({},e.emmisiveTexture),e.emissiveTexture.texture=this.getTexture(e.emissiveTexture.index)),e.pbrMetallicRoughness){e.pbrMetallicRoughness=Cf({},e.pbrMetallicRoughness);var r=e.pbrMetallicRoughness;r.baseColorTexture&&(r.baseColorTexture=Cf({},r.baseColorTexture),r.baseColorTexture.texture=this.getTexture(r.baseColorTexture.index)),r.metallicRoughnessTexture&&(r.metallicRoughnessTexture=Cf({},r.metallicRoughnessTexture),r.metallicRoughnessTexture.texture=this.getTexture(r.metallicRoughnessTexture.index))}return e}},{key:"_resolveAccessor",value:function(e,t){var r,n;if(e.id=e.id||"accessor-".concat(t),void 0!==e.bufferView&&(e.bufferView=this.getBufferView(e.bufferView)),e.bytesPerComponent=(r=e.componentType,Df[r]),e.components=(n=e.type,Nf[n]),e.bytesPerElement=e.bytesPerComponent*e.components,e.bufferView){var i=e.bufferView.buffer,o=Nl(e,e.bufferView),a=o.ArrayType,s=o.length,u=(e.bufferView.byteOffset||0)+(e.byteOffset||0)+i.byteOffset;e.value=new a(i.arrayBuffer,u,s)}return e}},{key:"_resolveTexture",value:function(e,t){return e.id=e.id||"texture-".concat(t),e.sampler="sampler"in e?this.getSampler(e.sampler):Bf,e.source=this.getImage(e.source),e}},{key:"_resolveSampler",value:function(e,t){for(var r in e.id=e.id||"sampler-".concat(t),e.parameters={},e){var n=this._enumSamplerParameter(r);void 0!==n&&(e.parameters[n]=e[r])}return e}},{key:"_enumSamplerParameter",value:function(e){return Ff[e]}},{key:"_resolveImage",value:function(e,t){e.id=e.id||"image-".concat(t),void 0!==e.bufferView&&(e.bufferView=this.getBufferView(e.bufferView));var r=this.images[t];return r&&(e.image=r),e}},{key:"_resolveBufferView",value:function(e,t){e.id=e.id||"bufferView-".concat(t);var r=e.buffer;e.buffer=this.buffers[r];var n=this.buffers[r].arrayBuffer,i=this.buffers[r].byteOffset||0;return"byteOffset"in e&&(i+=e.byteOffset),e.data=new Uint8Array(n,i,e.byteLength),e}},{key:"_resolveCamera",value:function(e,t){return e.id=e.id||"camera-".concat(t),e.perspective,e.orthographic,e}}]),e}();function zf(e,t){return(new Vf).postProcess(e,t)}function qf(e,t){return Gf.apply(this,arguments)}function Gf(){return(Gf=V(F.a.mark((function e(t,r){var n,i,o,a,s,u,c=arguments;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=c.length>2&&void 0!==c[2]?c[2]:0,i=c.length>3?c[3]:void 0,o=c.length>4?c[4]:void 0,Wf(t,r,n,i),Lf(t,{normalize:i.gltf.normalize}),a=[],!i.gltf.loadBuffers||!t.json.buffers){e.next=9;break}return e.next=9,Hf(t,i,o);case 9:return i.gltf.loadImages&&(s=Qf(t,i,o),a.push(s)),u=gf(t,i,o),a.push(u),e.next=14,Promise.all(a);case 14:return e.abrupt("return",i.gltf.postProcess?zf(t,i):t);case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Wf(e,t,r,n){(n.uri&&(e.baseUri=n.uri),t instanceof ArrayBuffer&&!wf(t,r,n))&&(t=(new TextDecoder).decode(t));if("string"==typeof t)e.json=kl(t);else if(t instanceof ArrayBuffer){var i={};r=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=(arguments.length>3&&void 0!==arguments[3]&&arguments[3],new DataView(t));e.type=bf(n,r+0),e.version=n.getUint32(r+4,!0);var i=n.getUint32(r+8,!0);switch(e.header={byteOffset:r,byteLength:i},e.json={},e.binChunks=[],r+=12,e.version){case 1:return xf(e,n,r,{});case 2:return kf(e,n,r,{});default:throw new Error("Invalid GLB version ".concat(e.version,". Only supports v1 and v2."))}}(i,t,r,n),Sl("glTF"===i.type,"Invalid GLB magic string ".concat(i.type)),e._glb=i,e.json=i.json}else Sl(!1,"GLTF: must be ArrayBuffer or string");var o=e.json.buffers||[];if(e.buffers=new Array(o.length).fill(null),e._glb&&e._glb.header.hasBinChunk){var a=e._glb.binChunks;e.buffers[0]={arrayBuffer:a[0].arrayBuffer,byteOffset:a[0].byteOffset,byteLength:a[0].byteLength}}var s=e.json.images||[];e.images=new Array(s.length).fill({})}function Hf(e,t,r){return Zf.apply(this,arguments)}function Zf(){return(Zf=V(F.a.mark((function e(t,r,n){var i,o,a,s,u,c;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=0;case 1:if(!(i<t.json.buffers.length)){e.next=18;break}if(!(o=t.json.buffers[i]).uri){e.next=15;break}return Sl(a=n.fetch),s=Al(o.uri,r),e.next=9,a(s);case 9:return u=e.sent,e.next=12,u.arrayBuffer();case 12:c=e.sent,t.buffers[i]={arrayBuffer:c,byteOffset:0,byteLength:c.byteLength},delete o.uri;case 15:++i,e.next=1;break;case 18:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Qf(e,t,r){return Kf.apply(this,arguments)}function Kf(){return(Kf=V(F.a.mark((function e(t,r,n){var i,o,a;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(i=t.json.images||[],o=[],a=0;a<i.length;++a)o.push(Yf(t,i[a],a,r,n));return e.next=5,Promise.all(o);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Yf(e,t,r,n,i){return Jf.apply(this,arguments)}function Jf(){return(Jf=V(F.a.mark((function e(t,r,n,i,o){var a,s,u,c,l,f,h;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=o.fetch,s=o.parse,!r.uri){e.next=9;break}return c=Al(r.uri,i),e.next=5,a(c);case 5:return l=e.sent,e.next=8,l.arrayBuffer();case 8:u=e.sent;case 9:return Number.isFinite(r.bufferView)&&(f=Pl(t.json,t.buffers,r.bufferView),u=Ol(f.buffer,f.byteOffset,f.byteLength)),Sl(u,"glTF image has no data"),e.next=13,s(u,wl,{},o);case 13:h=e.sent,t.images[n]=h;case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function $f(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Xf(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?$f(Object(r),!0).forEach((function(t){$(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$f(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var eh={id:"gltf",name:"glTF",version:"2.3.13",extensions:["gltf","glb"],mimeTypes:["model/gltf+json","model/gltf-binary"],text:!0,binary:!0,tests:["glTF"],parse:function(e){return rh.apply(this,arguments)},options:{gltf:{normalize:!1,loadBuffers:!0,loadImages:!0,decompressMeshes:!0,postProcess:!0},baseUri:"",log:console},deprecatedOptions:{fetchImages:"gltf.loadImages",createImages:"gltf.loadImages",decompress:"gltf.decompressMeshes",postProcess:"gltf.postProcess",gltf:{decompress:"gltf.decompressMeshes"}}},th=eh;function rh(){return(rh=V(F.a.mark((function e(t){var r,n,i,o,a,s=arguments;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.length>1&&void 0!==s[1]?s[1]:{},n=s.length>2?s[2]:void 0,(r=Xf(Xf({},eh.options),r)).gltf=Xf(Xf({},eh.options.gltf),r.gltf),nh(r),i=r.byteOffset,o=void 0===i?0:i,a={},e.next=9,qf(a,t,o,r,n);case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function nh(e){"fetchImages"in e&&(e.gltf.loadImages=e.fetchImages),"createImages"in e&&(e.gltf.loadImages=e.createImages),"fetchLinkedResources"in e&&(e.gltf.fetchBuffers=e.fetchLinkedResources),"decompress"in e&&(e.gltf.decompressMeshes=e.decompress),"decompress"in e.gltf&&(e.gltf.decompressMeshes=e.gltf.decompress),"postProcess"in e&&(e.gltf.postProcess=e.postProcess)}var ih=0,oh=1;function ah(e,t,r,n){e.rotateYtoZ=!0;var i=e.byteOffset+e.byteLength-r;if(0===i)throw new Error("glTF byte length must be greater than 0.");return e.gltfUpAxis=n["3d-tiles"]&&n["3d-tiles"].assetGltfUpAxis?n["3d-tiles"].assetGltfUpAxis:"Y",e.gltfArrayBuffer=Ol(t,r,i),e.gltfByteOffset=0,e.gltfByteLength=i,r%4==0||console.warn("".concat(e.type,": embedded glb is not aligned to a 4-byte boundary.")),e.byteOffset+e.byteLength}function sh(e,t,r,n){return uh.apply(this,arguments)}function uh(){return(uh=V(F.a.mark((function e(t,r,n,i){var o,a,s;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=n["3d-tiles"]||{},ch(t,r,n),!o.loadGLTF){e.next=16;break}if(a=i.parse,s=i.fetch,!t.gltfUrl){e.next=9;break}return e.next=7,s(t.gltfUrl,n);case 7:t.gltfArrayBuffer=e.sent,t.gltfByteOffset=0;case 9:if(!t.gltfArrayBuffer){e.next=16;break}return e.next=12,a(t.gltfArrayBuffer,th,n,i);case 12:t.gltf=e.sent,delete t.gltfArrayBuffer,delete t.gltfByteOffset,delete t.gltfByteLength;case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ch(e,t,r){switch(t){case ih:var n=new Uint8Array(e.gltfArrayBuffer,e.gltfByteOffset),i=(new TextDecoder).decode(n);e.gltfUrl=i.replace(/[\s\0]+$/,""),delete e.gltfArrayBuffer,delete e.gltfByteOffset,delete e.gltfByteLength;break;case oh:break;default:throw new Error("b3dm: Illegal glTF format field")}}function lh(e,t,r,n,i){return fh.apply(this,arguments)}function fh(){return(fh=V(F.a.mark((function e(t,r,n,i,o){var a,s;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=hh(t,r,n,i,o),e.next=3,sh(t,oh,i,o);case 3:return a=t.gltf||{},(s=a.extensions)&&s.CESIUM_RTC&&(t.rtcCenter=s.CESIUM_RTC.center),e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function hh(e,t,r,n,i){r=ah(e,t,r=yc(e,t,r=dc(e,t,r=pc(e,t,r))),n);var o=new ec(e.featureTableJson,e.featureTableBinary);return e.rtcCenter=o.getGlobalProperty("RTC_CENTER",Yu.FLOAT,3),r}function ph(e,t,r,n,i){return dh.apply(this,arguments)}function dh(){return(dh=V(F.a.mark((function e(t,r,n,i,o){return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=yh(t,r,n,i,o),e.next=3,sh(t,t.gltfFormat,i,o);case 3:return e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function yh(e,t,r,n,i){if(r=pc(e,t,r),1!==e.version)throw new Error("Instanced 3D Model version ".concat(e.version," is not supported"));r=dc(e,t,r);var o=new DataView(t);if(e.gltfFormat=o.getUint32(r,!0),r=ah(e,t,r=yc(e,t,r+=4),n),0===e.featureTableJsonByteLength)throw new Error("i3dm parser: featureTableJsonByteLength is zero.");var a=new ec(e.featureTableJson,e.featureTableBinary),s=a.getGlobalProperty("INSTANCES_LENGTH");if(a.featuresLength=s,!Number.isFinite(s))throw new Error("i3dm parser: INSTANCES_LENGTH must be defined");e.eastNorthUp=a.getGlobalProperty("EAST_NORTH_UP"),e.rtcCenter=a.getGlobalProperty("RTC_CENTER",Yu.FLOAT,3);new hc(e.batchTableJson,e.batchTableBinary,s);return function(e,t,r,n){for(var i=[new Array(n),e._batchTable][0],o=new Pn,a=(new Pn,new Pn,new Pn,new Xn),s=new Ti,u=new Pn,c={},l=new uo,f=[],h=[],p=new Pn,d=new Pn,y=0;y<n;y++){var v=void 0;if(t.hasProperty("POSITION"))v=t.getProperty("POSITION",Yu.FLOAT,3,y,o);else if(t.hasProperty("POSITION_QUANTIZED")){v=t.getProperty("POSITION_QUANTIZED",Yu.UNSIGNED_SHORT,3,y,o);var g=t.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",Yu.FLOAT,3,p);if(!g)throw new Error("i3dm parser: QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");var m=t.getGlobalProperty("QUANTIZED_VOLUME_SCALE",Yu.FLOAT,3,d);if(!m)throw new Error("i3dm parser: QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");for(var b=0;b<3;b++)v[b]=v[b]/65535*m[b]+g[b]}if(!v)throw new Error("i3dm: POSITION or POSITION_QUANTIZED must be defined for each instance.");o.copy(v),c.translation=o,e.normalUp=t.getProperty("NORMAL_UP",Yu.FLOAT,3,y,f),e.normalRight=t.getProperty("NORMAL_RIGHT",Yu.FLOAT,3,y,h);if(e.normalUp){if(!e.normalRight)throw new Error("i3dm: Custom orientation requires both NORMAL_UP and NORMAL_RIGHT.");e.hasCustomOrientation=!0}else{if(e.octNormalUp=t.getProperty("NORMAL_UP_OCT32P",Yu.UNSIGNED_SHORT,2,f),e.octNormalRight=t.getProperty("NORMAL_RIGHT_OCT32P",Yu.UNSIGNED_SHORT,2,h),e.octNormalUp){if(!e.octNormalRight)throw new Error("i3dm: oct-encoded orientation requires NORMAL_UP_OCT32P and NORMAL_RIGHT_OCT32P");throw new Error("i3dm: oct-encoded orientation not implemented")}e.eastNorthUp?(es.WGS84.eastNorthUpToFixedFrame(o,l),l.getRotationMatrix3(a)):a.identity()}!1,s.fromMatrix3(a),c.rotation=s,u.set(1,1,1);var w=t.getProperty("SCALE",Yu.FLOAT,1,y);Number.isFinite(w)&&u.multiplyByScalar(w);var x=t.getProperty("SCALE_NON_UNIFORM",Yu.FLOAT,3,y,f);x&&u.scale(x),c.scale=u;var k=t.getProperty("BATCH_ID",Yu.UNSIGNED_SHORT,1,y);void 0===k&&(k=y);var _=(new uo).fromQuaternion(c.rotation);l.identity(),l.translate(c.translation),l.multiplyRight(_),l.scale(c.scale);var O=l.clone();i[y]={modelMatrix:O,batchId:k}}e.instances=i}(e,a,0,s),r}function vh(e,t,r,n,i,o){return gh.apply(this,arguments)}function gh(){return(gh=V(F.a.mark((function e(t,r,n,i,o,a){var s,u;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=pc(t,r,n),s=new DataView(r),t.tilesLength=s.getUint32(n,!0),n+=4,t.tiles=[];case 5:if(!(t.tiles.length<t.tilesLength&&t.byteLength-n>12)){e.next=13;break}return u={},t.tiles.push(u),e.next=10,a(r,n,i,o,u);case 10:n=e.sent,e.next=5;break;case 13:return e.abrupt("return",n);case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function mh(e){return bh.apply(this,arguments)}function bh(){return(bh=V(F.a.mark((function e(t){var r,n,i,o,a=arguments;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=a.length>1&&void 0!==a[1]?a[1]:0,n=a.length>2?a[2]:void 0,i=a.length>3?a[3]:void 0,(o=a.length>4&&void 0!==a[4]?a[4]:{}).byteOffset=r,o.type=bu(t,r),e.t0=o.type,e.next=e.t0===gu.COMPOSITE?9:e.t0===gu.BATCHED_3D_MODEL?12:e.t0===gu.INSTANCED_3D_MODEL?15:e.t0===gu.POINT_CLOUD?18:21;break;case 9:return e.next=11,vh(o,t,r,n,i,mh);case 11:return e.abrupt("return",e.sent);case 12:return e.next=14,lh(o,t,r,n,i);case 14:return e.abrupt("return",e.sent);case 15:return e.next=17,ph(o,t,r,n,i);case 17:return e.abrupt("return",e.sent);case 18:return e.next=20,Ec(o,t,r,n,i);case 20:return e.abrupt("return",e.sent);case 21:throw new Error("3DTileLoader: unknown type ".concat(o.type));case 22:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function wh(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return xh(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return xh(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function xh(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function kh(e,t){if(e.content){var r=e.content.uri||e.content.url;e.contentUrl="".concat(t.basePath,"/").concat(r)}return e.id=e.contentUrl,e.lodMetricType=Os,e.lodMetricValue=e.geometricError,e.transformMatrix=e.transform,e.type=function(e){if(!e.contentUrl)return ms;var t=e.contentUrl.split(".").pop();switch(t){case"pnts":return ws;case"i3dm":case"b3dm":return bs;default:return t}}(e),e.refine=function(e){switch(e){case"REPLACE":case"replace":return gs;case"ADD":case"add":return vs;default:return e}}(e.refine),e}function _h(e){var t=e.basePath,r=kh(e.root,e),n=[];for(n.push(r);n.length>0;){var i,o=wh(n.pop().children||[]);try{for(o.s();!(i=o.n()).done;){var a=i.value;kh(a,{basePath:t}),n.push(a)}}catch(e){o.e(e)}finally{o.f()}}return r}function Oh(e){return n.dirname(e.url)}function Th(e,t,r){return Sh.apply(this,arguments)}function Sh(){return(Sh=V(F.a.mark((function e(t,r,n){var i;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(i={}).content=i.content||{},0,e.next=5,mh(t,0,r,n,i.content);case 5:return e.abrupt("return",i.content);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ah(e,t,r){return Ph.apply(this,arguments)}function Ph(){return(Ph=V(F.a.mark((function e(t,r,n){var i;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(i=JSON.parse((new TextDecoder).decode(t))).loader=r.loader||Mh,i.url=n.url,i.basePath=Oh(i),i.root=_h(i),i.type=_s,i.lodMetricType=Os,i.lodMetricValue=i.root.lodMetricValue,e.abrupt("return",i);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Eh(){return(Eh=V(F.a.mark((function e(t,r,n,i){var o;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=r["3d-tiles"]||{},!("auto"===o.isTileset?n.url&&-1!==n.url.indexOf(".json"):o.isTileset)){e.next=8;break}return e.next=5,Ah(t,r,n);case 5:t=e.sent,e.next=11;break;case 8:return e.next=10,Th(t,r,n);case 10:t=e.sent;case 11:return e.abrupt("return",t);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Mh={id:"3d-tiles",name:"3D Tiles",version:"2.3.13",extensions:["cmpt","pnts","b3dm","i3dm"],mimeTypes:["application/octet-stream"],tests:["cmpt","pnts","b3dm","i3dm"],parse:function(e,t,r,n){return Eh.apply(this,arguments)},options:{"3d-tiles":{loadGLTF:!0,decodeQuantizedPositions:!1,isTileset:"auto",tile:null,tileset:null,assetGltfUpAxis:null}}};function jh(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ih(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?jh(Object(r),!0).forEach((function(t){D()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):jh(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Lh(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return p()(this,r)}}var Rh=[0],Ch={getPointColor:{type:"accessor",value:[0,0,0,255]},pointSize:1,data:null,loader:Mh,onTilesetLoad:{type:"function",value:function(e){},compare:!1},onTileLoad:{type:"function",value:function(e){},compare:!1},onTileUnload:{type:"function",value:function(e){},compare:!1},onTileError:{type:"function",value:function(e,t,r){},compare:!1}},Nh=function(e){f()(n,e);var t,r=Lh(n);function n(){return c()(this,n),r.apply(this,arguments)}return w()(n,[{key:"initializeState",value:function(){"onTileLoadFail"in this.props&&v.log.removed("onTileLoadFail","onTileError")(),this.state={layerMap:{},tileset3d:null}}},{key:"shouldUpdateState",value:function(e){return e.changeFlags.somethingChanged}},{key:"updateState",value:function(e){var t=e.props,r=e.oldProps,n=e.changeFlags;if(t.data&&t.data!==r.data&&this._loadTileset(t.data),n.viewportChanged){var i=this.state.tileset3d;this._updateTileset(i)}if(n.propsChanged){var o=this.state.layerMap;for(var a in o)o[a].needsUpdate=!0}}},{key:"getPickingInfo",value:function(e){var t=e.info,r=e.sourceLayer,n=this.state.layerMap,i=r&&r.id;if(i){var o=i.substring(this.id.length+1),a=o.substring(o.indexOf("-")+1);t.object=n[a]&&n[a].tile}return t}},{key:"_loadTileset",value:(t=xr()(F.a.mark((function e(t){var r,n,i,o,a,s;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.props.loadOptions,n=this.props.loader||this.props.loaders,Array.isArray(n)&&(n=n[0]),i=Ih({},r),!n.preload){e.next=9;break}return e.next=7,n.preload(t,r);case 7:o=e.sent,Object.assign(i,o);case 9:return e.next=11,mr(t,n,i);case 11:a=e.sent,s=new vu(a,Ih({onTileLoad:this._onTileLoad.bind(this),onTileUnload:this._onTileUnload.bind(this),onTileLoadFail:this.props.onTileError},i)),this.setState({tileset3d:s,layerMap:{}}),this._updateTileset(s),this.props.onTilesetLoad(s);case 16:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"_onTileLoad",value:function(e){this.props.onTileLoad(e),this._updateTileset(this.state.tileset3d),this.setNeedsUpdate()}},{key:"_onTileUnload",value:function(e){delete this.state.layerMap[e.id],this.props.onTileUnload(e)}},{key:"_updateTileset",value:function(e){var t=this.context,r=t.timeline,n=t.viewport;if(r&&n&&e){var i=e.update(n);this.state.frameNumber!==i&&this.setState({frameNumber:i})}}},{key:"_getSubLayer",value:function(e,t){if(!e.content)return null;switch(e.type){case ws:return this._makePointCloudLayer(e,t);case bs:return this._make3DModelLayer(e,t);case xs:return this._makeSimpleMeshLayer(e,t);default:throw new Error("Tile3DLayer: Failed to render layer of type ".concat(e.content.type))}}},{key:"_makePointCloudLayer",value:function(e,t){var r=e.content,n=r.attributes,i=r.pointCount,o=r.constantRGBA,a=r.cartographicOrigin,s=r.modelMatrix,u=n.positions,c=n.normals,l=n.colors;if(!u)return null;var f=t&&t.props.data||{header:{vertexCount:i},attributes:{POSITION:u,NORMAL:c,COLOR_0:l}},h=this.props,p=h.pointSize,d=h.getPointColor;return new(this.getSubLayerClass("pointcloud",v.PointCloudLayer))({pointSize:p},this.getSubLayerProps({id:"pointcloud"}),{id:"".concat(this.id,"-pointcloud-").concat(e.id),data:f,coordinateSystem:v.COORDINATE_SYSTEM.METER_OFFSETS,coordinateOrigin:a,modelMatrix:s,getColor:o||d})}},{key:"_make3DModelLayer",value:function(e){var t=e.content,r=t.gltf,n=t.instances,i=t.cartographicOrigin,o=t.modelMatrix;return new(this.getSubLayerClass("scenegraph",v.ScenegraphLayer))({_lighting:"pbr"},this.getSubLayerProps({id:"scenegraph"}),{id:"".concat(this.id,"-scenegraph-").concat(e.id),data:n||Rh,scenegraph:r,coordinateSystem:v.COORDINATE_SYSTEM.METER_OFFSETS,coordinateOrigin:i,modelMatrix:o,getTransformMatrix:function(e){return e.modelMatrix},getPosition:[0,0,0]})}},{key:"_makeSimpleMeshLayer",value:function(e,t){var r=e.content,n=r.attributes,i=r.modelMatrix,o=r.cartographicOrigin,a=r.texture,s=t&&t.props.mesh||new Oa.Geometry({drawMode:4,attributes:Dh(n)});return new(this.getSubLayerClass("mesh",v.SimpleMeshLayer))(this.getSubLayerProps({id:"mesh"}),{id:"".concat(this.id,"-mesh-").concat(e.id),mesh:s,data:Rh,getPosition:[0,0,0],getColor:[255,255,255],texture:a,modelMatrix:i,coordinateOrigin:o,coordinateSystem:v.COORDINATE_SYSTEM.METER_OFFSETS})}},{key:"renderLayers",value:function(){var e=this,t=this.state,r=t.tileset3d,n=t.layerMap;return r?r.tiles.map((function(t){var r=n[t.id]=n[t.id]||{tile:t},i=r.layer;return t.selected?i?r.needsUpdate?(i=e._getSubLayer(t,i),r.needsUpdate=!1):i.props.visible||(i=i.clone({visible:!0})):i=e._getSubLayer(t):i&&i.props.visible&&(i=i.clone({visible:!1})),r.layer=i,i})).filter(Boolean):null}},{key:"isLoaded",get:function(){var e=this.state.tileset3d;return e&&e.isLoaded()}}]),n}(v.CompositeLayer);function Dh(e){var t={};return t.positions=Ih(Ih({},e.positions),{},{value:new Float32Array(e.positions.value)}),e.normals&&(t.normals=e.normals),e.texCoords&&(t.texCoords=e.texCoords),t}Nh.layerName="Tile3DLayer",Nh.defaultProps=Ch;class Uh{constructor(e=257){this.gridSize=e;const t=e-1;if(t&t-1)throw new Error(`Expected grid size to be 2^n+1, got ${e}.`);this.numTriangles=t*t*2-2,this.numParentTriangles=this.numTriangles-t*t,this.indices=new Uint32Array(this.gridSize*this.gridSize),this.coords=new Uint16Array(4*this.numTriangles);for(let e=0;e<this.numTriangles;e++){let r=e+2,n=0,i=0,o=0,a=0,s=0,u=0;for(1&r?o=a=s=t:n=i=u=t;(r>>=1)>1;){const e=n+o>>1,t=i+a>>1;1&r?(o=n,a=i,n=s,i=u):(n=o,i=a,o=s,a=u),s=e,u=t}const c=4*e;this.coords[c+0]=n,this.coords[c+1]=i,this.coords[c+2]=o,this.coords[c+3]=a}}createTile(e){return new Fh(e,this)}}class Fh{constructor(e,t){const r=t.gridSize;if(e.length!==r*r)throw new Error(`Expected terrain data of length ${r*r} (${r} x ${r}), got ${e.length}.`);this.terrain=e,this.martini=t,this.errors=new Float32Array(e.length),this.update()}update(){const{numTriangles:e,numParentTriangles:t,coords:r,gridSize:n}=this.martini,{terrain:i,errors:o}=this;for(let a=e-1;a>=0;a--){const e=4*a,s=r[e+0],u=r[e+1],c=r[e+2],l=r[e+3],f=s+c>>1,h=u+l>>1,p=f+h-u,d=h+s-f,y=(i[u*n+s]+i[l*n+c])/2,v=h*n+f,g=Math.abs(y-i[v]);if(o[v]=Math.max(o[v],g),a<t){const e=(u+d>>1)*n+(s+p>>1),t=(l+d>>1)*n+(c+p>>1);o[v]=Math.max(o[v],o[e],o[t])}}}getMesh(e=0){const{gridSize:t,indices:r}=this.martini,{errors:n}=this;let i=0,o=0;const a=t-1;function s(a,u,c,l,f,h){const p=a+c>>1,d=u+l>>1;Math.abs(a-f)+Math.abs(u-h)>1&&n[d*t+p]>e?(s(f,h,a,u,p,d),s(c,l,f,h,p,d)):(r[u*t+a]=r[u*t+a]||++i,r[l*t+c]=r[l*t+c]||++i,r[h*t+f]=r[h*t+f]||++i,o++)}r.fill(0),s(0,0,a,a,a,0),s(a,a,0,0,0,a);const u=new Uint16Array(2*i),c=new Uint32Array(3*o);let l=0;function f(i,o,a,s,h,p){const d=i+a>>1,y=o+s>>1;if(Math.abs(i-h)+Math.abs(o-p)>1&&n[y*t+d]>e)f(h,p,i,o,d,y),f(a,s,h,p,d,y);else{const e=r[o*t+i]-1,n=r[s*t+a]-1,f=r[p*t+h]-1;u[2*e]=i,u[2*e+1]=o,u[2*n]=a,u[2*n+1]=s,u[2*f]=h,u[2*f+1]=p,c[l++]=e,c[l++]=n,c[l++]=f}}return f(0,0,a,a,a,0),f(a,a,0,0,0,a),{vertices:u,triangles:c}}}function Bh(e,t){if(null===e)return null;var r=t.meshMaxError,n=t.bounds,i=t.elevationDecoder,o=e.data,a=e.width,s=a+1,u=function(e,t,r){for(var n=r.rScaler,i=r.bScaler,o=r.gScaler,a=r.offset,s=t+1,u=new Float32Array(s*s),c=0,l=0;l<t;l++)for(var f=0;f<t;f++,c++){var h=4*c,p=e[h+0],d=e[h+1],y=e[h+2];u[c+l]=p*n+d*o+y*i+a}for(var v=s*(s-1),g=0;g<s-1;g++,v++)u[v]=u[v-s];for(var m=s-1,b=0;b<s;b++,m+=s)u[m]=u[m-1];return u}(o,a,i),c=new Uh(s).createTile(u).getMesh(r),l=c.vertices,f=c.triangles,h=function(e,t,r,n){for(var i=r+1,o=e.length/2,a=new Float32Array(3*o),s=new Float32Array(2*o),u=Ss(n||[0,0,r,r],4),c=u[0],l=u[1],f=u[2],h=u[3],p=(f-c)/r,d=(h-l)/r,y=0;y<o;y++){var v=e[2*y],g=e[2*y+1],m=g*i+v;a[3*y+0]=v*p+c,a[3*y+1]=-g*d+h,a[3*y+2]=t[m],s[2*y+0]=v/r,s[2*y+1]=g/r}return{POSITION:{value:a,size:3},TEXCOORD_0:{value:s,size:2}}}(l,u,a,n);return{loaderData:{header:{}},header:{vertexCount:f.length,boundingBox:Nu(h)},mode:4,indices:{value:f,size:1},attributes:h}}function Vh(){return(Vh=V(F.a.mark((function e(t,r,n){var i;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.image=r.image||{},r.image.type="data",e.next=4,n.parse(t,r,r.baseUri);case 4:return i=e.sent,e.abrupt("return",Bh(i,r.terrain));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function zh(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function qh(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?zh(Object(r),!0).forEach((function(t){$(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):zh(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Gh=qh(qh({},{id:"terrain",name:"Terrain",version:"2.3.13",extensions:["png","pngraw"],mimeTypes:["image/png"],options:{terrain:{bounds:null,workerUrl:"https://unpkg.com/@loaders.gl/terrain@".concat("2.3.13","/dist/terrain-loader.worker.js"),meshMaxError:10,elevationDecoder:{rScaler:1,gScaler:0,bScaler:0,offset:0}}}}),{},{parse:function(e,t,r){return Vh.apply(this,arguments)}});function Wh(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return p()(this,r)}}function Hh(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Zh(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Hh(Object(r),!0).forEach((function(t){D()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Hh(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Qh=[1],Kh=Zh(Zh({},ra.defaultProps),{},{elevationData:Mo,texture:Mo,meshMaxError:{type:"number",value:4},bounds:{type:"array",value:null,optional:!0,compare:!0},color:{type:"color",value:[255,255,255]},elevationDecoder:{type:"object",value:{rScaler:1,gScaler:0,bScaler:0,offset:0}},workerUrl:{type:"string",value:null},wireframe:!1,material:!0,loaders:[Gh]});function Yh(e){return Array.isArray(e)?e.join(";"):e}var Jh=function(e){f()(r,e);var t=Wh(r);function r(){return c()(this,r),t.apply(this,arguments)}return w()(r,[{key:"updateState",value:function(e){var t=e.props,r=e.oldProps,n=t.elevationData!==r.elevationData;if(n){var i=t.elevationData,o=i&&(Array.isArray(i)||i.includes("{x}")&&i.includes("{y}"));this.setState({isTiled:o})}var a=n||t.meshMaxError!==r.meshMaxError||t.elevationDecoder!==r.elevationDecoder||t.bounds!==r.bounds;if(!this.state.isTiled&&a){var s=this.loadTerrain(t);this.setState({terrain:s})}}},{key:"loadTerrain",value:function(e){var t=e.elevationData,r=e.bounds,n=e.elevationDecoder,i=e.meshMaxError,o=e.workerUrl;if(!t)return null;var a={terrain:{bounds:r,meshMaxError:i,elevationDecoder:n}};return null!==o&&(a.terrain.workerUrl=o),mr(t,this.props.loaders,a)}},{key:"getTiledTerrainData",value:function(e){var t=this.props,r=t.elevationData,n=t.texture,i=t.elevationDecoder,o=t.meshMaxError,a=t.workerUrl,s=Io(r,e),u=Io(n,e),c=e.bbox,l=e.z,f=new v.WebMercatorViewport({longitude:(c.west+c.east)/2,latitude:(c.north+c.south)/2,zoom:l}),h=f.projectFlat([c.west,c.south]),p=f.projectFlat([c.east,c.north]),d=[h[0],h[1],p[0],p[1]],y=this.loadTerrain({elevationData:s,bounds:d,elevationDecoder:i,meshMaxError:o,workerUrl:a}),g=u?mr(u).catch((function(e){return null})):Promise.resolve(null);return Promise.all([y,g])}},{key:"renderSubLayers",value:function(e){var t=this.getSubLayerClass("mesh",v.SimpleMeshLayer),r=e.data,n=e.color;if(!r)return null;var i=k()(r,2),o=i[0],a=i[1];return new t(e,{data:Qh,mesh:o,texture:a,coordinateSystem:v.COORDINATE_SYSTEM.CARTESIAN,getPosition:function(e){return[0,0,0]},getColor:n})}},{key:"onViewportLoad",value:function(e){if(e){var t=this.state.zRange,r=e.map((function(e){return e.content})).filter(Boolean).map((function(e){return e[0].header.boundingBox.map((function(e){return e[2]}))}));if(0!==r.length){var n=Math.min.apply(Math,Or()(r.map((function(e){return e[0]})))),i=Math.max.apply(Math,Or()(r.map((function(e){return e[1]}))));(!t||n<t[0]||i>t[1])&&this.setState({zRange:[n,i]})}}}},{key:"renderLayers",value:function(){var e=this.props,t=e.color,r=e.material,n=e.elevationData,i=e.texture,o=e.wireframe,a=e.meshMaxError,s=e.elevationDecoder,u=e.tileSize,c=e.maxZoom,l=e.minZoom,f=e.extent,h=e.maxRequests;return this.state.isTiled?new ra(this.getSubLayerProps({id:"tiles"}),{wireframe:o,color:t,material:r,getTileData:this.getTiledTerrainData.bind(this),renderSubLayers:this.renderSubLayers.bind(this),updateTriggers:{getTileData:{elevationData:Yh(n),texture:Yh(i),meshMaxError:a,elevationDecoder:s}},onViewportLoad:this.onViewportLoad.bind(this),zRange:this.state.zRange||null,tileSize:u,maxZoom:c,minZoom:l,extent:f,maxRequests:h}):new(this.getSubLayerClass("mesh",v.SimpleMeshLayer))(this.getSubLayerProps({id:"mesh"}),{data:Qh,mesh:this.state.terrain,texture:i,_instanced:!1,getPosition:function(e){return[0,0,0]},getColor:t,material:r,wireframe:o})}}]),r}(v.CompositeLayer);Jh.layerName="TerrainLayer",Jh.defaultProps=Kh;var $h=r(29),Xh=r.n($h),ep=function(){function e(t,r,n,i,o){Le(this,e),this.properties={},this.extent=n,this.type=0,this._pbf=t,this._geometry=-1,this._keys=i,this._values=o,t.readFields(rp,this,r)}return Ce(e,null,[{key:"types",get:function(){return["Unknown","Point","LineString","Polygon"]}}]),Ce(e,[{key:"loadGeometry",value:function(){var e=this._pbf;e.pos=this._geometry;for(var t,r=e.readVarint()+e.pos,n=1,i=0,o=0,a=0,s=[];e.pos<r;){if(i<=0){var u=e.readVarint();n=7&u,i=u>>3}if(i--,1===n||2===n)o+=e.readSVarint(),a+=e.readSVarint(),1===n&&(t&&s.push(t),t=[]),t.push(new Xh.a(o,a));else{if(7!==n)throw new Error("unknown command ".concat(n));t&&t.push(t[0].clone())}}return t&&s.push(t),s}},{key:"bbox",value:function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,r=1,n=0,i=0,o=0,a=1/0,s=-1/0,u=1/0,c=-1/0;e.pos<t;){if(n<=0){var l=e.readVarint();r=7&l,n=l>>3}if(n--,1===r||2===r)(i+=e.readSVarint())<a&&(a=i),i>s&&(s=i),(o+=e.readSVarint())<u&&(u=o),o>c&&(c=o);else if(7!==r)throw new Error("unknown command ".concat(r))}return[a,u,s,c]}},{key:"toGeoJSON",value:function(t,r,n){var i,o,a=this.extent*Math.pow(2,n),s=this.extent*t,u=this.extent*r,c=this.loadGeometry(),l=e.types[this.type];function f(e){for(var t=0;t<e.length;t++){var r=e[t],n=180-360*(r.y+u)/a;e[t]=[360*(r.x+s)/a-180,360/Math.PI*Math.atan(Math.exp(n*Math.PI/180))-90]}}switch(this.type){case 1:var h=[];for(i=0;i<c.length;i++)h[i]=c[i][0];f(c=h);break;case 2:for(i=0;i<c.length;i++)f(c[i]);break;case 3:for(c=function(e){var t=e.length;if(t<=1)return[e];for(var r,n,i=[],o=0;o<t;o++){var a=tp(e[o]);0!==a&&(void 0===n&&(n=a<0),n===a<0?(r&&i.push(r),r=[e[o]]):r.push(e[o]))}r&&i.push(r);return i}(c),i=0;i<c.length;i++)for(o=0;o<c[i].length;o++)f(c[i][o])}return 1===c.length?c=c[0]:l="Multi".concat(l),{type:"Feature",geometry:{type:l,coordinates:c},properties:this.properties}}}]),e}();function tp(e){for(var t,r,n=0,i=0,o=e.length-1;i<e.length;o=i++)t=e[i],n+=((r=e[o]).x-t.x)*(t.y+r.y);return n}function rp(e,t,r){1===e?t.id=r.readVarint():2===e?function(e,t){var r=e.readVarint()+e.pos;for(;e.pos<r;){var n=t._keys[e.readVarint()],i=t._values[e.readVarint()];t.properties[n]=i}}(r,t):3===e?t.type=r.readVarint():4===e&&(t._geometry=r.pos)}var np=function(){function e(t,r){Le(this,e),this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(ip,this,r),this.length=this._features.length}return Ce(e,[{key:"feature",value:function(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];var t=this._pbf.readVarint()+this._pbf.pos;return new ep(this._pbf,t,this.extent,this._keys,this._values)}}]),e}();function ip(e,t,r){15===e?t.version=r.readVarint():1===e?t.name=r.readString():5===e?t.extent=r.readVarint():2===e?t._features.push(r.pos):3===e?t._keys.push(r.readString()):4===e&&t._values.push(function(e){var t=null,r=e.readVarint()+e.pos;for(;e.pos<r;){var n=e.readVarint()>>3;t=1===n?e.readString():2===n?e.readFloat():3===n?e.readDouble():4===n?e.readVarint64():5===n?e.readVarint():6===n?e.readSVarint():7===n?e.readBoolean():null}return t}(r))}var op=function e(t,r){Le(this,e),this.layers=t.readFields(ap,{},r)};function ap(e,t,r){if(3===e){var n=new np(r,r.readVarint()+r.pos);n.length&&(t[n.name]=n)}}function sp(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return up(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return up(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function up(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function cp(e){var t,r,n=0,i=0,o=0,a=0,s=0,u=0,c=0,l=0,f=0,h=new Set,p={},d=sp(e);try{for(d.s();!(t=d.n()).done;){var y=t.value,v=y.geometry;switch(v.type){case"Point":i++,n++,h.add(v.coordinates.length);break;case"MultiPoint":i++,n+=v.coordinates.length;var g,m=sp(v.coordinates);try{for(m.s();!(g=m.n()).done;){var b=g.value;h.add(b.length)}}catch(e){m.e(e)}finally{m.f()}break;case"LineString":s++,o+=v.coordinates.length,a++;var w,x=sp(v.coordinates);try{for(x.s();!(w=x.n()).done;){var k=w.value;h.add(k.length)}}catch(e){x.e(e)}finally{x.f()}break;case"MultiLineString":s++;var _,O=sp(v.coordinates);try{for(O.s();!(_=O.n()).done;){var T=_.value;o+=T.length,a++;var S,A=sp(T);try{for(A.s();!(S=A.n()).done;){var P=S.value;h.add(P.length)}}catch(e){A.e(e)}finally{A.f()}}}catch(e){O.e(e)}finally{O.f()}break;case"Polygon":f++,c++,l+=v.coordinates.length,u+=xp(v.coordinates).length;var E,M=sp(xp(v.coordinates));try{for(M.s();!(E=M.n()).done;){var j=E.value;h.add(j.length)}}catch(e){M.e(e)}finally{M.f()}break;case"MultiPolygon":f++;var I,L=sp(v.coordinates);try{for(L.s();!(I=L.n()).done;){var R=I.value;c++,l+=R.length,u+=xp(R).length;var C,N=sp(xp(R));try{for(N.s();!(C=N.n()).done;){var D=C.value;h.add(D.length)}}catch(e){N.e(e)}finally{N.f()}}}catch(e){L.e(e)}finally{L.f()}break;default:throw new Error("Unsupported geometry type: ".concat(v.type))}if(y.properties)for(var U in y.properties){var F=y.properties[U];p[U]=p[U]||void 0===p[U]?(r=F,Number.isFinite(r)):p[U]}}}catch(e){d.e(e)}finally{d.f()}return{pointPositionsCount:n,pointFeaturesCount:i,linePositionsCount:o,linePathsCount:a,lineFeaturesCount:s,coordLength:h.size>0&&Math.max.apply(Math,Mt(h)),polygonPositionsCount:u,polygonObjectsCount:c,polygonRingsCount:l,polygonFeaturesCount:f,numericPropKeys:Object.keys(p).filter((function(e){return p[e]}))}}function lp(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=t.pointPositionsCount,i=t.pointFeaturesCount,o=t.linePositionsCount,a=t.linePathsCount,s=t.lineFeaturesCount,u=t.polygonPositionsCount,c=t.polygonObjectsCount,l=t.polygonRingsCount,f=t.polygonFeaturesCount,h=r.coordLength,p=r.numericPropKeys,d=r.PositionDataType,y=void 0===d?Float32Array:d,v=e.length>65535?Uint32Array:Uint16Array,g={positions:new y(n*h),globalFeatureIds:new v(n),featureIds:i>65535?new Uint32Array(n):new Uint16Array(n),numericProps:{},properties:[]},m={pathIndices:o>65535?new Uint32Array(a+1):new Uint16Array(a+1),positions:new y(o*h),globalFeatureIds:new v(o),featureIds:s>65535?new Uint32Array(o):new Uint16Array(o),numericProps:{},properties:[]},b={polygonIndices:u>65535?new Uint32Array(c+1):new Uint16Array(c+1),primitivePolygonIndices:u>65535?new Uint32Array(l+1):new Uint16Array(l+1),positions:new y(u*h),globalFeatureIds:new v(u),featureIds:f>65535?new Uint32Array(u):new Uint16Array(u),numericProps:{},properties:[]},w=0,x=[g,m,b];w<x.length;w++){var k,_=x[w],O=sp(p);try{for(O.s();!(k=O.n()).done;){var T=k.value;_.numericProps[T]=new Float32Array(_.positions.length/h)}}catch(e){O.e(e)}finally{O.f()}}m.pathIndices[a]=o,b.polygonIndices[c]=u,b.primitivePolygonIndices[l]=u;var S,A={pointPosition:0,pointFeature:0,linePosition:0,linePath:0,lineFeature:0,polygonPosition:0,polygonObject:0,polygonRing:0,polygonFeature:0,feature:0},P=sp(e);try{for(P.s();!(S=P.n()).done;){var E=S.value,M=E.geometry,j=E.properties||{};switch(M.type){case"Point":fp(M.coordinates,g,A,h,j),g.properties.push(bp(j,p)),A.pointFeature++;break;case"MultiPoint":hp(M.coordinates,g,A,h,j),g.properties.push(bp(j,p)),A.pointFeature++;break;case"LineString":pp(M.coordinates,m,A,h,j),m.properties.push(bp(j,p)),A.lineFeature++;break;case"MultiLineString":dp(M.coordinates,m,A,h,j),m.properties.push(bp(j,p)),A.lineFeature++;break;case"Polygon":yp(M.coordinates,b,A,h,j),b.properties.push(bp(j,p)),A.polygonFeature++;break;case"MultiPolygon":vp(M.coordinates,b,A,h,j),b.properties.push(bp(j,p)),A.polygonFeature++;break;default:throw new Error("Invalid geometry type")}A.feature++}}catch(e){P.e(e)}finally{P.f()}return gp(g,m,b,h)}function fp(e,t,r,n,i){t.positions.set(e,r.pointPosition*n),t.globalFeatureIds[r.pointPosition]=r.feature,t.featureIds[r.pointPosition]=r.pointFeature,mp(t,i,r.pointPosition,1),r.pointPosition++}function hp(e,t,r,n,i){var o,a=sp(e);try{for(a.s();!(o=a.n()).done;){fp(o.value,t,r,n,i)}}catch(e){a.e(e)}finally{a.f()}}function pp(e,t,r,n,i){t.pathIndices[r.linePath]=r.linePosition,r.linePath++,wp(t.positions,e,r.linePosition,n);var o=e.length;mp(t,i,r.linePosition,o),t.globalFeatureIds.set(new Uint32Array(o).fill(r.feature),r.linePosition),t.featureIds.set(new Uint32Array(o).fill(r.lineFeature),r.linePosition),r.linePosition+=o}function dp(e,t,r,n,i){var o,a=sp(e);try{for(a.s();!(o=a.n()).done;){pp(o.value,t,r,n,i)}}catch(e){a.e(e)}finally{a.f()}}function yp(e,t,r,n,i){t.polygonIndices[r.polygonObject]=r.polygonPosition,r.polygonObject++;var o,a=sp(e);try{for(a.s();!(o=a.n()).done;){var s=o.value;t.primitivePolygonIndices[r.polygonRing]=r.polygonPosition,r.polygonRing++,wp(t.positions,s,r.polygonPosition,n);var u=s.length;mp(t,i,r.polygonPosition,u),t.globalFeatureIds.set(new Uint32Array(u).fill(r.feature),r.polygonPosition),t.featureIds.set(new Uint32Array(u).fill(r.polygonFeature),r.polygonPosition),r.polygonPosition+=u}}catch(e){a.e(e)}finally{a.f()}}function vp(e,t,r,n,i){var o,a=sp(e);try{for(a.s();!(o=a.n()).done;){yp(o.value,t,r,n,i)}}catch(e){a.e(e)}finally{a.f()}}function gp(e,t,r,n){var i={points:{positions:{value:e.positions,size:n},globalFeatureIds:{value:e.globalFeatureIds,size:1},featureIds:{value:e.featureIds,size:1},numericProps:e.numericProps,properties:e.properties},lines:{pathIndices:{value:t.pathIndices,size:1},positions:{value:t.positions,size:n},globalFeatureIds:{value:t.globalFeatureIds,size:1},featureIds:{value:t.featureIds,size:1},numericProps:t.numericProps,properties:t.properties},polygons:{polygonIndices:{value:r.polygonIndices,size:1},primitivePolygonIndices:{value:r.primitivePolygonIndices,size:1},positions:{value:r.positions,size:n},globalFeatureIds:{value:r.globalFeatureIds,size:1},featureIds:{value:r.featureIds,size:1},numericProps:r.numericProps,properties:r.properties}};for(var o in i)for(var a in i[o].numericProps)i[o].numericProps[a]={value:i[o].numericProps[a],size:1};return i}function mp(e,t,r,n){for(var i in e.numericProps)i in t&&e.numericProps[i].set(new Array(n).fill(t[i]),r)}function bp(e,t){var r={};for(var n in e)t.includes(n)||(r[n]=e[n]);return r}function wp(e,t,r,n){var i,o=r*n,a=sp(t);try{for(a.s();!(i=a.n()).done;){var s=i.value;e.set(s,o),o+=n}}catch(e){a.e(e)}finally{a.f()}}function xp(e){var t;return(t=[]).concat.apply(t,Mt(e))}var kp=r(28),_p=r.n(kp),Op=["Unknown","Point","LineString","Polygon"];function Tp(e,t){for(var r=0;r<e.length;r++){var n=e[r];e[r]=[n.x/t.extent,n.y/t.extent]}}function Sp(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e,t){return e},r=Op[e.type],n=e.loadGeometry();switch(e.type){case 1:for(var i=[],o=0;o<n.length;o++)i[o]=n[o][0];t(n=i,e);break;case 2:for(var a=0;a<n.length;a++)t(n[a],e);break;case 3:n=Pp(n);for(var s=0;s<n.length;s++)for(var u=0;u<n[s].length;u++)t(n[s][u],e)}return Ap(r,e,n)}function Ap(e,t,r){var n=e;1===r.length?r=r[0]:n="Multi".concat(e);var i={type:"Feature",geometry:{type:n,coordinates:r},properties:t.properties||{}};return"id"in t&&(i.id=t.id),i}function Pp(e){var t=e.length;if(t<=1)return[e];for(var r,n,i=[],o=0;o<t;o++){var a=Ep(e[o]);0!==a&&(void 0===n&&(n=a<0),n===a<0?(r&&i.push(r),r=[e[o]]):r&&r.push(e[o]))}return r&&i.push(r),i}function Ep(e){for(var t,r,n=e.length,i=0,o=0,a=n-1;o<n;a=o++)t=e[o],i+=((r=e[a]).x-t.x)*(t.y+r.y);return i}function Mp(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function jp(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Mp(Object(r),!0).forEach((function(t){$(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Mp(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Ip(e,t){(t=t||{}).mvt=t.mvt||{},t.gis=t.gis||{};var r=[];if(e.byteLength>0){var n=new op(new _p.a(e)),i=t.mvt;(Array.isArray(i.layers)?i.layers:Object.keys(n.layers)).forEach((function(e){var t=n.layers[e],o=jp(jp({},i),{},{layerName:e});if(t)for(var a=0;a<t.length;a++){var s=Lp(t.feature(a),o);r.push(s)}}))}if("binary"===t.gis.format){var o=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=cp(e);return lp(e,r,{coordLength:t.coordLength||r.coordLength||2,numericPropKeys:t.numericPropKeys||r.numericPropKeys,PositionDataType:t.PositionDataType||Float32Array})}(r);return o.byteLength=e.byteLength,o}return r}function Lp(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r="wgs84"===t.coordinates,n=t.tileIndex&&Number.isFinite(t.tileIndex.x)&&Number.isFinite(t.tileIndex.y)&&Number.isFinite(t.tileIndex.z);if(r&&!n)throw new Error("MVT Loader: WGS84 coordinates need tileIndex property. Check documentation.");var i=r&&n?e.toGeoJSON(t.tileIndex.x,t.tileIndex.y,t.tileIndex.z):Sp(e,Tp);return t.layerProperty&&(i.properties[t.layerProperty]=t.layerName),i}function Rp(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Cp(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Rp(Object(r),!0).forEach((function(t){$(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Rp(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Np,Dp=Cp(Cp({},{id:"mvt",name:"Mapbox Vector Tile",version:"2.3.13",extensions:["mvt","pbf"],mimeTypes:["application/vnd.mapbox-vector-tile","application/x-protobuf"],category:"geometry",options:{mvt:{coordinates:"local",layerProperty:"layerName",layers:null,tileIndex:null,_format:"geojson",workerUrl:"https://unpkg.com/@loaders.gl/mvt@".concat("2.3.13","/dist/mvt-loader.worker.js")}}}),{},{parse:(Np=V(F.a.mark((function e(t,r){return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Ip(t,r));case 1:case"end":return e.stop()}}),e)}))),function(e,t){return Np.apply(this,arguments)}),parseSync:Ip,binary:!0});function Up(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return Fp(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Fp(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function Fp(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Bp(e,t,r){if("geometry"===r)return zp(e);var n=function(e,t){if(!Boolean(e.points||e.lines||e.polygons))return e.type=t||function(e){if(e.pathIndices)return"LineString";if(e.polygonIndices)return"Polygon";return"Point"}(e),[e];var r=[];e.points&&(e.points.type="Point",r.push(e.points));e.lines&&(e.lines.type="LineString",r.push(e.lines));e.polygons&&(e.polygons.type="Polygon",r.push(e.polygons));return r}(e,t);switch(function(e){if(e.length>1)return"FeatureCollection";var t=e[0];if(!(t.featureIds||t.globalFeatureIds||t.numericProps||t.properties))return"Geometry";return"FeatureCollection"}(n)){case"Geometry":return zp(n[0]);case"FeatureCollection":return function(e){var t,r=[],n=Up(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(0!==i.featureIds.value.length){for(var o=0,a=i.featureIds.value[0],s=0;s<i.featureIds.value.length;s++){var u=i.featureIds.value[s];u!==a&&(r.push(Vp(i,o,s)),o=s,a=u)}r.push(Vp(i,o,i.featureIds.value.length))}}}catch(e){n.e(e)}finally{n.f()}return r}(n)}return null}function Vp(e,t,r){return{type:"Feature",geometry:zp(e,t,r),properties:function(e,t,r){var n=Object.assign(e.properties[e.featureIds.value[t]]);for(var i in e.numericProps)n[i]=e.numericProps[i].value[t];return n}(e,t)}}function zp(e,t,r){switch(e.type){case"Point":return function(e,t,r){var n=qp(e.positions,t,r);if(n.length>1)return{type:"MultiPoint",coordinates:n};return{type:"Point",coordinates:n[0]}}(e,t,r);case"LineString":return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1/0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0,n=e.positions,i=e.pathIndices.value.filter((function(e){return e>=t&&e<=r})),o=i.length>2;if(!o){var a=qp(n,i[0],i[1]);return{type:"LineString",coordinates:a}}for(var s=[],u=0;u<i.length-1;u++){var c=qp(n,i[u],i[u+1]);s.push(c)}return{type:"MultiLineString",coordinates:s}}(e,t,r);case"Polygon":return function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1/0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0,i=t.positions,o=t.polygonIndices.value.filter((function(e){return e>=r&&e<=n})),a=t.primitivePolygonIndices.value.filter((function(e){return e>=r&&e<=n})),s=o.length>2,u=[];if(!s){for(var c=0;c<a.length-1;c++){var l=a[c],f=a[c+1],h=qp(i,l,f);u.push(h)}return{type:"Polygon",coordinates:u}}for(var p=0;p<o.length-1;p++){var d=o[p],y=o[p+1],v=e(t,d,y).coordinates;u.push(v)}return{type:"MultiPolygon",coordinates:u}}(e,t,r);default:throw new Error("Unsupported geometry type: ".concat(e.type))}}function qp(e,t,r){t=t||0,r=r||e.value.length/e.size;for(var n=[],i=t;i<r;i++)n.push(Array.from(e.value.subarray(i*e.size,(i+1)*e.size)));return n}function Gp(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return p()(this,r)}}var Wp={clipBounds:[0,0,1,1]},Hp="\nuniform vec4 clip_bounds;\n\nbool clip_isInBounds(vec2 position) {\n  return position.x >= clip_bounds[0] && position.y >= clip_bounds[1] && position.x < clip_bounds[2] && position.y < clip_bounds[3];\n}\n",Zp={name:"clip-vs",vs:Hp},Qp={"vs:#decl":"\nvarying float clip_isVisible;\n","vs:DECKGL_FILTER_GL_POSITION":"\n  clip_isVisible = float(clip_isInBounds(geometry.worldPosition.xy));\n","fs:#decl":"\nvarying float clip_isVisible;\n","fs:DECKGL_FILTER_COLOR":"\n  if (clip_isVisible < 0.5) discard;\n"},Kp={name:"clip-fs",fs:Hp},Yp={"vs:#decl":"\nvarying vec2 clip_commonPosition;\n","vs:DECKGL_FILTER_GL_POSITION":"\n  clip_commonPosition = geometry.position.xy;\n","fs:#decl":"\nvarying vec2 clip_commonPosition;\n","fs:DECKGL_FILTER_COLOR":"\n  if (!clip_isInBounds(clip_commonPosition)) discard;\n"},Jp=function(e){f()(r,e);var t=Gp(r);function r(){return c()(this,r),t.apply(this,arguments)}return w()(r,[{key:"getShaders",value:function(){var e="instancePositions"in this.getAttributeManager().attributes;return"clipByInstance"in this.props&&(e=this.props.clipByInstance),this.state.clipByInstance=e,e?{modules:[Zp],inject:Qp}:{modules:[Kp],inject:Yp}}},{key:"draw",value:function(e){var t=e.uniforms,r=this.props.clipBounds,n=void 0===r?Wp.clipBounds:r;if(this.state.clipByInstance)t.clip_bounds=n;else{var i=this.projectPosition([n[0],n[1],0]),o=this.projectPosition([n[2],n[3],0]);t.clip_bounds=[Math.min(i[0],o[0]),Math.min(i[1],o[1]),Math.max(i[0],o[0]),Math.max(i[1],o[1])]}}}]),r}(v.LayerExtension);function $p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Xp(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?$p(Object(r),!0).forEach((function(t){D()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$p(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}Jp.extensionName="ClipExtension",Jp.defaultProps=Wp;var ed={Point:td,MultiPoint:function(e,t,r){return rd(e,t,r)},LineString:nd,MultiLineString:function(e,t,r){return e.map((function(e){return nd(e,t,r)}))},Polygon:id,MultiPolygon:function(e,t,r){return e.map((function(e){return id(e,t,r)}))}};function td(e,t,r){var n=k()(e,2),i=n[0],o=n[1],a=k()(t,2),s=a[0],u=a[1],c=en(s[0],u[0],i),l=en(s[1],u[1],o);return r.unprojectFlat([c,l])}function rd(e,t,r){return e.map((function(e){return td(e,t,r)}))}function nd(e,t,r){return rd(e,t,r)}function id(e,t,r){return e.map((function(e){return rd(e,t,r)}))}function od(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return ad(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ad(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function ad(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function sd(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ud(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?sd(Object(r),!0).forEach((function(t){D()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):sd(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function cd(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return p()(this,r)}}var ld={uniqueIdProperty:{type:"string",value:""},highlightedFeatureId:null,loaders:[Dp],binary:!1};function fd(e){return hd.apply(this,arguments)}function hd(){return(hd=xr()(F.a.mark((function e(t){return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,mr(t);case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),new Error("An error occurred fetching TileJSON: ".concat(e.t0));case 9:case"end":return e.stop()}}),e,null,[[0,6]])})))).apply(this,arguments)}var pd=function(e){f()(n,e);var t,r=cd(n);function n(){return c()(this,n),r.apply(this,arguments)}return w()(n,[{key:"initializeState",value:function(){ia()(y()(n.prototype),"initializeState",this).call(this),this.setState({data:null,tileJSON:null})}},{key:"updateState",value:function(e){var t=e.props,r=e.oldProps,i=e.context,o=e.changeFlags;o.dataChanged&&this._updateTileData({props:t}),this.state.data&&(ia()(y()(n.prototype),"updateState",this).call(this,{props:t,oldProps:r,context:i,changeFlags:o}),this._setWGS84PropertyForTiles())}},{key:"_updateTileData",value:(t=xr()(F.a.mark((function e(t){var r,n,i,o,a,s;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.props,n=this.props.onDataLoad,i=r.data,o=null,a=r.minZoom,s=r.maxZoom,"string"!=typeof i||/(?=.*{z})(?=.*{x})(?=.*({y}|{-y}))/.test(i)){e.next=13;break}return this.setState({data:null,tileJSON:null}),e.next=9,fd(i);case 9:o=e.sent,n&&n(o),e.next=14;break;case 13:i.tilejson&&(o=i);case 14:o&&(i=o.tiles,Number.isFinite(o.minzoom)&&o.minzoom>a&&(a=o.minzoom),Number.isFinite(o.maxzoom)&&(!Number.isFinite(s)||o.maxzoom<s)&&(s=o.maxzoom)),this.setState({data:i,tileJSON:o,minZoom:a,maxZoom:s});case 16:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"renderLayers",value:function(){return this.state.data?ia()(y()(n.prototype),"renderLayers",this).call(this):null}},{key:"getTileData",value:function(e){var t=Io(this.state.data,e);if(!t)return Promise.reject("Invalid URL");var r=this.getLoadOptions();return r=ud(ud({},r),{},{mvt:ud(ud({},r&&r.mvt),{},{coordinates:this.context.viewport.resolution?"wgs84":"local",tileIndex:{x:e.x,y:e.y,z:e.z}}),gis:this.props.binary?{format:"binary"}:{}}),mr(t,this.props.loaders[0],r)}},{key:"renderSubLayers",value:function(e){var t=e.tile,r=Math.pow(2,t.z),i=512/r,o=-i,a=512*t.x/r,s=512*(1-t.y/r),u=(new uo).scale([i,o,1]);return e.autoHighlight=!1,this.context.viewport.resolution||(e.modelMatrix=u,e.coordinateOrigin=[a,s,0],e.coordinateSystem=v.COORDINATE_SYSTEM.CARTESIAN,e.extensions=[].concat(Or()(e.extensions||[]),[new Jp])),ia()(y()(n.prototype),"renderSubLayers",this).call(this,e)}},{key:"onHover",value:function(e,t){var r=this.props,i=r.uniqueIdProperty;if(r.autoHighlight){var o,a=this.state.hoveredFeatureId,s=e.object;s&&(o=dd(s,i)),a!==o&&-1!==o&&this.setState({hoveredFeatureId:o})}return ia()(y()(n.prototype),"onHover",this).call(this,e,t)}},{key:"getPickingInfo",value:function(e){var t=ia()(y()(n.prototype),"getPickingInfo",this).call(this,e),r=this.context.viewport.resolution;if(t.object&&!r)t.object=vd(t.object,t.tile.bbox,this.context.viewport);else if(this.props.binary&&-1!==t.index){var i=e.sourceLayer.props.data;t.object=Object(v._binaryToFeature)(i.points,t.index)||Object(v._binaryToFeature)(i.lines,t.index)||Object(v._binaryToFeature)(i.polygons,t.index)}return t}},{key:"getHighlightedObjectIndex",value:function(e){var t=this.state.hoveredFeatureId,r=this.props,n=r.uniqueIdProperty,i=r.highlightedFeatureId,o=r.binary,a=e.data;if(!(yd(t)||yd(i)))return-1;var s=yd(i)?i:t;if(Array.isArray(a))return a.findIndex((function(e){return dd(e,n)===s}));if(a&&o)for(var u=Object(v._findIndexBinary)(a,n,s),c=0,l=["points","lines","polygons"];c<l.length;c++){var f=l[c],h=a[f]&&a[f].featureIds.value[u];if(void 0!==h)return h}return-1}},{key:"_pickObjects",value:function(e){var t=this.context,r=t.deck,n=t.viewport,i=n.width,o=n.height,a=n.x,s=n.y,u=[this.id];return r.pickObjects({x:a,y:s,width:i,height:o,layerIds:u,maxObjects:e})}},{key:"getRenderedFeatures",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=this._pickObjects(t),n=new Set,i=[],o=od(r);try{for(o.s();!(e=o.n()).done;){var a=e.value,s=dd(a.object,this.props.uniqueIdProperty);-1===s?i.push(a.object):n.has(s)||(n.add(s),i.push(a.object))}}catch(e){o.e(e)}finally{o.f()}return i}},{key:"_setWGS84PropertyForTiles",value:function(){var e=this;this.state.tileset.selectedTiles.forEach((function(t){t.hasOwnProperty("dataInWGS84")||Object.defineProperty(t,"dataInWGS84",{get:function(){if(!t.content)return null;if(e.props.binary&&Array.isArray(t.content)&&!t.content.length)return[];if(void 0===t._contentWGS84){var r=e.props.binary?Bp(t.content):t.content;t._contentWGS84=r.map((function(r){return vd(r,t.bbox,e.context.viewport)}))}return t._contentWGS84}})}))}},{key:"isLoaded",get:function(){return this.state.data&&this.state.tileset&&ia()(y()(n.prototype),"isLoaded",this)}}]),n}(ra);function dd(e,t){return t?e.properties[t]:"id"in e?e.id:-1}function yd(e){return null!=e&&""!==e}function vd(e,t,r){var n=ud(ud({},e),{},{geometry:{type:e.geometry.type}});return Object.defineProperty(n.geometry,"coordinates",{get:function(){return function(e,t,r){var n=[r.projectFlat([t.west,t.north]),r.projectFlat([t.east,t.south])];return Xp(Xp({},e),{},{coordinates:ed[e.type](e.coordinates,n,r)})}(e.geometry,t,r).coordinates}}),n}pd.layerName="MVTLayer",pd.defaultProps=ld,r.d(t,"GreatCircleLayer",(function(){return m})),r.d(t,"S2Layer",(function(){return C})),r.d(t,"TileLayer",(function(){return ra})),r.d(t,"TripsLayer",(function(){return aa})),r.d(t,"H3ClusterLayer",(function(){return ha})),r.d(t,"H3HexagonLayer",(function(){return _a})),r.d(t,"Tile3DLayer",(function(){return Nh})),r.d(t,"TerrainLayer",(function(){return Jh})),r.d(t,"MVTLayer",(function(){return pd}))}])}));